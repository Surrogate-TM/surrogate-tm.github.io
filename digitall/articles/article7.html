<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>Методы создания шаблонов линий.</TITLE>
	</HEAD>
	<BODY MARGINHEIGHT="10" TOPMARGIN="10" MARGINWIDTH="12" LEFTMARGIN="12" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
<IMG ALT="Источник информации" ALIGN=RIGHT src="../images/prodigitall.png" width=450 height=100><br>
	<IMG ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72>
	<H1><P ALIGN=CENTER>Методы создания шаблонов линий.</H1></P>
<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<IMG src="../images/null.gif" width=20 height=10>Когда мы рисуем диаграммы, то линии, а вернее сказать, стиль и узор этой линии нас не особо интересует. Диаграммы обычно соединяются сплошными линиями, иногда пунктиром. Если чертят чертеж по ГОСТу, то используются разные линии, разной толщины и разного узора. И вот тут-то начинаются нестыковки. Линии в Visio представлены в Американском стандарте, а необходимо, например, начертить линию по ГОСТу. С определенным интервалом, узором и т.д.
	<BR><IMG src="../images/null.gif" width=20 height=10>Линии в Visio бывают 2-х видов. “Программные” – эти линии встроены в саму программу и создаются не по шаблону, а математически. И “Шаблонные” – они создаются на основе шаблона, созданного пользователем. Разница между ними существенная. Если создать простой шаблон и сравнить с “программной” линией, то на малых длинах сразу видна разница. Почему это происходит? Из-за разного алгоритма формирования линии. “Программные” линии формируются по мере увеличения длины, т.е. видна только часть “программного” шаблона. Пользовательские шаблоны помещаются целиком в размер линии, а не частью. И если размер будет меньше шаблона, то он будет попросту сужен, что визуально смотрится плохо и искажает размеры. Если длина линии намного больше длины шаблона, то это видно не будет.<BR>
	<BR><IMG ALT="Разница формирования линий" src="../images/pic0701.png" width=405 height=250><BR>
	<BR><IMG src="../images/null.gif" width=20 height=10>Полностью обойти это ограничение, видимо нельзя, но можно попытаться его минимизировать.
	<h4>Уменьшение длины шаблона.</h4>Допустим, нам необходимо создать линию, отвечающую ГОСТу (т.е. метрическую, а не дюймовую.) И нам известны ее размеры. Например, толщина 0,5 мм, длина черточек 15 мм, промежуток 12 мм. Цифры абстрактные. Для этого надо понять, как будет формироваться эта линия.<BR>
	<BR><IMG ALT="Пример линии" src="../images/pic0702.png" width=639 height=68><BR>
	<BR>Её формирование можно рассмотреть как последовательность блоков. Длина такого блока будет равна длине черточки + длина промежутка, т.е. 27 мм.<BR>
	<BR><IMG ALT="Способы формирования линии" src="../images/pic0703.png" width=724 height=224><BR>
	<BR>Такой блок может располагаться в любом месте этой линии. Но для удобства, можно выбрать 2 наиболее часто располагаемых мест.
	<OL>Рассмотрим оба шаблона.<LI>Первый шаблон представляет собой полную длину черточки и полную длину промежутка.
Создадим этот шаблон. Для этого необходимо сделать видимым окно Обозревателя чертежа (RU:Вид>Окна>Обозреватель чертежа EN:View>Drawing Explorer window). Нажать правой кнопкой мыши на папке Узоры линии (Line patterns) и выбрать в появившемся меню Создать узор… (New pattern…). <BR>
	<BR><IMG ALT="Создание нового узора" src="../images/pic0704.png" width=326 height=239><BR>
	<BR>В окне диалога дать название новому узору (15х12х0,5, например) и далее нажимаем ОК.<BR>
	<BR><IMG ALT="Диалоговое окно создания узора" src="../images/pic0705.png" width=394 height=252><BR>
	<BR>Теперь в данной папке появился значок нового узора и его название.
Затем нажимаем правой кнопкой мыши на нем, и в меню выбираем Изменить узор (Edit pattern для Visio 2002 или Edit pattern shape для Visio 2003).<BR>
	<BR><IMG ALT="Выбор узора для редактирования" src="../images/pic0706.png" width=463 height=368><BR>
	<BR>Откроется чистая страница чертежа.
Далее все манипуляции производятся на этом листе.
Для начала необходимо нарисовать прямоугольник с размерами 27х0,5. Он будет рамкой будущего узора. Для этого необходимо выбрать инструмент черчения прямоугольника (Ctrl+8). И начертить прямоугольник с данными размерами. Если сразу не получилось, то размеры всегда можно поправить вручную в окне Размер и позиция (RU:Вид>Окна>Размер и позиция EN:View>Size & Position window).<BR>
	<BR><IMG ALT="Окно Размер и позиция" src="../images/pic0707.png" width=170 height=138><BR>
	<BR>Затем необходимо начертить линию. Для этого необходимо выбрать инструмент черчения линии (Ctrl+6) и начертить линию в любом месте длиной 15 мм, т.е. будущую черточку линии. Теперь необходимо сначала выделить прямоугольник, а затем зажав Shift, выделить линию.<BR>
	<BR><IMG ALT="Выделение объектов" src="../images/pic0708.png" width=448 height=202><BR>
	<BR>И в меню выбрать выравнивание фигур (RU:Сервис>Выравнивание фигур… для Visio 2000 или Фигура>Выравнивание фигур… для Visio 2002 EN:Shape>Align Shapes…) или нажать F8. В диалоговом окне выбрать Горизонтальное выравнивание по центру, а Вертикальное выравнивание по левому краю (Up/Down alignment по центру, Left/Right alignment по левому краю).<BR>
	<BR><IMG ALT="Окно выравнивания фигур" src="../images/pic0709.png" width=313 height=256><BR>
	<BR>Теперь фигуры расположились как на синем шаблоне. Далее необходимо установить толщину 0 pt, для этого просто выделим обе фигуры прямоугольным выделением. Далее в меню Формат>Линия… (Format>Line…) или Shift+F3. В окне настройки линии во вкладке Толщина (Weight) необходимо выбрать Другое (Custom…) и в окне Другая толщина линии (Custom Line Weight) выставить 0 и нажать ОК. Далее закрываем окно настройки линии.<BR>
	<BR><IMG ALT="Окно настройки линии" src="../images/pic0710.png" width=431 height=358><BR>
	<BR>Затем группируем эти две фигуры. Либо через меню (RU:Фигура>Группировка>Группировать EN:Shape>Grouping>Group), либо Ctrl+G для Visio 2000 или Ctrl+Shift+G для остальных. Теперь из полученной группы надо удалить прямоугольник. Надо либо выделить прямоугольник в группе (тогда все его маркеры станут перечеркнуты крестиком) и удалить его.<BR>
	<BR><IMG ALT="Удаление прямоугольника из группы" src="../images/pic0711.png" width=703 height=156><BR>
	<BR>Либо открыть фигуру как группу, предварительно выделив ее, и в меню выбрать Правка>Открыть Группа (Edit>Open group) и в новом окне удалить прямоугольник из группы. Далее закрываем окно редактирования группы. И закрываем окно редактирования шаблона соглашаясь на обновление узора. Теперь создав линию и выбрав в окне настроек линии, толщину 0,5 мм и узор 15х12х0,5 получим достаточно точную пунктирную линию.<BR>
	<BR><IMG ALT="Применение созданного шаблона" src="../images/pic0712.png" width=432 height=358><BR>
	<BR>
	<LI>Второй шаблон представляет собой 2 половинки черточек и 1 полную длину промежутка.
Создадим этот шаблон. Для этого необходимо сделать видимым окно Обозревателя чертежа (RU: Вид>Окна>Обозреватель чертежа EN:View>Drawing Explorer window). Нажать правой кнопкой мыши на папке Узоры линии (Line patterns) и выбрать в появившемся меню Создать узор… (New pattern…). В окне диалога дать название новому узору (15х12х0,5, например) и далее нажимаем ОК. Теперь в данной папке появился значок нового узора и его название. Теперь нажимаем правой кнопкой мыши на нем, и в меню выбираем Изменить узор (Edit pattern для Visio 2002 или Edit pattern shape для Visio 2003). Откроется чистая страница чертежа. Далее все манипуляции производятся на этом листе. Для начала необходимо нарисовать прямоугольник с размерами 27х0,5. Он будет рамкой будущего узора. Для этого необходимо выбрать инструмент черчения прямоугольника (Ctrl+8). И начертить прямоугольник с данными размерами. Если сразу не получилось, то размеры всегда можно поправить вручную в окне Размер и позиция (RU:Вид>Окна>Размер и позиция EN:View>Size & Position window). Затем необходимо начертить 2 линии. Для этого необходимо выбрать инструмент черчения линии (Ctrl+6) и начертить 2 линии в любом месте длиной 7,5 мм, т.е. будущие 2 половинки черточки линии. Теперь необходимо сначала выделить прямоугольник, а затем зажав Shift, выделить одну из линий.<BR>
	<BR><IMG ALT="Выделение фигур" src="../images/pic0713.png" width=465 height=190><BR>
	<BR>И в меню выбрать выравнивание фигур (RU:Сервис>Выравнивание фигур… для Visio 2000 или Фигура>Выравнивание фигур… для Visio 2002 EN:Shape>Align Shapes…) или нажать F8. В диалоговом окне выбрать Горизонтальное выравнивание по центру, а Вертикальное выравнивание по левому краю (Up/Down alignment по центру, Left/Right alignment по левому краю).<BR>
	<BR><IMG ALT="Окно выравнивания фигур" src="../images/pic0709.png" width=313 height=256><BR>
	<BR>Затем необходимо сначала выделить прямоугольник, а затем зажав Shift, выделить другую из линий и в меню выбрать выравнивание фигур (RU:Сервис>Выравнивание фигур… для Visio 2000 или Фигура>Выравнивание фигур… для Visio 2002 EN:Shape>Align Shapes…) или нажать F8. В диалоговом окне выбрать Горизонтальное выравнивание по центру, а Вертикальное выравнивание по правому краю (Up/Down alignment по центру, Left/Right alignment по правому краю).<BR>
	<BR><IMG ALT="Окно выравнивания фигур" src="../images/pic0714.png" width=313 height=256><BR>
	<BR>Теперь фигуры расположились как на красном шаблоне. Далее необходимо установить толщину 0 pt, для этого просто выделим 3 фигуры прямоугольным выделением. Далее в меню Формат>Линия… (Format>Line…) или Shift+F3. В окне настройки линии во вкладке Толщина (Weight) необходимо выбрать Другое (Custom…) и в окне Другая толщина линии (Custom Line Weight) выставить 0 и нажать ОК. Далее закрываем окно настройки линии. Затем группируем все фигуры. Либо через меню RU:Фигура>Группировка>Группировать EN:Shape>Grouping>Group), либо Ctrl+G для Visio 2000 или Ctrl+Shift+G для остальных. Теперь из полученной группы надо удалить прямоугольник. Надо либо выделить прямоугольник в группе (тогда все его маркеры станут перечеркнуты крестиком) и удалить, либо открыть фигуру как группу, предварительно выделив ее, и в меню выбрать Правка>Открыть Группа (Edit>Open group) и в новом окне удалить прямоугольник из группы. Далее закрываем окно редактирования группы. И закрываем окно редактирования шаблона соглашаясь на обновление узора. Теперь создав линию и выбрав в окне настроек линии, толщину 0,5 мм и узор 15х12х0,5 получим достаточно точную пунктирную линию.
	</OL>Теперь некоторые пояснения. Прямоугольник который делали как шаблон для будущего узора, должен быть толщиной, как и будущая линия. Если его не сделать, то не получится сделать маркеры группы шире, чем фигуры в этой группе. Прямоугольник служит макетом, будущей толщиной линии, поэтому лучше выполнять его в реальных размерах. Помимо прямоугольника эту функцию могут выполнять другие фигуры. Толщина в 0 pt, показывает линии из которых необходимо составлять узор и неучастие этой толщины в формирование полной толщины реальной линии на чертеже, т.е. если линии узора будут не 0 pt, то отображаемая толщина линий на чертеже не будет соответствовать установленной в диалоговом окне настроек линии.<BR>
	<BR><IMG src="../images/null.gif" width=20 height=10>Для более сложных линий используются другие приемы построения шаблонов. Для примера рассмотрим способ создания такого шаблона линии:
	<BR><h4>Линия с 2-мя точками.</h4>Например, ширина черточки 10 мм, промежутка 7 мм, толщина 0,5 мм.
Строится шаблон, как и в случае с простой линией. Все последующие шаблоны будут строиться «синим» способом. Для этого создадим прямоугольник равный сумме 1 черточки + промежуток + точка + промежуток + точка + промежуток, получается 10+7+7+7=31 и высотой 0,5 мм.<BR>
	<BR><IMG src="../images/pic0715.png" width=566 height=221><BR>
	<BR>Далее необходимо создать линию длиной 10 мм и привязать справа – посередине, как было описано выше. Далее можно пойти 3-ми путями в создании точек.
	<OL><LI>Создание точек сплошной окружностью. Для этого рисуется круг с радиусом 0,5 мм и делается заливка черным цветом. Недостатком этого способа будет превращение круглой точки в вертикальную линию или эллипс при малых расстояниях линии. К очевидным достоинствам следует отнести простоту построения.<BR>
	<BR><IMG src="../images/pic0716.png" width=363 height=214><BR>
	<BR><LI>Создание точек линией. Как ни странно это звучит, но если в настройках линии из которых состоит шаблон будет стоять форма среза, круг, то линия малой длины, будет отображаться как точка. К достоинствам можно отнести то, что при малых длинах линии, точка будет точкой, хотя промежуток между точкой и черточкой может быть еще меньше.<BR>
	<BR><IMG src="../images/pic0717.png" width=290 height=208><BR>
	<BR><LI>Создание точки незаполненной окружностью. Для этого чертят окружность, делается ширина и высота равной 0 мм и располагается на месте точки. Этот способ лишен вышеперечисленных недостатков и является наиболее применимым.<BR>
	<BR><IMG src="../images/pic0718.png" width=289 height=210><BR>
	<BR></OL>
	Далее все действия выполняются так же, как это было описано выше.<BR>
	Итак, полученные шаблоны являются вполне используемыми, и каждый из способов это доказывает.
	<h4>Сложная линия.</h4> Сложной линией в данном случае можно считать любую линию, в которой элементы линии находятся не на одной линии. Вот пример сложной линии.<BR>
	<BR><IMG src="../images/pic0719.png" width=602 height=66><BR>
	<BR>Рассмотрим способ создания 3-й линии с пунктиром. Размеры в данном случае будут такие: толщина 1 черточки 0,5 мм, длина 10 мм, горизонтальный промежуток 7 мм, вертикальный 1 мм, т.е. две толщины. Размеры пунктира 2 мм. Для начала необходимо снова создать прямоугольник. Его размеры будут складываться из следующих размеров: длина черточки + промежуток + длина пунктира + промежуток. Это будет длина, равная 10+7+2+7=26 мм. И ширина его будет составлять 0,5 мм. Т.е. прямоугольник с размерами 26х0,5 мм. В данном случае ширина прямоугольника равна толщине всего 1 линии и это сделано специально.
	<BR>Далее создаем 3 линии и 3 пунктира. Затем располагаем так, как показано на рисунке.<BR>
	<BR><IMG src="../images/pic0720.png" width=645 height=54><BR>
	<BR>Делаем толщину всех линий равной 0 мм. Затем группируем. Теперь выделяем Элементы группы и располагаем, как показано на следующем рисунке.<BR>
	<BR><IMG src="../images/pic0721.png" width=738 height=183><BR>
	<BR>Это делается потому, что толщину каждой линий определяет общая ширина группы, и если бы были сгруппированы три линии вместе, то толщина каждой линии составила бы треть от общей толщины. Это хорошо видно на рисунке (Красная линия - без сдвига линий, синяя - со сдвигом линий).<BR>
	<BR><IMG src="../images/pic0722.png" width=540 height=127><BR>
	<BR>Другим примером сложной линии является провод заземления (тот, что желто – зеленый).<BR>
	<BR><IMG src="../images/pic0723.png" width=682 height=84><BR>
	<BR>Шаблон состоит из 1-й линии и 1-го параллелограмма. Из рисунка, думаю все понятно.<BR>
	<BR><IMG src="../images/pic0724.png" width=448 height=91><BR>
	<BR>Еще примером сложной линии может служить линия с подчеркиванием или линия с фигурами ниже или выше основной линии.<BR>
	<BR><IMG src="../images/pic0725.png" width=480 height=89><BR>
	<BR>Для ее создания рисуется линия, и фигуры. Далее все фигуры «сжимают» до толщины линии, Группируем и «разжимаем» до нормальных размеров и перемещаем в нужное место.<BR>
	<BR><IMG src="../images/pic0726.png" width=748 height=341><BR>
	<BR>Также можно сделать шаблон для «кривой». Например, орнамент или пара дуг как на примере.<BR>
	<BR><IMG src="../images/pic0727.png" width=316 height=196><BR>
	<BR>
	<BR><IMG src="../images/pic0728.png" width=334 height=216><BR>
	<BR>Сам орнамент тоже вначале сжимался, а потом «разжимался».<BR>
	<BR><IMG src="../images/pic0729.png" width=295 height=362><BR>
	<BR>
Так что все ограничивается лишь вашей фантазией.
	<OL>Теперь некоторые советы:<LI>При создании шаблона можно использовать направляющие, но после создания их надо удалить, иначе линия не будет нужной толщины(все линии станут тонкими).
	<LI>Все точки делать либо линией, либо окружностью.
	<LI>При создании шаблона можно использовать любые векторные объекты из других приложений. Их необходимо лишь разгруппировать и сделать толщину линий 0 мм. Например, шаблоны линий из Illustrator.
	<LI>Если выделить фигуру и подвезти к ней направляющую, то она несмотря на шаг сетки, «прилипнет» к краю фигуры.
	<LI>Если фигура привязана к направляющей, то к ней не работает команда Выравнивание фигур… Для работы с этой фигурой необходимо ее выделить и нажать на клавиатуре вверх и затем вниз. Фигура утратит привязку, но останется на том же месте.<BR>
	<BR><A HREF="../stencils/index.html">Примеры из статьи.</A><BR><HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF">
	<P>Статьи:   <a href="./article1.html" title="Создание «горячих клавиш» в Visio 2000 En">1</a> 	 <a href="./article2.html" title="Методы создания масштабируемых объектов в Visio 2000 En">2</a> 	 <a href="./article3.html" title="Методы создания градиентных заливок в Visio 2000 En">3</a> 	 <a href="./article4.html" title="Методы создания 3D в Visio 2000 En">4</a> 	 <a href="./article5.html" title="Методы создания штампов и вопросы автопозиционирования в Visio 2000 Ru">5</a> 	 <a href="./article6.html" title="Как создать будильник? Методы создания интерактивных объектов в Visio 2000 Ru, Visio 2002, Visio 2003">6</a> 	 7 	 <a href="./article8.html" title="Методы создания градиентных заливок линий в Visio 2000 Ru, Visio 2002, Visio 2003">8</a> 	 <a href="./article9.html" title="Методы и способы создания интерактивной прозрачности в Visio 2002, Visio 2003">9</a> 	 <a href="./article10.html" title="Методы создания растровой прозрачности векторных фигур в Visio 2002 Ru">10</a> 	 <a href="./article11.html" title="Формирование фигур в Visio 2000 Ru и Visio 2002 Ru">11</a> 	 <a href="./article12.html" title="Типы соединительных точек в Visio 2000 Ru и Visio 2002 Ru">12</a> 	 <a href="./article13.html" title="Способы оптимизации фигур в Visio">13</a> 	 <a href="./article14.html" title="Методы повышения визуального восприятия структурных схем в Visio. ">14</a> 	 <a href="./article15.html" title="Способы оптимизации линий в Visio">15</a> 	 <a href="./article16.html" title="Создание мультифигур в Visio">16</a> 	 <a href="./article17.html" title="Поэтапное создание в Visio примера из раздела «Работы»">17</a> 	 <a href="./article18.html" title="Способы выделения фигур в Visio 2000, Visio 2002">18</a> 	 <a href="./article19.html" title="Особенности графического представления фигур в Visio">19</a> 	 <a href="./article20.html" title="Методы создания шаблонов концов линий в Visio 2000 Ru, Visio 2002 Ru, Visio 2003">20</a> 	 <a href="./article21.html" title="Вопросы стабильности и испорченные файлы в Visio 2003">21</a> 	 <a href="./article22.html" title="Мебель своими руками в Visio 2003">22</a> 	 <a href="./article23.html" title="Растровые мультифигуры в Visio">23</a> 	 <a href="./article24.html" title="XML в Visio 2003">24</a> 	 <a href="./article25.html" title="Почти конфиденциально в Visio 2003">25</a> 	 <a href="./article26.html" title="Visio на двух мониторах">26</a> 	 <a href="./article27.html" title="«Информационный катарсис»">27</a> 	 <a href="./article28.html" title="Разукрашиваем Actions">28</a> 	 <a href="./article29.html" title="Вектор привязки">29</a> 	 <a href="./article30.html" title="Про шаблоны">30</a> </p>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	   &#160;Автор: Ничков Алексей (a.k.a. Digitall)</P>

</body>
</html> 
