<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>Вопросы стабильности и испорченные файлы в Visio 2003.</TITLE>
	</HEAD>
	<BODY MARGINHEIGHT="30" TOPMARGIN="30" MARGINWIDTH="40" LEFTMARGIN="40" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
	<IMG ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72>
	<H1><P ALIGN=CENTER><IMG src="../images/null.gif" width=20 height=10>Вопросы стабильности и испорченные файлы в Visio 2003.</H1></P><BR>
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<IMG src="../images/null.gif" width=20 height=10>
	Возможно однажды, как всегда, открыв какой-то файл, программа Visio сообщит, что файл поврежден или это не Visio файл вообще, хотя вчера ничего не предвещало такого поведения. А чертеж, по закону подлости, надо сдавать завтра, а этот Visio взял и испортил его.<br><br>
	<img src="../images/pic2101.png"><br><br>
	<IMG src="../images/null.gif" width=20 height=10>Для таких случаев и надо разобраться что случилось, что делать и как не допускать таких ситуаций впредь.
	<IMG src="../images/null.gif" width=20 height=10>Какие бывают причины испорченных файлов?
		<OL><LI>Битые – достаточно образное выражение, характеризующее незначительные ошибки в самом файле Visio, но которые критичны для текущей версии Visio. Процент открытия в Visio более новых версий около 80%. Иногда встречаются случаи невозможности последующего сохранения в Visio формат. Но хотя бы можно скопировать информацию. Процент возникновения данных ошибок около 1-2%. Часто возникают из-за невозможности программы корректно сохранить и затем воспроизвести какой-то объект.<br><br>
		<img src="../images/pic2102.png"><br><br>
		<LI>Файлы, которые были созданы в старых версиях Visio, особенно используя шаблон, потом в них вносились изменения в более поздних версиях Visio, копировались объекты, опять же, старых версий, добавлялись объекты из новых версий, и получается, некоторая «солянка» на старом шаблоне, которую как-то надо сохранить программе, и затем, воспроизвести. Процент возникновения ошибок, причем критических, очень велик. Вернее прямо пропорционален количеству «инородных», для текущей версии Visio, объектов.<br><br>
		<img src="../images/pic2103.png"><br><br>
		</OL>
	<IMG src="../images/null.gif" width=20 height=10>Не стоит также исключать возможности появления и дальнейшего накопления некритических ошибок, т.е. ошибок, которые либо, впоследствии, исправляются самой программой, либо появляются в «неиспользуемых» данных. Ну, допустим, изменилась одна буква в описании. Пользователь об этом никогда, возможно, и не узнает, но ошибки достаточно часто появляются.<br>
	<IMG src="../images/null.gif" width=20 height=10>Какие бывают испорченные файлы по содержанию?
Если открыть испорченный файл в любом HEX-редакторе, то можно увидеть его структуру и организацию данных. Соответственно, по этому содержанию испорченные файлы тоже можно разделить на:
		<OL><LI>Битые. Непрерывность данных такого файла сохранена полностью, но некорректно. Вероятность открытия высока.
		<LI>Файлы, у которых отсутствую некоторые блоки в непрерывности данных. Редко возможно восстановление.
		<LI>Файлы, у которых отсутствует более 20% данных, либо вообще, нет либо начала, либо половины данных файла. Не подлежат восстановлению.<br><br>
		<img src="../images/pic2105.png"><br><br>
		<br><br>
		<img src="../images/pic2106.png"><br><br>
		</OL>

Как повысить стабильность.
Тут следует исходить из задачи, которая ставится.
		<ol><li>Использовать, по возможности примитивы. Поясню: 10 000 прямоугольников, нарисованных самим пользователем, практически со 100% вероятностью будут записаны программой в файл и затем открыты, что вполне логично. А вот 10 000 разных объектов из разных приложений не всегда корректно программа сможет «переварить» и потом нормально открыть и примеров тому масса.
		<li>Использовать возможность Автосохранения. Но не как универсальное решение проблемы, а как еще один инструмент, который впоследствии снизит потери данных. Просто если поставить время сохранения 1 минуту, то ничего хорошего это не принесет, т.к. каждую минуту придется наблюдать окно Автосохранения, что в больших чертежах может составлять до половины этой же минуты. Рекомендую выставить на значение, которое просто не раздражает. По умолчанию оно стоит на 20 минут. В принципе данной периодичности достаточно, чтобы Автосохранение не маячило перед глазами.
		<li>По возможности использовать «оригинальные» фигуры, той версии Visio, в которой сохраняется файл.
		<li>Использовать свои макросы. Как ни странно это звучит, но на объекты из ранних версий Visio очень плохо действую макросы из более поздних версий, т.к. макрос, написанный лично, обычно, не делает «лишних» действий, помимо тех для которых он и предназначался. Оригинальные макросы очень любят добавить большое количество дополнительной информации. Я не призываю полностью отказаться от макросов или как-то ограничить их применение, но я лично, всегда, перед тем как применить надстройку, сохраняю файл, так, на всякий случай. И несколько раз это очень помогало.
		<li>Работать с файлом в одной версии Visio. Причем даже с одинаковой версией файлов самой программы. Неоднократно приходилось сталкиваться с тем, что файлы созданные в Visio 2003, редактированные в Visio 2003 SP1 потом не открывались в Visio 2003, хотя вполне нормально открывались в Visio 2003 SP1.<br><br>
		<img src="../images/pic2104.png"><br><br>
		<li>Ну и соответственно желательно устанавливать все обновления для программы. Не текущие, но хотя бы Service Pack’и. И вот почему, бывает, не часто, что текущие обновления вносят нестабильность, т.к. конфигурация обновлений у всех разная, и все предусмотреть нельзя. А вот Service Pack’и отличаются более-менее стабильностью, ввиду конкретного списка включенных в них обновлений.
		</ol>
<h3>Если вы столкнулись с тем, что Visio рухнул и чего делать.</h3>
Сама программа предложит восстановить файл, но на самом деле она просто откроет последний файл Автосохранения с диска по адресу С:\Documents and Settings\Имя_пользователя\Local Settings\Temp. Обычно файлы Visio в этой папке называются примерно так: ~$1VSO390.vsd. <br><br>
		<img src="../images/pic2107.png"><br><br>
		Можно самому взять оттуда последнюю версию сохраненного файла.<br><br>
		<img src="../images/pic2108.png"><br><br>

Попробовать повторно открыть исходный файл на диске, но предварительно скопировав его в другое место. Поясню: при открытии файла Visio программой создается временный файл в той же папке, что и исходный, но скрытый. И когда программа будет открывать файл, то она автоматически будет пытаться внести изменения, записанные во временный файл, который тоже может быть поврежден.<br>

Даже если новый файл не был сохранен пользователем ни разу, но было произведено Автосохранение программой и файл был закрыт без сохранения, то его в этом случае тоже можно восстановить. Можно также восстановить и испорченный файл, т.к. при сохранении файла, файл Автосохранения был удален, но физически остался на диске. Вот его-то и можно восстановить. Существуют программа, которая умеет искать Visio файлы на диске, если они были удалены из корзины.<br>Программа называется Office DocumentsRescue Professional.<br><br>
		<img src="../images/pic2109.jpg"><br><br>
Сайт данной программы: <a href="www.objectrescue.com">www.objectrescue.com</a><br><br>
	На примере данной программы и проведем эксперимент.<br><br>
		<img src="../images/pic2110.png"><br><br>
	Для начала создадим новый документ, поместим ненулевое количество фигур и выставив малое время Автосохранения, дождемся первой точки Автосохранения и проверим, что файл был создан (С:\Documents and Settings\Имя_пользователя\Local Settings\Temp).<br><br>
		<img src="../images/pic2111.png"><br><br>
Закрываем файл Visio и отвечаем НЕТ на предложение сохранить данный файл.<br><br>
<b>Итак, у нас есть файл Автосохранения на диске и он был стерт программой.</b><br><br>

Открываем программу Office DocumentsRescue Professional.
Шаг 1 из 9. Указываем диск, на котором находится данная папка для временных файлов.<br><br>
		<img src="../images/pic2112.png"><br><br>
Шаг 2 из 9. Отмечаем файлы для восстановления.<br><br>
		<img src="../images/pic2113.png"><br><br>
Шаг 3 из 9. Процесс заканчивается, и показывается найденные файлы.<br><br>
		<img src="../images/pic2114.png"><br><br>
Просматриваем данные файлы и видим, что один из них, как раз тот файл, который программа сохранила как точку Автосохранения.<br><br>
		<img src="../images/pic2115.png"><br><br>
Соответственно, конечным результатом стало восстановление файла, который не был сохранен пользователем.<br><br>
		<img src="../images/pic2116.png"><br><br>
Соответственно если попробовать просканировать все диски, то можно найти файлы удаленые программой, которые когда-то были потеряны или случайно стерты, или при аварийном завершении программы были стерты или не подлежали восстановлению.<br><br>
<b>Внимание! Демо-версия программы не позволяет пользователю восстановить файлы. Только просмотреть.</b><br><br>

<IMG src="../images/null.gif" width=20 height=10>При всех вышеперечисленных советах нельзя гарантировать, что теперь Visio всегда будет работать как часы, но можно уменьшить вероятность возникновения ошибок, а при возникновении проблем, знать что делать и где искать.<br>
Также прошу заметить, что данная программа не является уникальной, а была взята первой из целого класса программ по восстановлению данных. Просто обратил внимание, что написано про восстановление VSD файлов и решил попробовать.<br><br>

	
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	   &#160;<A HREF="../articles/article20.html">Предыдущая статья</A>
	   &#160;<A HREF="../articles/article22.html">Следующая статья</A>
	   &#160;Автор: Ничков Алексей <A HREF="mailto:digitall@mail.ru">(Digitall)</A></P>


</body>
</html> 