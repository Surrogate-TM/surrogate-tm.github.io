<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>28. Разукрашиваем Actions</TITLE>
	
	</HEAD>
	<BODY MARGINHEIGHT="10" TOPMARGIN="10" MARGINWIDTH="12" LEFTMARGIN="12" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
<IMG ALT="Источник информации" ALIGN=RIGHT src="../images/prodigitall.png" width=450 height=100><br>
	<a href="../articles/index.html"><IMG BORDER=0 ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72></a>
	<H1><P ALIGN=CENTER>Статья 28. Разукрашиваем Actions</H1></P>
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>

	<BR><IMG src="../images/null.gif" width=40 height=10>

Часто, при создании нового меню мы можем лишь текстовой строкой показать пользователю на какой-либо пункт меню. Но это не предел. Помимо текстовой составляющей мы можем сделать и значок для нашей команды. Как именно сделать это, и рассказывается в статье.

	<BR><IMG src="../images/null.gif" width=40 height=10>

	А теперь немного теории. В таблице фигур (ShapeSheet) есть ячейка ButtonFace, которая отвечает за изображение при выборе команды.

	<BR><IMG src="../images/null.gif" width=40 height=10>
	
К примеру, если заполнить поле Menu каким-либо текстом и поставить в ячейку ButtonFace число 2, то отобразиться значок проверки орфографии. Т.е. по сути ограничения касаются только выбором из заранее предопределенных 
«образов», зато таких «образов» в Офисе порядка 6—7 тысяч. Есть где развернуться.

	<BR><IMG src="../images/null.gif" width=40 height=10>

Итак, с теорией покончено, теперь необходимо сделать фигуру, которая показывала бы максимально количество этих самых значков. Можно конечно самому по одному числу просмотреть 6 тысяч значков, но это дело крайне неблагодарное, хочется какой-либо выбор.

	<BR><IMG src="../images/null.gif" width=40 height=10>
	Итак, все что нам понадобится — это прямоугольник посередине листа. Все остальные действия будут производиться уже в Таблице фигур. Нарисовав прямоугольник входим в Таблицу фигур. Далее создаем раздел User-defined cells и уже в этом разделе создаем 51 ячейку. Почему 51, спросите вы. Потому, что в 51 ячейку мы внесем текст фигуры, а в 50 оставшихся одинаковую, ну, почти одинаковую, формулу.
	<BR><IMG src="../images/null.gif" width=40 height=10>
	Думаю, что раз уж вы, дорогой читатель, на 28 статье, то вставить формулу изъятия текста фигуры уже не представляется такой сложной задачей, я все же напомню.
	<BR><BR><IMG src="../images/null.gif" width=40 height=10>
	=SHAPETEXT(TheText)
	<BR><BR><IMG src="../images/null.gif" width=40 height=10>
	И вставляем эту формулу именно в 51 ячейку. Почему не в первую, сейчас поймете.
	<BR><IMG src="../images/null.gif" width=40 height=10>
	Теперь надо в разделе Actions создать 50 строк и во все строки ввести следующие формулы (в столбец Menu):
	<BR><BR><IMG src="../images/null.gif" width=40 height=10>
	Actions.Row_1.Menu	=Actions.Row_1.ButtonFace<BR><IMG src="../images/null.gif" width=40 height=10>
	Actions.Row_2.Menu	=Actions.Row_2.ButtonFace<BR><IMG src="../images/null.gif" width=40 height=10>
	...<BR><IMG src="../images/null.gif" width=40 height=10>
	Actions.Row_50.Menu	=Actions.Row_50.ButtonFace<BR><IMG src="../images/null.gif" width=40 height=10>
	<br><IMG src="../images/null.gif" width=40 height=10><IMG src="../images/pic2801.png">
	
	<BR><BR><IMG src="../images/null.gif" width=40 height=10>Теперь заполняем раздел User-defined Cells.

	<BR><BR><IMG src="../images/null.gif" width=40 height=10>
	User.Row_1	=SETF("Actions.Row_1.ButtonFace",1+50*User.Row_51)
	<BR><IMG src="../images/null.gif" width=40 height=10>
	User.Row_2	=SETF("Actions.Row_2.ButtonFace",2+50*User.Row_51)
	<BR><IMG src="../images/null.gif" width=40 height=10>
	...
	<BR><IMG src="../images/null.gif" width=40 height=10>
	User.Row_50	=SETF("Actions.Row_50.ButtonFace",50+50*User.Row_51)
	<br><br><IMG src="../images/null.gif" width=40 height=10><IMG src="../images/pic2802.png">

	<BR><BR><IMG src="../images/null.gif" width=40 height=10>Как видите, заполнять такт-в-такт гораздо удобнее.	
	<BR><IMG src="../images/null.gif" width=40 height=10>Теперь остается только ввести номер в фигуру и вызвать контекстное меню.
	
	<br><br><IMG src="../images/null.gif" width=40 height=10><IMG src="../images/pic2803.png">
	
	<BR><BR><IMG src="../images/null.gif" width=40 height=10>Теперь останется только запомнить номер понравившегося значка и ввести его в соответствующую ячейку ButtonFace строки команды.
	<BR><BR><IMG src="../images/null.gif" width=40 height=10>Приведу некоторые значки для удобства:
	<BR><BR><IMG src="../images/null.gif" width=40 height=10><IMG src="../images/0_200.png">
	<BR><IMG src="../images/null.gif" width=40 height=10><IMG src="../images/201_400.png">
	<BR><IMG src="../images/null.gif" width=40 height=10><IMG src="../images/401_600.png">
<BR><HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF">
	<P>Статьи:   <a href="./article1.html" title="Создание «горячих клавиш» в Visio 2000 En">1</a> 	 <a href="./article2.html" title="Методы создания масштабируемых объектов в Visio 2000 En">2</a> 	 <a href="./article3.html" title="Методы создания градиентных заливок в Visio 2000 En">3</a> 	 <a href="./article4.html" title="Методы создания 3D в Visio 2000 En">4</a> 	 <a href="./article5.html" title="Методы создания штампов и вопросы автопозиционирования в Visio 2000 Ru">5</a> 	 <a href="./article6.html" title="Как создать будильник? Методы создания интерактивных объектов в Visio 2000 Ru, Visio 2002, Visio 2003">6</a> 	 <a href="./article7.html" title="Методы создания шаблонов линий в Visio 2000 Ru, Visio 2002, Visio 2003">7</a> 	 <a href="./article8.html" title="Методы создания градиентных заливок линий в Visio 2000 Ru, Visio 2002, Visio 2003">8</a> 	 <a href="./article9.html" title="Методы и способы создания интерактивной прозрачности в Visio 2002, Visio 2003">9</a> 	 <a href="./article10.html" title="Методы создания растровой прозрачности векторных фигур в Visio 2002 Ru">10</a> 	 <a href="./article11.html" title="Формирование фигур в Visio 2000 Ru и Visio 2002 Ru">11</a> 	 <a href="./article12.html" title="Типы соединительных точек в Visio 2000 Ru и Visio 2002 Ru">12</a> 	 <a href="./article13.html" title="Способы оптимизации фигур в Visio">13</a> 	 <a href="./article14.html" title="Методы повышения визуального восприятия структурных схем в Visio. ">14</a> 	 <a href="./article15.html" title="Способы оптимизации линий в Visio">15</a> 	 <a href="./article16.html" title="Создание мультифигур в Visio">16</a> 	 <a href="./article17.html" title="Поэтапное создание в Visio примера из раздела «Работы»">17</a> 	 <a href="./article18.html" title="Способы выделения фигур в Visio 2000, Visio 2002">18</a> 	 <a href="./article19.html" title="Особенности графического представления фигур в Visio">19</a> 	 <a href="./article20.html" title="Методы создания шаблонов концов линий в Visio 2000 Ru, Visio 2002 Ru, Visio 2003">20</a> 	 <a href="./article21.html" title="Вопросы стабильности и испорченные файлы в Visio 2003">21</a> 	 <a href="./article22.html" title="Мебель своими руками в Visio 2003">22</a> 	 <a href="./article23.html" title="Растровые мультифигуры в Visio">23</a> 	 <a href="./article24.html" title="XML в Visio 2003">24</a> 	 <a href="./article25.html" title="Почти конфиденциально в Visio 2003">25</a> 	 <a href="./article26.html" title="Visio на двух мониторах">26</a> 	 <a href="./article27.html" title="«Информационный катарсис»">27</a> 	 28 	 <a href="./article29.html" title="Вектор привязки">29</a> 	 <a href="./article30.html" title="Про шаблоны">30</a> 
</p>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	   &#160;Автор: Ничков Алексей (a.k.a. Digitall)</P>


</body>
</html>