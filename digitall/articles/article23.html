<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>Растровые мультифигуры.</TITLE>
	</HEAD>
	<BODY MARGINHEIGHT="30" TOPMARGIN="30" MARGINWIDTH="40" LEFTMARGIN="40" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
	<IMG ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72>
	<H1><P ALIGN=CENTER>Растровые мультифигуры в Visio.</H1></P><BR>
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<IMG src="../images/null.gif" width=20 height=10>
	Помимо векторных мультифигур, т.е. фигур содержащих несколько фигур одновременно, манипуляции с содержанием возможны и с растровыми изображениями. Но создание и работа с такой фигурой несколько отличается от того, как это делается с векторными мультифигурами.<br><br>
	Вообще, зачем нужны мультифигуры? Они представляют собой ходячую папку с объектами, можно их еще сравнить с трафаретом, который содержит фигуры по одной теме и одного размера, что в принципе, недалеко от истины.<br><br>
	Растровые мультифигуры представляют собой большое изображение, но пользователь видит только небольшую часть этого изображения, а остальная часть изображения обрезается, т.е. примерно тоже самое.
Какую именно часть изображения в данный момент отображать, отвечают ячейки ImgOffsetX и ImgOffsetY раздела Информация об изображении (Foreign Image Info).<br><br>
	Создадим графический элемент. Для этого нарисуем несколько квадратов рядом и внутри напишем номера.<br><br>
	<img src="../images/pic2301.png" width=359 height=119><br><br>
	Теперь делаем из фигур группу, копируем в буфер и вставляем специальной вставкой как точечное аппаратно-независимое изображение.<br><br>
	<img src="../images/pic2302.png" width=471 height=297><br><br>
	Затем надо уменьшить ширину изображения в то количество раз, из какого количества элементов оно состоит. Данная фигура состоит из 4-х элементов, поэтому в формулу окна Позиция и размер вводим значение ширины делить на 4.<br><br>
	<img src="../images/pic2303.png" width=196 height=133><br><br>
	Само изображение теперь сузилось. Надо указать программе, что реальная длина изображения намного больше отображаемой области.<br><br>
	<img src="../images/pic2305.png" width=279 height=119><br><br>
	Для этого открываем ТаблицуФигур(ShapeSheet) и в разделе Информация об изображении (Foreign Image Info) в ячейку ImgWidth вводим =Width*4, изображение после этого стало нормальным.<br><br>
	<img src="../images/pic2304.png" width=649 height=52><br><br>
	Далее можно любым из удобных способов сделать инструмент смены изображения для фигуры, будь то ячейки пользователя, другие ячейки или меню для выбора изображения. Рассмотрим последний, как самый наглядный.
	Для этого создаем раздел Действия(Actions) и вводим соответствующие формулы.<br><br>
	Для Visio 2000, 2002.<br>
	<img src="../images/pic2306.png" width=586 height=86><br><br>
	Ячейки столбца Menu по отображаемой цифре.<br><br>
	В ячейку Actions.Row_1<br>
	Для Visio 2000, Visio 2002<br>
	Значение =SETF("ImgOffsetX";-Width*0)<br><br>
	Для Visio 2003<br>
	<img src="../images/pic2307.png" width=365 height=86><br><br>

Для Visio 2003<br>
Значение =SETF("ImgOffsetX",-Width*0)<br><br>

В ячейку Actions.Row_2<br>
Для Visio 2000, Visio 2002<br>
Значение =SETF("ImgOffsetX";-Width*1)<br>
Для Visio 2003<br>
Значение =SETF("ImgOffsetX",-Width*1)<br><br>

В ячейку Actions.Row_3<br>
Для Visio 2000, Visio 2002<br>
Значение =SETF("ImgOffsetX";-Width*2)<br>
Для Visio 2003<br>
Значение =SETF("ImgOffsetX",-Width*2)<br><br>

В ячейку Actions.Row_4<br>
Для Visio 2000, Visio 2002<br>
Значение =SETF("ImgOffsetX";-Width*3)<br>
Для Visio 2003<br>
Значение =SETF("ImgOffsetX",-Width*3)<br><br>
Т.е. собственно мы указываем формулой относительное смещение отображаемого изображения от начала координат самой фигуры.<br><br>
<img src="../images/pic2309.png" width=519 height=699><br><br>
Вот и все. Теперь меняя пункты меню, будут отображаться соответствующие изображения.<br><br>
<img src="../images/pic2308.png" width=219 height=319><br><br>





	<BR><A HREF="../stencils/index.html">Примеры из статьи.</A><BR><BR>
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	   &#160;<A HREF="../articles/article22.html">Предыдущая статья</A>
	   &#160;<A HREF="../articles/article24.html">Следующая статья</A>
	   &#160;Автор: Ничков Алексей <A HREF="mailto:digitall@mail.ru">(Digitall)</A></P>


</body>
</html>