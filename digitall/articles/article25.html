<DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>Почти конфиденциально в Visio 2003.</TITLE>
	</HEAD>
	<BODY MARGINHEIGHT="10" TOPMARGIN="10" MARGINWIDTH="12" LEFTMARGIN="12" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
<IMG ALT="Источник информации" ALIGN=RIGHT src="../images/prodigitall.png" width=450 height=100><br>
	<IMG ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72>
	<H1><P ALIGN=CENTER>Почти конфиденциально в Visio 2003.</H1></P>
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<IMG src="../images/null.gif" width=20 height=10>
	Защита документа представлена в Visio скупо. Вернее защиты нет как таковой. Есть только защита некоторых свойств документа, стилей. Но в самом простом случае её можно отключить. Итак, как же защитить свой документ? Причем еще сделать это лучше так, чтобы человек мог только просмотреть документ или распечатать и еще надпись во весь экран «Конфиденциально». Да, для этих целей подойдет PDF. Но ведь после преобразования в PDF редактировать документ можно только в этом самом reader’е. Да и вообще, отсутствие средств к защите документа раньше решалась просто, сохранением в графическом формате. Графический формат лучше всего подходит для пересылки по почте всяких чертежей. Для черно-белых лучше всего подходит PNG или TIFF, но дальше, дело вкуса.<br><br>

	Но иногда все же возникала необходимость отправки чертежей в векторном формате. Тоже есть решение, импортирование в метафайл в Word.<br><br>

	Ну да ладно. Есть Visio, и с его помощью и будем решать эту задачу. Открываем Visio, рисуем что-либо и пытаемся это защитить.<br><br>
	<img src="../images/pic2501.png"><br><br>
	
	Сначала создаем страницу по шаблону текущей.(<b>Insert>New Page...</b>)<br><br>
	<img src="../images/pic2502.png"><br><br>

	Потом делаем страницу с фигурами фоновой.(<b>File>Page Setup...>Page properties>Type>Background</b>)<br><br>
	<img src="../images/pic2503.png"><br><br>

	Настраиваем фоновую страницу как фон к основной.(<b>File>Page Setup...>Page properties>Background>Page-1</b>)<br><br>
	<img src="../images/pic2504.png"><br><br>

	И скрываем фоновую из возможности выбора страниц. Для этого входим в TаблицуФигур(ShapeSheet) страницы Page-1, т.е. фоновую страницу и в разделе Page Properties в ячейку UIVisibility вносим 1.<br><br>
	<img src="../images/pic2505.png"><br><br>
	<img src="../images/pic2506.png"><br><br>
	Пока еще активное окно принадлежит странице с фигурами, но стоит переключится на другую страницу, как выбрать фигуры и что-либо с ними сделать не получится.<br><br>
	Что получилось? Получилось, что есть одна единственная страница, на которой нельзя ничего выделить, можно чертить поверх данных фигур, распечатывать, и более ничего. Можно еще удалить все мастера документа, если есть интересные. :-)<br><br>
	
	Но раз есть способ все это скрыть, значит должен существовать способ все это вернуть обратно. Через интерфейс пользователя этого сделать не получится и в этом случае можно рассматривать как «плюс». Нужен макрос.<br><br>
	Вызываем окно редактора Microsoft Visual Basic, либо через меню (<b>Tools>Macros>Visual Basic Editor</b>), либо комбинацией клавиш Alt+F11. Затем в редакторе выбираем документ(ThisDocument) и двойным нажатием на нем открываем окно редактора. Далее в это окно вносим код.<br><br>
	
	Sub Test()<br>i = ThisDocument.Pages.Count<br>For k = 1 To i<br>ThisDocument.Pages.Item(k).PageSheet.CellsSRC(visSectionObject, visRowPage, visPageUIVisibility).FormulaU = "0"<br>Next k<br>End Sub<br><br>
	<img src="../images/pic2507.png"><br><br>

	Данный макрос ставит 0 в ячейку невидимости всех страниц.<br><br>
	
	Можно конечно и все сделать по другому. Сделать слой, потом защитить его или еще как-нибудь, но дело в том, что вернуть это все можно тоже использую интерфейс пользователя, стандартный интерфейс. В данном же случае надо знать, что есть фоновая страница, надо знать, что их можно скрывать и вообще глубоко разбираться в вопросе. Т.е. в сущности надо хорошо знать Visio да и еще VBA немного знать. Так что данный тип защиты подойдет для большинства пользователей Visio. Для пущей сложности, можно комбинировать информацию на основной странице с фоновой, если конечно в этом есть смысл. Иначе выльется это все в головную боль.<br><br>
	<h2>Советы по работе с программой</h2>
	<ol><li>Чтобы в дальнейшем вас не беспокоило окно наличия макросов в документе, просто удалите их. Странный совет, однако это так. Если вы удалили все модули из документа, а окно все равно появляется, значит надо зайти в ThisDocument, нажать Ctrl+A и затем Delete. После этого не закрывая окна сохраните документ средствами Visual Basic Editor'а. Окно о наличии макросов в документе более не будет появляться.
	<li>Простое объединение одной фигуры удаляет с него все соединительные точки. Легко и просто.
	<li>Мульти-мастер. Если в мастере создать 2-3 группы, и в образе удалить одну из них, скажем группу А, то если внести новую фигуру в группу А мастера, в образе её не будет! Достаточно сложный механизм для понимания, однако с помощью этого простого правила можно создавать <b>2! и более</b> различных образов одного мастера с возможностью последующего <b>раздельного</b> редактирования.<br>
	<img src="../images/pic2508.png">
	</ol>
<BR><HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF">
	<P>Статьи:   <a href="./article1.html" title="Создание «горячих клавиш» в Visio 2000 En">1</a> 	 <a href="./article2.html" title="Методы создания масштабируемых объектов в Visio 2000 En">2</a> 	 <a href="./article3.html" title="Методы создания градиентных заливок в Visio 2000 En">3</a> 	 <a href="./article4.html" title="Методы создания 3D в Visio 2000 En">4</a> 	 <a href="./article5.html" title="Методы создания штампов и вопросы автопозиционирования в Visio 2000 Ru">5</a> 	 <a href="./article6.html" title="Как создать будильник? Методы создания интерактивных объектов в Visio 2000 Ru, Visio 2002, Visio 2003">6</a> 	 <a href="./article7.html" title="Методы создания шаблонов линий в Visio 2000 Ru, Visio 2002, Visio 2003">7</a> 	 <a href="./article8.html" title="Методы создания градиентных заливок линий в Visio 2000 Ru, Visio 2002, Visio 2003">8</a> 	 <a href="./article9.html" title="Методы и способы создания интерактивной прозрачности в Visio 2002, Visio 2003">9</a> 	 <a href="./article10.html" title="Методы создания растровой прозрачности векторных фигур в Visio 2002 Ru">10</a> 	 <a href="./article11.html" title="Формирование фигур в Visio 2000 Ru и Visio 2002 Ru">11</a> 	 <a href="./article12.html" title="Типы соединительных точек в Visio 2000 Ru и Visio 2002 Ru">12</a> 	 <a href="./article13.html" title="Способы оптимизации фигур в Visio">13</a> 	 <a href="./article14.html" title="Методы повышения визуального восприятия структурных схем в Visio. ">14</a> 	 <a href="./article15.html" title="Способы оптимизации линий в Visio">15</a> 	 <a href="./article16.html" title="Создание мультифигур в Visio">16</a> 	 <a href="./article17.html" title="Поэтапное создание в Visio примера из раздела «Работы»">17</a> 	 <a href="./article18.html" title="Способы выделения фигур в Visio 2000, Visio 2002">18</a> 	 <a href="./article19.html" title="Особенности графического представления фигур в Visio">19</a> 	 <a href="./article20.html" title="Методы создания шаблонов концов линий в Visio 2000 Ru, Visio 2002 Ru, Visio 2003">20</a> 	 <a href="./article21.html" title="Вопросы стабильности и испорченные файлы в Visio 2003">21</a> 	 <a href="./article22.html" title="Мебель своими руками в Visio 2003">22</a> 	 <a href="./article23.html" title="Растровые мультифигуры в Visio">23</a> 	 <a href="./article24.html" title="XML в Visio 2003">24</a> 	 25 	 <a href="./article26.html" title="Visio на двух мониторах">26</a> 	 <a href="./article27.html" title="«Информационный катарсис»">27</a> 	 <a href="./article28.html" title="Разукрашиваем Actions">28</a> 	 <a href="./article29.html" title="Вектор привязки">29</a> 	 <a href="./article30.html" title="Про шаблоны">30</a> 
</p>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	   &#160;Автор: Ничков Алексей (a.k.a. Digitall)</P>

</body>
</html>