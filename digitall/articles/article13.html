<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>Способы оптимизации фигур в Visio.</TITLE>
	</HEAD>
	<BODY MARGINHEIGHT="10" TOPMARGIN="10" MARGINWIDTH="12" LEFTMARGIN="12" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
<IMG ALT="Источник информации" ALIGN=RIGHT src="../images/prodigitall.png" width=450 height=100><br>
	<IMG ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72>
	<H1><P ALIGN=CENTER>Способы оптимизации фигур в Visio.</H1></P>
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<IMG src="../images/null.gif" width=20 height=10>
	При работе с большими схемами, особенно при использовании большого количества составных объектов, иногда начинается замедление в работе приложения и быстрого увеличения размера файла. Конечно, это не критично, при наличии большого объема жесткого диска,  но что делать, если файл надо переслать по почте и вообще, только так и работаете. Тут лишний мегабайт не нужен. И работать с таким приложением становится не комфортно.<BR>
	<IMG src="../images/null.gif" width=20 height=10>Visio - объекты, это чаще всего, векторные объекты, каждый из которых носит с собой чемодан со своими настройками. И если взять отдельную группу, то багаж у этой группы будет не маленький. Так может в некоторых случаях будет лучше заменить эту группу одним векторный метафайлом? Но ведь тогда он будет лишен  возможностей по редактированию и функциональности. Некоторые фигуры, расположенные на чертеже, вообще не подвергаются редактированию, но если “разобрать” эти фигуры на составляющие, то можно заметить много перекрытий и невидимых областей, а Visio, в силу своей специфики, все равно обрисовывает и обрабатывает все эти невидимые области, затрачивая машинное время. Конечно, можно всегда сказать, что на быстрых машинах этого не происходит, но это не так.<BR>
	<IMG src="../images/null.gif" width=20 height=10>В отличие от других приложений (AutoCAD, CorelDraw), Visio критичен к количеству начерченных фигур и при их значительном увеличении, начинает “притормаживать” и это происходит не на 100 000 объектах, а гораздо раньше.<BR>
	<IMG src="../images/null.gif" width=20 height=10>Рассмотрим пример.
	<OL start=1>Создадим несколько файлов содержащих 1 600 объектов:
		<LI>Файл с объектом, состоящим из Visio-группы без использования мастера. Т.е. просто 1 600 простых фигур (в качестве простой фигуры выступает квадрат с градиентной заливкой, размерами 10х10 мм). 
		<LI>Файл с объектом, состоящим из Visio-группы при использования мастера. Т.е. 1 локальный мастер и 1 600 связанным с ним фигур.
		<LI>Файл с объектом, взятый из первого пункта и вставленный как метафайл. Т.е. 1 600 отдельных метафайлов.
		<LI>Файл с объектом, взятый из первого пункта и вставленный как метафайл и использованный в качестве мастера. Т.е. 1 локальный мастер и 1 600 его метафайлов.
	</OL>
	<IMG src="../images/null.gif" width=20 height=10>Далее производятся все действия с увеличением фигур в Visio-группе и записывались изменения размера файла. Также замерялось время открытия файла. Замер производился после 3-го запуска файла, чтобы он был в памяти.<BR>
	<BR><IMG ALT="Таблица 1" src="../images/pic1301.png" width="610" height="391"><BR>
	<BR><IMG src="../images/null.gif" width=20 height=10>Как видно из графика, при возрастании объектов в группе, размер файла с Visio-объектами начинает быстро возрастать, в то время как размер с метафайлами практически не изменился (рассматривая файлы с мастерами). Это связано с тем, что при преобразовании фигуры в метафайл, у него “отрезаются” перекрывающиеся области. И поэтому его размер практически не зависит от содержания. А в Visio-группе возникают перекрытия областей.<BR>
	<IMG src="../images/null.gif" width=20 height=10>Если рассматривать файлы без использования мастера, то использование большого количества метафайлов только увеличит размер конечного файла.<BR>
	<IMG src="../images/null.gif" width=20 height=10>Теперь рассмотрим влияние использования метафайлов на работу приложения.<BR>
	<BR><IMG ALT="Таблица 2" src="../images/pic1302.png" width="610" height="391"><BR>
	<BR><IMG src="../images/null.gif" width=20 height=10>При малых количествах объектов, как Visio, так и метафайлов, производительность не изменяется. Только при работе с более 16 000 объектов становится очевидным разрыв.<BR>
	<IMG src="../images/null.gif" width=20 height=10>Разработчики, для ускорения работы приложения, часто в трафаретах тоже используют метафайлы. Почти все фигуры в Network Device, Internet Symbols, Telecom – это трафареты с векторными фигурами. Но иногда они просто покупают их в таком виде.<BR>
	<IMG src="../images/null.gif" width=20 height=10>Также не забывайте удалять ненужные мастера из локального трафарета. Если мастер имеет связные фигуры на чертеже, то при его удалении появится предупреждение. Если нет, то это значит, что у мастера не было связных фигур, и он не использовался и, следовательно, увеличивал размер файла.<BR>
	<IMG src="../images/null.gif" width=20 height=10>Использование векторных метафайлов не панацея, только в некоторых случаях это может принести ощутимую пользу. Иногда замедление в работе приложения может быть связано с использованием не Visio трафаретов. Ведь можно использовать разные источники, для получения векторных фигур: векторные ClipArt’s (коллекции векторных картинок), из pdf-документов, путем предварительного преобразования, из fla-коллекций. И почти всегда в них слишком много точек или объектов. В таком виде они обычно не используются. Их надо разгруппировать, этим преобразовав в Visio объекты, “почистить”, удалить лишние объекты, сгруппировать или преобразовать в метафайл. Иногда, таким образом, можно увеличить скорость обработки таких объектов на порядок.<BR>
	<h3>Советы по работе с программой.</h3>
	<UL>	<LI>Если необходимо расположить один объект по противоположному краю другого, то проще всего нажать F8 и отметить центровку по краю и галочку “Создать направляющую и привязать к ней фигуры”, а затем привязать вторую фигуру, чем самому создавать направляющую и пытаться поставить ее к краю.
		<LI>Этот же способ можно использовать для создания направляющих по всему контуру фигуры. Конечно, можно и мышкой перетащить с линеек, но если контур расположен не на сетке. Тогда необходимо выделить эту фигуру. В этом случае даже если будет мешать другая фигура, то программа все равно будет располагать направляющую к той фигуре, которая выделена, даже если она расположена не на сетке. Если в диалоговом окне галочка затемнена, то можно включить на панели инструментов привязку к маркерам фигуры и начертить линию по диагонали фигуры и создать направляющую для нее.
		<LI>Если необходимо пространство разделить на нечетное количество частей (для таблицы). Для этого проще нарисовать простой прямоугольник, с “хорошими” размерами, т.е. с целыми размерами (10х10, 20х20), без десятых (23,5х23,5) и размножить принципом Х2. Т.е. выделил 1, скопировал, выделил 2, снова скопировал, выделил 4 и т.д. Убираем лишнее и группируем. Растягиваем по пространству и разгруппировываем. Выделяем вторую фигуру с краю и делаем выравнивание с созданием направляющей по левому краю, далее следующую. Останется удалить фигуры и оставить направляющие. Примерно таким же способом можно использовать линии и распределение фигур.
		<LI>Если необходимо редактировать одну страницу по другой, то чтобы не переключать постоянно мышкой страницы, проще открыть страницу документа в новом окне. Для этого надо в меню выбрать <b>Правка>Переход>Страница…</b> В диалоговом окне выбрать вторую страницу документа и отметить флажок <b>“Открыть страницу в новом окне”</b>. Теперь между станицами будет перемещаться намного проще. Также можно для каждой из страниц открыть разные трафареты. И если просто закрыть приложение и потом открыть файл, то такая структура представления страниц сохранится.
	<BR><HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF">
	<P>Статьи:   <a href="./article1.html" title="Создание «горячих клавиш» в Visio 2000 En">1</a> 	 <a href="./article2.html" title="Методы создания масштабируемых объектов в Visio 2000 En">2</a> 	 <a href="./article3.html" title="Методы создания градиентных заливок в Visio 2000 En">3</a> 	 <a href="./article4.html" title="Методы создания 3D в Visio 2000 En">4</a> 	 <a href="./article5.html" title="Методы создания штампов и вопросы автопозиционирования в Visio 2000 Ru">5</a> 	 <a href="./article6.html" title="Как создать будильник? Методы создания интерактивных объектов в Visio 2000 Ru, Visio 2002, Visio 2003">6</a> 	 <a href="./article7.html" title="Методы создания шаблонов линий в Visio 2000 Ru, Visio 2002, Visio 2003">7</a> 	 <a href="./article8.html" title="Методы создания градиентных заливок линий в Visio 2000 Ru, Visio 2002, Visio 2003">8</a> 	 <a href="./article9.html" title="Методы и способы создания интерактивной прозрачности в Visio 2002, Visio 2003">9</a> 	 <a href="./article10.html" title="Методы создания растровой прозрачности векторных фигур в Visio 2002 Ru">10</a> 	 <a href="./article11.html" title="Формирование фигур в Visio 2000 Ru и Visio 2002 Ru">11</a> 	 <a href="./article12.html" title="Типы соединительных точек в Visio 2000 Ru и Visio 2002 Ru">12</a> 	 13 	 <a href="./article14.html" title="Методы повышения визуального восприятия структурных схем в Visio. ">14</a> 	 <a href="./article15.html" title="Способы оптимизации линий в Visio">15</a> 	 <a href="./article16.html" title="Создание мультифигур в Visio">16</a> 	 <a href="./article17.html" title="Поэтапное создание в Visio примера из раздела «Работы»">17</a> 	 <a href="./article18.html" title="Способы выделения фигур в Visio 2000, Visio 2002">18</a> 	 <a href="./article19.html" title="Особенности графического представления фигур в Visio">19</a> 	 <a href="./article20.html" title="Методы создания шаблонов концов линий в Visio 2000 Ru, Visio 2002 Ru, Visio 2003">20</a> 	 <a href="./article21.html" title="Вопросы стабильности и испорченные файлы в Visio 2003">21</a> 	 <a href="./article22.html" title="Мебель своими руками в Visio 2003">22</a> 	 <a href="./article23.html" title="Растровые мультифигуры в Visio">23</a> 	 <a href="./article24.html" title="XML в Visio 2003">24</a> 	 <a href="./article25.html" title="Почти конфиденциально в Visio 2003">25</a> 	 <a href="./article26.html" title="Visio на двух мониторах">26</a> 	 <a href="./article27.html" title="«Информационный катарсис»">27</a> 	 <a href="./article28.html" title="Разукрашиваем Actions">28</a> 	 <a href="./article29.html" title="Вектор привязки">29</a> 	 <a href="./article30.html" title="Про шаблоны">30</a> 
</p>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	   &#160;Автор: Ничков Алексей (a.k.a. Digitall)</P>


</body>
</html> 