<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>Мебель своими руками в Visio 2003.</TITLE>
	</HEAD>
	<BODY MARGINHEIGHT="10" TOPMARGIN="10" MARGINWIDTH="12" LEFTMARGIN="12" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
<IMG ALT="Источник информации" ALIGN=RIGHT src="../images/prodigitall.png" width=450 height=100><br>
	<IMG ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72>
	<H1><P ALIGN=CENTER>Мебель своими руками в Visio 2003.</H1></P>
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<IMG src="../images/null.gif" width=20 height=10>
	Обычно при черчении планов зданий часто используются трафареты входящие в состав поставки Microsoft Visio. И часто в эти планы зданий входит различная мебель. К примеру, стол со стульями. В трафаретах Visio можно встретить различные столы со стульями, квадратные столы, круглые, овальные. И упущением данных фигур является жесткое закрепление количества стульев и их положение.<br><br>

	Значит надо сделать такой стол со стульями, который обладал бы наибольшей гибкостью.<br><br>

	Для начала нужно создать универсальный стол. Чтобы создать универсальный стол, надо собрать возможное количество вариаций форм стола и свезти к минимуму различные их формы. Дополнительно было бы неплохо сделать так, чтобы отображались размеры данного стола, и положение данных размеров также можно было бы изменять.<br><br>

	С требованиями к столу понятно. Переходим к стульям. Стульев, к примеру, будет от одного до четырех. Стулья должны располагаться с разных сторон и в разных положениях. Для П-образного стола этих положений для четырех стульев будет 8 различных вариантов.<br><br>

	Итак, исходными фигурами будут служить две фигуры. Одна будет играть роль столешницы, вторая стул. Только нужен стул со спинкой, и желательно, чтобы одной фигурой, для удобства. Стулья тоже могут быть разные. Тут уже всё зависит от вас.
	<h3>Делаем столу размеры.</h3>
	Создадим простой прямоугольник, который будет столом с размерами, скажем, 1,6 м на 0,8 м. Теперь надо отобразить эти размеры в самой фигуре. Для этого делаем вставку поля.<br><br>
	<IMG ALT="Формула" src="../images/pic2201.png" width=287 height=399><br><br>
	И вводим формулу =FORMATEX(Width,"0","m","cm")<br><br>
	<IMG ALT="Формула" src="../images/pic2202.png" width=648 height=259><br><br>
	Затем ставим значок Х и повторяем операцию с другой формулой =FORMATEX(Height,"0","m","cm")<br><br>
	<IMG ALT="Формула" src="../images/pic2203.png" width=648 height=259><br><br>
	Изменяя размеры фигуры, записанные значения в фигуру тоже будут изменяться.<br><br>
	<IMG ALT="Формула" src="../images/pic2204.png" width=463 height=191><br><br>
	Теперь надо сделать точку управления надписью. Для этого надо создать в ТаблицеФигур (ShapeSheet) раздел Элементы управления (Controls). Потом надо сместить надпись относительно фигуры.<br><br>
	<IMG ALT="Формула" src="../images/pic2205.png" width=399 height=127><br><br>
	Делается это инструментом текстового блока (Ctrl+Shift+4), чтобы в ТаблицеФигур (Shapesheet) появился раздел Трансформация текста (Text transform).<br><br>
	<IMG ALT="Формула" src="../images/pic2206.png" width=614 height=70><br><br>
	И вносим изменения в этот раздел.<br><br>
	В ячейку TxtPinX<br>
	Значение: =Controls.Row_1<br><br>
	В ячейку TxtPinY<br>
	Значение: =Controls.Row_1.Y<br><br>
	И перемещаем текст, используя точку управления, в центр фигуры.<br><br>
	<IMG ALT="Формула" src="../images/pic2208.png" width=399 height=127><br><br>
	<h3>Делаем стулья столу.</h3>
	Сначала надо сделать стулья. Самый просто способ, это взять две фигуры(1), применить команду Фрагментация (Fragment)(2), потом объединить части спинки (3), и применить команду Присоединение(Join)(4), потом залить цветом(5) и все. Стул готов.<br><br>
	<IMG ALT="Формула" src="../images/pic2209.png" width=671 height=335><br><br>
	
	Для того, чтобы размещать стулья у стола, есть несколько способов, но самый простой способ, при котором 1 стул и 2 стула – это разные одиночные фигуры. Т.е. надо взять 2 стула и снова применить к ним команду Присоединение (Join).<br><br>
	<IMG ALT="Формула" src="../images/pic2217.png" width=191 height=95><br><br>
	Теперь надо из стола сделать группу. Для этого в меню выбираем Фигура>Группировка>Конвертировать в группу (Shape>Grouping>Convert to Group).<br><br>
	Итак, открываем группу стола, размещаем фигуры, как показано на рисунке. Т.е. один "двойной" стул и "одинарный" с одной стороны и тоже самое с другой.<br><br>
	<IMG ALT="Формула" src="../images/pic2210.png" width=154 height=136><br><br>
	<h3>Введение формул.</h3>Необходимо сначала внести изменения в ТаблицуФигур(ShapeSheet) стола. Заходим в неё и создаем разделы Ячейки пользователя (User-defined cells) и Действия (Actions) и вносим изменения в ячейки.<br>
	Раздел Ячейки пользователя (User-defined cells): создаем вторую стоку.<br><br>
	Ячейка Prompt строка 1.<br>
	Значение: Кол-во стульев<br><br>
	Ячейка Prompt строка 2.<br>
	Значение: Положение<br><br>
	<IMG ALT="Формула" src="../images/pic2213.png" width=339 height=53><br><br>
	Раздел Действия (Actions)<br><br>
	Ячейка Actions.Row_1.Action<br>
	Значение: =SETF("User.Row_1",1)<br><br>
	Ячейка Actions.Row_1.Menu<br>
	Значение: ="1 стул"<br><br>
	Ячейка Actions.Row_2.Action<br>
	Значение: =SETF("User.Row_1",2)<br><br>
	Ячейка Actions.Row_2.Menu<br>
	Значение: ="2 стула"<br><br>
	3-я и 4-я строка по аналогии.<br><br>
	Ячейка Actions.Row_5.Action<br>
	Значение: =SETF("User.Row_2",NOT("User.Row_2"))<br><br>
	Ячейка Actions.Row_5.Menu<br>
	Значение: ="Изменить положение"<br><br>
	<IMG ALT="Формула" src="../images/pic2212.png" width=486 height=104><br><br>

Теперь разберемся со стульями. Для начала составим таблицу, когда должен появляться какой стул.<br><br>
	<table border="1" align="left" width="50%" height=256>
  		<tr>
			<td>Ячейка-значение\Фигура</td>
			<td>1 стул сверху</td>
			<td>1 стул снизу</td>
			<td>Двойной стул сверху</td>
			<td>Двойной стул снизу</td>
		</tr>
		<tr>
			<td>Row_1=1,Row_2=0</td><td>1</td><td>0</td><td>0</td><td>0</td>
		</tr>
		<tr>
			<td>Row_1=1,Row_2=1</td><td>0</td><td>1</td><td>0</td><td>0</td>
		</tr>
		<tr>
			<td>Row_1=2,Row_2=0</td><td>0</td><td>0</td><td>1</td><td>0</td>
		</tr>
		<tr>
			<td>Row_1=2,Row_2=1</td><td>0</td><td>0</td><td>0</td><td>1</td>
		</tr>
		<tr>
			<td>Row_1=3,Row_2=0</td><td>1</td><td>0</td><td>0</td><td>1</td>
		</tr>
		<tr>
			<td>Row_1=3,Row_2=1</td><td>0</td><td>1</td><td>1</td><td>0</td>
		</tr>
		<tr>
			<td>Row_1=4</td><td>0</td><td>0</td><td>1</td><td>1</td>
		</tr>
		</table><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

	<h4>Первый стул сверху.</h4>
	Сначала надо создать раздел Ячейки пользователя (User-defined cells). И внести в них ссылку на ячейки того же раздела у группы.<br><br>
	<IMG ALT="Формула" src="../images/pic2214.png" width=328 height=53><br><br>
	Если в ТаблицеФигур (ShapeSheet) содержится несколько разделов Геометрия(Geometry), то надо сделать ссылку ячеек GeometryN.NoShow на Geometry1.NoShow.

	Далее вносим изменения в ячейку Geometry1.Noshow<br>
	Значение: =NOT(OR(AND(User.Row_1=1,User.Row_2=0),AND(User.Row_1=3,User.Row_2=0)))<br><br>
	<IMG ALT="Формула" src="../images/pic2215.png" width=967 height=35><br><br>
	Как видите, формула была взята, на основании данных таблицы. Остальные формулы стульев также были составлены, используя таблицу истинности. Составляется она очень просто. Берутся значения, в которых данная фигуры должна быть видна, записываются значения контролируемых ячеек через функцию AND (логическое И), а объединяются эти значения функцией OR (логическое ИЛИ). В принципе можно вывести и более короткую формулу, но данный способ очень нагляден и прост.
	<h4>Первый стул снизу.</h4>
	Тоже делаются ссылки раздела Ячейки пользователя (User-defined cells), тоже делаются ссылки ячеек раздела ГеометрияN (GeometryN) на ячейку Geometry1.NoShow и в нее вносится соответствующая запись.<br>
	Значение: =NOT(OR(AND(User.Row_1=1,User.Row_2=1),AND(User.Row_1=3,User.Row_2=1)))<br>
	<h4>Двойной стул сверху</h4>
	Все тоже самое и дополнительно свои данные в ячейку Geometry1.NoShow.<br>
	Значение: =NOT(OR(AND(User.Row_1=2,User.Row_2=0),AND(User.Row_1=3,User.Row_2=1),AND(User.Row_1=4)))<br>
	<h4>Двойной стул снизу</h4>
	Последние изменения и снова своя формула в ячейку Geometry1.NoShow.<br>
	Значение: =NOT(OR(AND(User.Row_1=2,User.Row_2=1),AND(User.Row_1=3,User.Row_2=0),AND(User.Row_1=4)))<br><br>
	Вот и все. Фигура в целом готова и полностью функциональна.<br><br>
	<IMG ALT="Пример фигуры" src="../images/pic2211.png" width=287 height=335><br><br>
	Дополнительно можно сделать, чтобы выбранный пункт меню исчезал или был отмечен, но это уже всё тонкости и дело вкуса.<br>
	Примерно такую же схему поведения можно применить и к другим фигурам. К фигуре машины, например.<br><br>
	<IMG ALT="Пример фигуры" src="../images/pic2216.png" width=662 height=456><BR><HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF">
	<P>Статьи:   <a href="./article1.html" title="Создание «горячих клавиш» в Visio 2000 En">1</a> 	 <a href="./article2.html" title="Методы создания масштабируемых объектов в Visio 2000 En">2</a> 	 <a href="./article3.html" title="Методы создания градиентных заливок в Visio 2000 En">3</a> 	 <a href="./article4.html" title="Методы создания 3D в Visio 2000 En">4</a> 	 <a href="./article5.html" title="Методы создания штампов и вопросы автопозиционирования в Visio 2000 Ru">5</a> 	 <a href="./article6.html" title="Как создать будильник? Методы создания интерактивных объектов в Visio 2000 Ru, Visio 2002, Visio 2003">6</a> 	 <a href="./article7.html" title="Методы создания шаблонов линий в Visio 2000 Ru, Visio 2002, Visio 2003">7</a> 	 <a href="./article8.html" title="Методы создания градиентных заливок линий в Visio 2000 Ru, Visio 2002, Visio 2003">8</a> 	 <a href="./article9.html" title="Методы и способы создания интерактивной прозрачности в Visio 2002, Visio 2003">9</a> 	 <a href="./article10.html" title="Методы создания растровой прозрачности векторных фигур в Visio 2002 Ru">10</a> 	 <a href="./article11.html" title="Формирование фигур в Visio 2000 Ru и Visio 2002 Ru">11</a> 	 <a href="./article12.html" title="Типы соединительных точек в Visio 2000 Ru и Visio 2002 Ru">12</a> 	 <a href="./article13.html" title="Способы оптимизации фигур в Visio">13</a> 	 <a href="./article14.html" title="Методы повышения визуального восприятия структурных схем в Visio. ">14</a> 	 <a href="./article15.html" title="Способы оптимизации линий в Visio">15</a> 	 <a href="./article16.html" title="Создание мультифигур в Visio">16</a> 	 <a href="./article17.html" title="Поэтапное создание в Visio примера из раздела «Работы»">17</a> 	 <a href="./article18.html" title="Способы выделения фигур в Visio 2000, Visio 2002">18</a> 	 <a href="./article19.html" title="Особенности графического представления фигур в Visio">19</a> 	 <a href="./article20.html" title="Методы создания шаблонов концов линий в Visio 2000 Ru, Visio 2002 Ru, Visio 2003">20</a> 	 <a href="./article21.html" title="Вопросы стабильности и испорченные файлы в Visio 2003">21</a> 	 22 	 <a href="./article23.html" title="Растровые мультифигуры в Visio">23</a> 	 <a href="./article24.html" title="XML в Visio 2003">24</a> 	 <a href="./article25.html" title="Почти конфиденциально в Visio 2003">25</a> 	 <a href="./article26.html" title="Visio на двух мониторах">26</a> 	 <a href="./article27.html" title="«Информационный катарсис»">27</a> 	 <a href="./article28.html" title="Разукрашиваем Actions">28</a> 	 <a href="./article29.html" title="Вектор привязки">29</a> 	 <a href="./article30.html" title="Про шаблоны">30</a> 
</p>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	   &#160;Автор: Ничков Алексей (a.k.a. Digitall)</P>


</body>
</html>