<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>Методы создания штампов и вопросы автопозиционирования.</TITLE>
	</HEAD>
	<BODY MARGINHEIGHT="10" TOPMARGIN="10" MARGINWIDTH="12" LEFTMARGIN="12" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
<IMG ALT="Источник информации" ALIGN=RIGHT src="../images/prodigitall.png" width=450 height=100><br>
	<IMG ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72>
	<H1><P ALIGN=CENTER>Методы создания штампов и вопросы автопозиционирования.</H1></P>
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<IMG src="../images/null.gif" width=20 height=10>Все кто работает в Visio, не раз задумывались над рамкой или штампом и чтобы сам ровнялся по странице, в нужном месте… Но обычно просто рисовалась таковая от руки и все. Если страниц в чертеже одна, а если 20 и с разным масштабом и ориентацией страниц. Тогда и необходимо придумать универсальный инструмент.   Его мы и создадим, но сначала немного теории.<BR>
	В Visio мы работаем с объектами независимо от того что чертим, все это для Visio одинаковые объекты с хвостиком настроек. Для примера создадим прямоугольник. Прямоугольник, это объект с длинным хвостом параметров, текстовая надпись это тот же прямоугольник, но без заливки и контура, и линия как ни странно тоже прямоугольная фигура, но только нулевой толщины. Что касается группы, то при ее создании создается новый объект, т.е. это сама группа как объект + все входящие в эту группу фигуры и как следствие увеличение числа параметров.  Все это можно посмотреть выделив прямоугольник и открыть ТаблицуФигур (Окно>Показать ТаблицуФигур) в Visio 2000 Ru . В этой таблице собраны все параметры которые описывают фигуру. Все параметры разбиты на разделы для удобства. Обратите внимание на раздел Геометрия1, в нем описано формулами создание этого прямоугольника, а нам показывается его графическое представление.<BR>
	<BR><IMG ALT="Раздел Геометрия1" src="../images/pic0401.gif" width="368" height="141"><BR>
	<BR>Соответственно один раздел на геометрию и по одному разделу параметров этой фигуры. Если мы создадим штамп сразу из прямоугольников, то получим несколько десятков прямоугольников  и сразу заметим, как начнет притормаживать программа при работе с этим штампом. Произойдет это потому, что у нас, предположим, 50 прямоугольников и 50 разделов параметров этих фигур. Но все можно упростить. Если создать, например, 20 фигур и применить к ним команду Присоединение (Фигуры>Операции>Присоединение), то, посмотрев снова в ТаблицуФигур, мы увидим что Разделов Геометрия стало больше, а остальных параметров всего по одному разделу.<BR>
	<BR><IMG ALT="Разделы Геометрия" src="../images/pic0402.gif" width="112" height="186"><BR>
	<BR>И получившаяся фигуры будет обрабатываться намного быстрее, чем группа созданная из них. По такому принципу и будем уменьшать количество фигур в штампе.<BR>
	<BR><IMG src="../images/null.gif" width=20 height=10>Итак, приступим:<BR>
	<IMG src="../images/null.gif" width=20 height=10>Во-первых, нарисуем большую таблицу будущего штампа, используя наименьшее кол-во фигур:
	<OL TYPE="1" START="1">
		<LI>Малая сетка, как на рисунке (это 1 объект, составленный и объединенный из 14 линий, а не сгруппированный).<BR>
		<BR><IMG ALT="Малая сетка" src="../images/pic0403.gif" width="276" height="236"><BR>
		<BR><LI>Основной контур (это 1 объект, состоящий из 1 прямоугольника по контуру и 7 линий)<BR>
		<BR><IMG ALT="Большая сетка большой таблицы" src="../images/pic0404.gif" width="750" height="243"><BR>
		<BR><LI>Надписи (4 объекта. Можно и в 3 сделать, но для удобства лучше 4).<BR>
		<BR><IMG ALT="Надписи большой таблицы" src="../images/pic0405.gif" width="750" height="104"><BR>
		<BR>Только с надписями есть одна тонкость, необходимо выставить все отступы на 0 мм и между надписями в фигуре лучше делать пробел размером шрифта 6 ед. Пока получилось 6 объектов.<BR>
		<BR><LI>Малая боковая таблица (1 надпись и 1 объект, из 1 прямоугольника и 4 линий).<BR>
		<BR><IMG ALT="Фигуры малой таблицы" src="../images/pic0406.gif" width="606" height="114"><BR>
		<BR><LI>И последний объект это собственно рамка (1 прямоугольник без заливки).</OL>
		Вот и все. 8 правильно составленных объектов и весь штамп. Теперь займемся автопозиционированием. Наша рамка будет группой, в силу того, что если она будет мастером в трафарете, то при добавлении на лист эти элементы будут помещаться все равно группой.<BR>
	<BR><IMG src="../images/null.gif" width=20 height=10>Нам необходимо создать 2 группы:
	<UL><LI>Группа большой таблицы.
		<LI>Группа малой таблицы.
	</UL>
	Далее все эти 4 фигуры: Большая Таблица + Малая Таблица + Рамка, располагаем примерно так, как они должны стоять, точность здесь не требуется (малую таблицу необходимо повернуть на 90 градусов) и группируем, далее заходим в ТаблицуФигур получившейся группы. Делаем вставку раздела Ячейки пользователя (В ТаблицеФигур нажать правую кнопку мыши и выбрать>Вставка раздела>Ячейки пользователя) и создать 4 строки с названиями.<BR>
	<BR><IMG ALT="Формулы Главной группы" src="../images/pic0407.gif" width="557" height="86"><BR>
	<BR>И ввести следующие формулы:
	<OL TYPE="1" START="1">
		<LI>=ThePage!DrawingScale/ThePage!PageScale
		<LI>=ThePage!DrawingScale*ThePage!PageScale/1 mm^2
		<LI>Оставить пустым
		<LI>=ThePage!PageWidth<ThePage!PageHeight<BR>
	</OL>
	Теперь нам необходимо узнать ID данной группы, для этого зайдите в «Специальное…» (Формат>Специальное) и запомните номер ID группы(13-й к примеру), далее он нам понадобится.<BR> 
	С группой пока все. Далее займемся рамкой. Для этого необходимо выделить ее из группы двойным нажатием и вызвать ТаблицуФигур для нее. Далее надо снова создать такие же строки, но написать другое:<BR>
	<BR><IMG ALT="Формулы рамки" src="../images/pic0408.gif" width="368" height="86"><BR>
	<OL TYPE="1" START="1">
		<LI>=Sheet.13!User.Row_1
		<LI>=Sheet.13!User.Row_2
		<LI>=Sheet.13!User.Row_3
		<LI>=Sheet.13!User.Row_4<BR>
	</OL>
	Где вместо 13 впишите свой ID главной группы.<BR>
	В раздел Трансформация Фигуры, внесите следующие изменения:<BR>
	<BR><IMG ALT="Формулы раздела Трансформация фигуры" src="../images/pic0409.gif" width="1090" height="86"><BR>
	<BR>В ячейку Width:<BR>=IF(User.Row_4=1;GUARD(ThePage!PageWidth-(28,7 mm*User.Row_1));GUARD(ThePage!PageWidth-(14 mm*User.Row_1)))
	<BR>В ячейку Height:<BR>=IF(User.Row_4=1;GUARD(ThePage!PageHeight-(14 mm*User.Row_1));GUARD(ThePage!PageHeight-(28,7 mm*User.Row_1)))
	<BR>В ячейку Angle:<BR>=GUARD (0 deg)
	<BR>В ячейку PinX:<BR>=IF(User.Row_4=1;GUARD(21,7 mm/User.Row_2);GUARD(7 mm/User.Row_2))
	<BR>В ячейку PinY:<BR>=GUARD(7 mm/User.Row_2)
	<BR>В ячейку LocPinX:<BR>=GUARD(0)
	<BR>В ячейку LocPinY:<BR>=GUARD(0)<BR>
	<BR>С рамкой все. Далее займемся большой таблицей. Для этого необходимо выделить ее из группы двойным нажатием и вызвать ТаблицуФигур для нее. Далее надо снова создать такие же строки в разделе Ячейки пользователя, и так же заполнить:<BR>
	<BR><IMG ALT="Формулы большой таблицы" src="../images/pic0408.gif" width="368" height="86"><BR>
	<OL TYPE="1" START="1">
		<LI>=Sheet.13!User.Row_1
		<LI>=Sheet.13!User.Row_2
		<LI>=Sheet.13!User.Row_3
		<LI>=Sheet.13!User.Row_4<BR>
	</OL>
	Где вместо 13 впишите свой ID главной группы.<BR>
	В раздел Трансформация Фигуры этой большой таблицы, внесите следующие изменения:<BR>
	<BR>В ячейку Width:<BR>=GUARD(181,3 mm*User.Row_1)
	<BR>В ячейку Height:<BR>=GUARD(54,2334 mm*User.Row_1)
	<BR>В ячейку Angle:<BR>=IF(User.Row_4=1;GUARD(90 deg*User.Row_3);GUARD(-90 deg*User.Row_3))
	<BR>В ячейку PinX:<BR>=IF(User.Row_4=1;IF(User.Row_3=0;GUARD(ThePage!PageWidth-(7 mm*User.Row_1));GUARD(ThePage!PageWidth-7 mm*User.Row_1));IF(User.Row_3=0;GUARD(ThePage!PageWidth-7 mm*User.Row_1);GUARD(7 mm*User.Row_1)))
	<BR>В ячейку PinY:<BR>=IF(User.Row_3=0;IF(User.Row_4=0;GUARD(7 mm*User.Row_1);GUARD(7 mm*User.Row_1));IF(User.Row_4=0;GUARD(7 mm*User.Row_1);GUARD(ThePage!PageHeight-7 mm*User.Row_1)))
	<BR>В ячейку LocPinX:<BR>=GUARD(Width)
	<BR>В ячейку LocPinY:<BR>=GUARD(0)<BR>
	<BR>С большой таблицей все. Далее займемся малой таблицей. Для этого необходимо выделить ее из группы двойным нажатием и вызвать ТаблицуФигур для нее. Для нее необходимо тоже создать такие же строки в разделе Ячейки пользователя, и так же заполнить:<BR>
	<BR><IMG ALT="Формулы малой таблицы" src="../images/pic0408.gif" width="368" height="86"><BR>
	<OL TYPE="1" START="1">
		<LI>=Sheet.13!User.Row_1
		<LI>=Sheet.13!User.Row_2
		<LI>=Sheet.13!User.Row_3
		<LI>=Sheet.13!User.Row_4<BR>
	</OL>
	Где вместо 13 впишите свой ID главной группы.<BR>
	В раздел Трансформация Фигуры этой малой таблицы, внесите следующие изменения:<BR>
	<BR><IMG ALT="Формулы раздела Трансформация фигуры" src="../images/pic0410.gif" width="825" height="86"><BR>
	<BR>В ячейку Width:<BR>=GUARD(143 mm*User.Row_1)
	<BR>В ячейку Height:<BR>=GUARD(14,7 mm*User.Row_1)
	<BR>В ячейку Angle:<BR>=IF(User.Row_4=1;GUARD(90 deg);GUARD(0 deg))
	<BR>В ячейку PinX:<BR>=GUARD(7 mm*User.Row_1)
	<BR>В ячейку PinY:<BR>=IF(User.Row_4=1;GUARD(7 mm*User.Row_1);GUARD(ThePage!PageHeight-(7 mm*User.Row_1)))
	<BR>В ячейку LocPinX:<BR>=GUARD(0)
	<BR>В ячейку LocPinY:<BR>=GUARD(Height)<BR>
	<BR>Все эти параметры для случая, когда малая таблица создавалась в ширину, группировалась, а потом поворачивалась на 90 градусов.
	<BR>И наконец внести еще поправки в Главную группу. Для этого ее опять необходимо открыть в ТаблицеФигур и создать раздел Действия (нажать на правую кнопку мыши>Вставка раздела>Действия). Затем заполнить:<BR>
	<BR><IMG ALT="Формулы раздела Действия" src="../images/pic0411.gif" width="566" height="35"><BR>
	<BR>В разделе Трансформация Фигуры Главной группы, внесите следующие изменения:<BR>
	<BR><IMG ALT="Формулы раздела Трансформация фигуры" src="../images/pic0412.gif" width="315" height="86"><BR>
	<BR>В ячейку Width:<BR>=GUARD(ThePage!PageWidth)
	<BR>В ячейку Height:<BR>=GUARD(ThePage!PageHeight)
	<BR>В ячейку Angle:<BR>=GUARD(0 deg)
	<BR>В ячейку PinX:<BR>=GUARD(0)
	<BR>В ячейку PinY:<BR>=GUARD(0)
	<BR>В ячейку LocPinX:<BR>=GUARD(0)
	<BR>В ячейку LocPinY:<BR>=GUARD(0)<BR>
	<BR>Теперь если выделить нашу рамку и нажать правую кнопку мыши, то мы увидим новое меню, которое и будет менять ориентацию нашей рамки независимо от листа.<BR>
	<BR><IMG ALT="Действия для вызова меню" src="../images/pic0413.gif" width="349" height="223"><BR>
	<BR>Это очень удобно если необходимо в одном документе чертить листы разной ориентации. Просто поворачиваем нужные страницы(Ctrl+0 и переместить на угол листа), меняем ориентацию рамки и работаем. Теперь тестируем на всех масштабах, поправляем надписи, если где съехали и все. Как можно было заметить у нашей рамки отступ не 5 мм, а 7. Это сделано из-за того, что Visio сам имеет отступ 6,5 мм.
Наша автопозиционирующаяся рамка готова. Всего фигур получилось 12.<BR>
	<BR><A HREF="../stencils/index.html">Примеры из статьи.</A><BR><HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF">
	<P>Статьи:   <a href="./article1.html" title="Создание «горячих клавиш» в Visio 2000 En">1</a> 	 <a href="./article2.html" title="Методы создания масштабируемых объектов в Visio 2000 En">2</a> 	 <a href="./article3.html" title="Методы создания градиентных заливок в Visio 2000 En">3</a> 	 <a href="./article4.html" title="Методы создания 3D в Visio 2000 En">4</a> 	 5 	 <a href="./article6.html" title="Как создать будильник? Методы создания интерактивных объектов в Visio 2000 Ru, Visio 2002, Visio 2003">6</a> 	 <a href="./article7.html" title="Методы создания шаблонов линий в Visio 2000 Ru, Visio 2002, Visio 2003">7</a> 	 <a href="./article8.html" title="Методы создания градиентных заливок линий в Visio 2000 Ru, Visio 2002, Visio 2003">8</a> 	 <a href="./article9.html" title="Методы и способы создания интерактивной прозрачности в Visio 2002, Visio 2003">9</a> 	 <a href="./article10.html" title="Методы создания растровой прозрачности векторных фигур в Visio 2002 Ru">10</a> 	 <a href="./article11.html" title="Формирование фигур в Visio 2000 Ru и Visio 2002 Ru">11</a> 	 <a href="./article12.html" title="Типы соединительных точек в Visio 2000 Ru и Visio 2002 Ru">12</a> 	 <a href="./article13.html" title="Способы оптимизации фигур в Visio">13</a> 	 <a href="./article14.html" title="Методы повышения визуального восприятия структурных схем в Visio. ">14</a> 	 <a href="./article15.html" title="Способы оптимизации линий в Visio">15</a> 	 <a href="./article16.html" title="Создание мультифигур в Visio">16</a> 	 <a href="./article17.html" title="Поэтапное создание в Visio примера из раздела «Работы»">17</a> 	 <a href="./article18.html" title="Способы выделения фигур в Visio 2000, Visio 2002">18</a> 	 <a href="./article19.html" title="Особенности графического представления фигур в Visio">19</a> 	 <a href="./article20.html" title="Методы создания шаблонов концов линий в Visio 2000 Ru, Visio 2002 Ru, Visio 2003">20</a> 	 <a href="./article21.html" title="Вопросы стабильности и испорченные файлы в Visio 2003">21</a> 	 <a href="./article22.html" title="Мебель своими руками в Visio 2003">22</a> 	 <a href="./article23.html" title="Растровые мультифигуры в Visio">23</a> 	 <a href="./article24.html" title="XML в Visio 2003">24</a> 	 <a href="./article25.html" title="Почти конфиденциально в Visio 2003">25</a> 	 <a href="./article26.html" title="Visio на двух мониторах">26</a> 	 <a href="./article27.html" title="«Информационный катарсис»">27</a> 	 <a href="./article28.html" title="Разукрашиваем Actions">28</a> 	 <a href="./article29.html" title="Вектор привязки">29</a> 	 <a href="./article30.html" title="Про шаблоны">30</a> </p>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	   &#160;Автор: Ничков Алексей (a.k.a. Digitall)</P>


</body>
</html> 
