<!DOCTYPE html>
<html lang="en-US">
<head>
              <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.5/css/bootstrap.min.css">
<title>Data refresh from PowerPivot &#8211; Chris Hopkins&#039; Blog &#8211; #makinitdostuff</title>
<link rel='dns-prefetch' href='//ajax.aspnetcdn.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='stylesheet' id='wds-ratings-css'  href='https://blogs.msdn.microsoft.com/wp-content/plugins/wds-ratings/wds-ratings.css?ver=20161014' type='text/css' media='all' />
<link rel='stylesheet' id='microsoft-parent-style-css'  href='https://blogs.msdn.microsoft.com/wp-content/themes/microsoft/style.css?ver=02092017' type='text/css' media='all' />
<link rel='stylesheet' id='microsoft-child-style-css'  href='https://blogs.msdn.microsoft.com/wp-content/themes/microsoft-msdn/style.css?ver=04152016' type='text/css' media='all' />
	<div id='msccBanner' dir='ltr' data-site-name='uhf-TechNetBlogs' data-mscc-version='0.4.0' data-nver='aspnet-2.0.7' data-sver='0.1.2' class='cc-banner' role='alert'>
<link rel=""shortcut icon"" href=""https://i1.social.s-msft.com/Forums/GlobalResources/images/Technet/favicon.ico"">

<link rel="canonical" href="https://blogs.msdn.microsoft.com/chhopkin/2011/08/22/data-refresh-from-powerpivot/" />
<!-- og:title -->
<meta property="og:title" content="Data refresh from PowerPivot" />
<!-- og:description -->
<meta property="og:description" content="In a series of articles I explored the different scenarios around SQL and data refresh.&nbsp; One of the scenarios that I have not covered is how to create a data refreshable diagram from Analysis Services.&nbsp; If you do not already know this, Visio and Visio Services cannot refresh directly from Analysis Services, however we could..." />
</head>
<body class="post-template-default single single-post postid-823 single-format-standard">
<div id="page" class="site container-fluid">
	<header id="site-header" class="site-header row" role="banner">
		<div id="site-header-global-wrapper" class="site-header-global-wrapper">
			<div id="site-header-global" class="site-header-global">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#site-profile-menu" aria-label="toggle menu" tabindex="0" aria-expanded="false">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<div id="site-logo" class="col-sm-5 row navbar-header">
					<div id="header-microsoft-logo">
						<a id="home-link" href="https://www.microsoft.com/" tabindex="1" aria-label="Microsoft logo">
							<img id="header-microsoft-logo-svg" src="https://blogs.msdn.microsoft.com/visio/wp-content/themes/microsoft/images/ms-logo-gray.svg" alt="Microsoft logo">
							<span id="brand">
								<span id="brand-separator">|</span>
								<span id="brand-name"></span>
							</span>
						</a>
					</div>
				</div>
				<div id="site-header-global-right" class="col-sm-7">
				</div>
			</div>

		</div>
		<div id="site-header-blog-wrapper" class="site-header-blog-wrapper ms-blog-header clear-both">
			<div id="site-header-blog" class="site-header-blog">
				<nav class="navbar navbar-inverse">
					<div id="blog-logo-area" class="navbar-header">
						<div id="blog-logo" data-toggle="collapse" data-target="#blog-menu" tabindex="0" aria-label="blog logo">
														<div id="blog-logo-text">
<h1 class="site-title ms-blog-title">
					<a href="https://blogs.msdn.microsoft.com/chhopkin" class="for-desktop">
						Chris Hopkins&#039; Blog &#8211; #makinitdostuff					</a>
					<a href="https://blogs.msdn.microsoft.com/chhopkin" class="for-mobile">
						Chris Hopkins&#039; Blog &#8211; #makinitdostuff					</a>
				</h1>
<!-- blog description -->
<p class="site-description ms-blog-description">The place where I post information about the products I manage; SharePoint, Yammer, Project and Visio and maybe from some that I don&#039;t!</p>
			</div>
									</div>
					</div>
									</nav>
			</div>
			
		</div>
		<div id="site-content" class="site-content row">

	<div id="primary" class="content-area col-sm-9">
	<main id="site-main" class="site-main" role="main">
		<div id="single-content" class="div-content">
<!-- Post start -->
<article id="post-823" class="post-823 post type-post status-publish format-standard hentry category-uncategorized">
	<header class="entry-header">
<h1 class="entry-title">Data refresh from PowerPivot</h1>
<div class="entry-meta">
<span class="byline"><span class="author vcard"><a class="url fn n profile-usercard-hover" data-profile-userid="8269f8fdfe8043a0993263bbfc5f124b" href="https://social.msdn.microsoft.com/profile/Christopher+R+Hopkins">Christopher R Hopkins</a></span>
</span><span class="posted-on posted-on-margin">
			<span class="screen-reader-text"></span>
<time class="entry-date published updated" datetime="2011-08-22T17:47:00+00:00">August 22, 2011</time>
			</span>
		</div>
		<hr>
	</header><!-- .entry-header -->
<div class="entry-content single">
		<p>In a series of articles I explored the different scenarios around SQL and data refresh.&nbsp; One of the scenarios that I have not covered is how to create a data refreshable diagram from Analysis Services.&nbsp; If you do not already know this, Visio and Visio Services cannot refresh directly from Analysis Services, however we could use PowerPivot as a middle man.&nbsp; Imagine a scenario&hellip;</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/8306.image_3E2976A1.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/8306.image_5F00_3E2976A1.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="1263.image_thumb_1616C782.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/1263.image_5F00_thumb_5F00_1616C782.png" width="512" height="117" /></a></p>
<p>where the Visio diagram is data connected to a pivot table in an Excel workbook and the data for that pivot table is refreshed on a schedule by PowerPivot&rsquo;s data refresh feature in SharePoint 2010.&nbsp; Visio Services supports refreshing data from Excel Services so as long as PowerPivot&rsquo;s data refresh schedule is configured our diagrams will stay up to date.</p>
<p><strong>Setting up PowerPivot</strong></p>
<p>First, you need to make sure to install the PowerPivot add-in for Excel 2010 ( which can be downloaded from <a href="http://www.powerpivot.com">www.powerpivot.com</a> ).&nbsp; This is a simple add-in installation.</p>
<p>Second, you will need access to a PowerPivot SharePoint site.</p>
<p>If you do not have PowerPivot installed for SharePoint 2010 you can review the installation detailed in this article, <a href="http://msdn.microsoft.com/en-us/library/ee210616.aspx">How to: Install PowerPivot for SharePoint on an Existing SharePoint Server</a>.&nbsp; Before you do this however I suggest you review this <a href="http://support.microsoft.com/kb/2261507">article</a> which explains a workaround for a common installation error which cost me a few hours I will not be getting back <img style="border-style: none;" class="wlEmoticon wlEmoticon-winkingsmile" alt="Winking smile" src="7142.wlEmoticon-winkingsmile_0361CDCB.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/7142.wlEmoticon_2D00_winkingsmile_5F00_0361CDCB.png" /></p>
<p><strong>Create your workbook and Pivot Table</strong></p>
<p>With PowerPivot installed to Excel and SharePoint 2010 you can now create a workbook in Excel that contains a pivot table and publish the workbook to a PowerPivot Gallery in a PowerPivot site on your farm.</p>
<p>For this example I created a simple pivot table from some data in the old Pubs database which you can still download from here, <a title="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=23654" href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=23654">http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=23654</a></p>
<p>There are three tables I am interested in for my pivot table: stores, sales, and titles.&nbsp; I want to show in my pivot table the count of books sold for each book type within each state that I have a store.</p>
<p>The PowerPivot add-in lets me easily build this Pivot Table by selecting&hellip;</p>
<p><strong>state</strong> from the Stores table &ndash; added as a Row label <br /><strong>type</strong> from the Titles table &ndash; added as a Column label <br /><strong>qty</strong> from the Sales table &ndash; added as a Value column</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/6560.image3_2E3A31DD.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/6560.image3_5F00_2E3A31DD.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="4186.image3_thumb_1BF16B1B.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/4186.image3_5F00_thumb_5F00_1BF16B1B.png" width="251" height="170" /></a></p>
<p>which results in the following pivot table</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/1460.image_22A4749E.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/1460.image_5F00_22A4749E.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="4087.image_thumb_2D61CBF3.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/4087.image_5F00_thumb_5F00_2D61CBF3.png" width="628" height="143" /></a></p>
<p><strong>Formatting the Pivot Table</strong></p>
<p>The next step is to make this pivot table available to Visio Services ( and everyone else ) by publishing it to the PowerPivot gallery but before I publish this I am going to make a few small changes.</p>
<p>I like to change the view so that the first column displays a more meaningful column name.&nbsp; This will be helpful when I link this data to my Visio diagram.&nbsp; To do this I simply choose <strong>Show in Outline Form</strong> from the <strong>Report Layout</strong> button on the <strong>PivotTable Tools &ndash; Design</strong> tab in the ribbon.</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/8713.image_6202282E.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/8713.image_5F00_6202282E.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="6253.image_thumb_6CBF7F83.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/6253.image_5F00_thumb_5F00_6CBF7F83.png" width="246" height="194" /></a></p>
<p>Now you can see that my first column shows the name <strong>state</strong> instead of the default &lsquo;Row Labels&rsquo;</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/8304.image_0144CF02.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/8304.image_5F00_0144CF02.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="3326.image_thumb_2C1D3314.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/3326.image_5F00_thumb_5F00_2C1D3314.png" width="780" height="151" /></a></p>
<p>One last change I like to make helps to minimizes schema changes to the pivot table during data refresh.&nbsp; I typically turn on the display options that force the pivot table to display rows and columns that do not have any data.</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/7120.image_47C1BF0A.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/7120.image_5F00_47C1BF0A.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="0361.image_thumb_078BA590.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/0361.image_5F00_thumb_5F00_078BA590.png" width="220" height="47" /></a></p>
<p>Why?&nbsp; If these rows or columns are not currently part of the pivot table then Visio Services will not expect them to be there in the future.&nbsp; If these rows or columns suddenly show up in our pivot table from a future data refresh then Visio Services will not know what to do with the new schema and will present the user with an error that the</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/4186.image_60515C5A.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/4186.image_5F00_60515C5A.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="2018.image_thumb_6B0EB3AF.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/2018.image_5F00_thumb_5F00_6B0EB3AF.png" width="389" height="159" /></a></p>
<p>Now I can publish this by saving or uploading the workbook to the PowerPivot gallery.</p>
<p><strong>Setting the Data Refresh schedule</strong></p>
<p>PowerPivot in SharePoint 2010 allows you to schedule data refresh so that the workbook that you publish is periodically updated with the latest data.&nbsp; This is critical for Visio Services because the data refresh for a Visio diagram will only pull data from the pivot table range in the Excel workbook and without this data refresh the Visio diagram would also reflect the data that was originally published to the PowerPivot gallery.</p>
<blockquote>
<p>If you would like an overview on how to configure data refresh for your workbooks then take a look at this article, <a title="http://powerpivotgeek.com/misc/my-other-blog-articles/powerpivot-data-refresh/" href="http://powerpivotgeek.com/misc/my-other-blog-articles/powerpivot-data-refresh/">http://powerpivotgeek.com/misc/my-other-blog-articles/powerpivot-data-refresh/</a></p>
</blockquote>
<blockquote>
<p>For more detailed information on PowerPivot data refresh, review this article <a title="http://msdn.microsoft.com/en-us/library/ee210690.aspx" href="http://msdn.microsoft.com/en-us/library/ee210690.aspx">http://msdn.microsoft.com/en-us/library/ee210690.aspx</a></p>
</blockquote>
<p>The one option I do want to point out is the <strong>Also refresh as soon as possible</strong> option</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/1351.image_38AAE030.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/1351.image_5F00_38AAE030.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="3010.image_thumb_7874C6B5.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/3010.image_5F00_thumb_5F00_7874C6B5.png" width="222" height="35" /></a></p>
<p>I like to check this option when testing or presenting demonstrations, but do be aware that this is not an immediate refresh because the refresh is actually managed by a timer job that will kick off as soon as it can after saving the changes to the data refresh schedule.</p>
<p><strong>Data Linking wizard</strong></p>
<p>Linking your diagram to the PowerPivot pivot table is as simple as choosing the Excel Workbook option in the data linking wizard, browsing to the workbook that you published to your PowerPivot gallery and then choosing the range in the workbook that contains the pivot table.</p>
<p>Selecting a range rather than linking to the entire sheet in the workbook is important in this case because the pivot table contains additional rows that can be mistaken by Visio as the header row.&nbsp; Selecting a range using the <strong>Select Custom range&hellip;</strong> button allows us to limit the range to include the proper header row.</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/4503.image_7F27D038.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/4503.image_5F00_7F27D038.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="0876.image_thumb_05DAD9BC.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/0876.image_5F00_thumb_5F00_05DAD9BC.png" width="470" height="138" /></a></p>
<p>Here I specifically leave out the first row of the pivot table</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/4812.image_29940156.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/4812.image_5F00_29940156.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="7120.image_thumb_77302DD6.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/7120.image_5F00_thumb_5F00_77302DD6.png" width="654" height="148" /></a></p>
<p>which imports to my Visio diagram with the proper header columns</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/5141.image_68F1B4E6.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/5141.image_5F00_68F1B4E6.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="2425.image_thumb_368DE167.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/2425.image_5F00_thumb_5F00_368DE167.png" width="638" height="98" /></a></p>
<p><strong>Linking shapes to data and Data Graphics</strong></p>
<p>Now it is up to you to create a diagram that visualizes this data using the Data Graphics capabilities of Visio 2010.</p>
<blockquote>
<p>If you are not familiar with data linking you can review this article <br /><a title="http://visio.microsoft.com/en-us/Get_Started/How_To/Pages/Linking-Data-to-Shapes.aspx" href="http://visio.microsoft.com/en-us/Get_Started/How_To/Pages/Linking-Data-to-Shapes.aspx">http://visio.microsoft.com/en-us/Get_Started/How_To/Pages/Linking-Data-to-Shapes.aspx</a></p>
<p>If you are not familiar with Data Graphics you can review this article <br /><a title="http://blogs.msdn.com/b/visio/archive/2009/10/13/data-graphics-in-visio-2010.aspx" href="http://blogs.msdn.com/b/visio/archive/2009/10/13/data-graphics-in-visio-2010.aspx">http://blogs.msdn.com/b/visio/archive/2009/10/13/data-graphics-in-visio-2010.aspx</a></p>
</blockquote>
<p>For my example I built a simple US Map ( shapes courtesy of <a href="http://www.visguy.com">www.visguy.com</a> ), attached a <a href="http://blogs.msdn.com/b/visio/archive/2010/01/12/custom-containers-lists-and-callouts-in-visio-2010.aspx">callout</a> to each of the state shapes and then linked each record from the data set to the appropriate <a href="http://blogs.msdn.com/b/visio/archive/2010/01/12/custom-containers-lists-and-callouts-in-visio-2010.aspx">callout</a> shape.&nbsp; I then created a <a href="http://blogs.msdn.com/b/visio/archive/2009/10/13/data-graphics-in-visio-2010.aspx">Data Graphic</a> using the Text Label and the Data bar items to produce the following visualization</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/5460.image_042A0DE8.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/5460.image_5F00_042A0DE8.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="0383.image_thumb_5C8391BD.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/0383.image_5F00_thumb_5F00_5C8391BD.png" width="316" height="252" /></a></p>
<p>The data that I linked to the diagram has data for each book type sold.&nbsp; In order to provide additional views, one for each type of book sold, I simply created a page for each book type, copied the diagram from the first page to all the other pages, then updated the Data Bar items on each page to reference the specific book type summary column from the data set.&nbsp; For example, here is what my Business page looks like</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/8371.image_2E2A0C10.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/8371.image_5F00_2E2A0C10.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="3326.image_thumb_66D4B61D.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/3326.image_5F00_thumb_5F00_66D4B61D.png" width="319" height="252" /></a></p>
<p><strong>Adding navigation</strong></p>
<p>So now I have a diagram with multiple pages, each showing a different view of the data from the pivot table.&nbsp; When I publish this to SharePoint I want the user to be able to easily navigate between these pages.&nbsp; To do this I simply add additional shapes to the diagram, label them with the page names and add hyperlinks to the corresponding pages.&nbsp; When the diagram is published to SharePoint the user will hopefully discover and click on these shapes to navigate between the different pages.</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/7120.image_4D6CB2E3.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/7120.image_5F00_4D6CB2E3.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="0876.image_thumb_53B38971.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/0876.image_5F00_thumb_5F00_53B38971.png" width="396" height="68" /></a></p>
<p><strong>Adding refresh information</strong></p>
<p>One last item I like to add to any data refreshed diagram is the date and time of which the data was last refreshed.&nbsp; This is important to consumers of your dashboard because this will tell them how old the data is.</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/4812.image_137D6FF7.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/4812.image_5F00_137D6FF7.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="2844.image_thumb_4C281A04.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/2844.image_5F00_thumb_5F00_4C281A04.png" width="374" height="187" /></a></p>
<p>Where do I get the date and time for the last successful data refresh operation?&nbsp; Remember that the data refresh schedule for PowerPivot will update the workbook and the workbook is simply an item in the PowerPivot gallery which happens to be a SharePoint document library.&nbsp; One of the columns for any item in a document library is the Modified column.&nbsp; So, simply run the data linking wizard again and add an additional data source, in this case the actual PowerPivot Gallery.</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/2437.image_6BD6F3CC.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/2437.image_5F00_6BD6F3CC.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="4578.image_thumb_7289FD4F.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/4578.image_5F00_thumb_5F00_7289FD4F.png" width="391" height="173" /></a></p>
<p>Now we have a second data set attached to our diagram which has the Modified date and time.</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/4162.image_6041368D.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/4162.image_5F00_6041368D.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="7536.image_thumb_5202BD9D.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/7536.image_5F00_thumb_5F00_5202BD9D.png" width="729" height="116" /></a></p>
<p>The Data Graphic is very simple.&nbsp; All I did was draw a rectangle on the page using the rectangle tool, link the row in the PowerPivot Gallery data set to the rectangle, and then configure a Data Graphic with a single Text label item referencing the Modified property from the shape.</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/09/02/metablogapi/8204.image_58B5C720.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/8204.image_5F00_58B5C720.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" border="0" alt="image" src="7536.image_thumb_5EFC9DAE.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-09-02-metablogapi/7536.image_5F00_thumb_5F00_5EFC9DAE.png" width="735" height="223" /></a></p>
<p><strong>Publishing</strong></p>
<p>Now we are finished and publishing to our SharePoint 2010 document library is the easy part.&nbsp; Just make sure you use the new Web Drawing file format so that Visio Services can render and refresh the diagram in the browser.</p>
<p><em>Attached to this article are the Excel workbook and the Visio diagram that I used for this demonstration.</em></p>
<p><a href="ProductMapPowerPivot.zip">ProductMapPowerPivot.zip</a></p>
	</div><!-- .entry-content -->
<hr>

</article><!-- #post-## -->
</div><!-- #single-content -->
</div><!-- #primary -->
<!-- Before Navigation --></main><!-- #site-main -->

<a class=""""screen-reader-shortcut"""" href=""""#primary"""" tabindex=""""1""""></a> 

<div id=""secondary"" class=""sidebar col-sm-3"">
	<div id=""sidebar-widget-area"" class=""sidebar-widget-area"" role=""complementary"">
		<div class=""widget sfmsb_widget"">

		</div>
		<aside id="tag_cloud-2" class="widget widget_tag_cloud">
</aside>
<aside id="msdn-archive-widget-2" class="widget msdn-archive-widget"><h2 class="widget-title">Archives</h2>	
	<li><a href='..\..\..\years\2014\index.htm'>All of 2014</a>&nbsp;(27)</li>
	<li><a href='..\..\..\years\2013\index.htm'>All of 2013</a>&nbsp;(19)</li>
	<li><a href='..\..\..\years\2012\index.htm'>All of 2012</a>&nbsp;(21)</li>
	<li><a href='..\..\..\years\2011\index.htm'>All of 2011</a>&nbsp;(26)</li>
	<li><a href='..\..\..\years\2010\index.htm'>All of 2010</a>&nbsp;(15)</li>
	<li><a href='..\..\..\years\2009\index.htm'>All of 2009</a>&nbsp;(22)</li>
	<li><a href='..\..\..\years\2008\index.htm'>All of 2008</a>&nbsp;(7)</li>
</aside>
</div><!-- #secondary -->
</div><!-- .site-content -->
</div>

<footer id="site-footer" class="site-footer row" role="contentinfo">
	<div id="site-info" class="site-info">
		<div id="footer-text" class="col-sm-4 col-sm-offset-6">
			<span>
				<a href="https://privacy.microsoft.com" data-mscc-ic="false">Privacy</a>
			</span>
			<span>
				<a href="https://msdn.microsoft.com/cc300389" data-mscc-ic="false">Terms of Use</a>
			</span>
			<span>
				<a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-mscc-ic="false">Trademarks</a>
			</span>
		</div>
		<div id="footer-far" class="col-sm-2">
			<div id="footer-microsoft-logo">
				<a href="https://www.microsoft.com" aria-label="Microsoft Logo">
					<svg id="footer-microsoft-logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 347 70.5" enable-background="new 0 0 347 70.5"><g fill="#fff"><path d="M39.5 44.6l-2.8 7.9h-.2c-.5-1.8-1.3-4.5-2.7-7.8l-15-37.7h-14.7v60h9.7v-37c0-2.3 0-5-.1-8.2-.1-1.6-.2-2.9-.3-3.8h.2c.5 2.3 1 4 1.4 5.1l18 43.8h6.8l17.9-44.2c.4-1 .8-3 1.2-4.7h.2c-.2 4.4-.4 8.4-.5 10.8v38.1h10.4v-60h-14.1l-15.4 37.7zM78.8 23.9h10.1v43h-10.1zM83.9 5.7c-1.7 0-3.1.6-4.3 1.7-1.2 1.1-1.8 2.5-1.8 4.2 0 1.6.6 3 1.8 4.1 1.2 1.1 2.6 1.6 4.3 1.6 1.7 0 3.2-.6 4.3-1.6 1.2-1.1 1.8-2.5 1.8-4.1 0-1.6-.6-3-1.8-4.2-1-1.2-2.5-1.7-4.3-1.7M124.7 23.5c-1.9-.4-3.8-.6-5.7-.6-4.6 0-8.8 1-12.3 3s-6.3 4.8-8.1 8.3c-1.9 3.6-2.8 7.7-2.8 12.4 0 4.1.9 7.8 2.7 11.1 1.8 3.3 4.3 5.9 7.6 7.7 3.2 1.8 6.9 2.7 11.1 2.7 4.8 0 8.9-1 12.2-2.9l.1-.1v-9.3l-.4.3c-1.5 1.1-3.2 2-4.9 2.6-1.8.6-3.4.9-4.8.9-4 0-7.2-1.2-9.5-3.7s-3.5-5.9-3.5-10.2c0-4.4 1.2-7.9 3.6-10.5 2.4-2.6 5.6-3.9 9.5-3.9 3.3 0 6.6 1.1 9.6 3.3l.4.3v-9.8l-.1-.1c-1.2-.6-2.8-1.1-4.7-1.5M158 23.2c-2.5 0-4.8.8-6.8 2.4-1.7 1.4-2.9 3.4-3.9 5.8h-.1v-7.4h-10.1v43h10.1v-22c0-3.7.8-6.8 2.5-9.1s3.9-3.5 6.5-3.5c.9 0 1.9.2 3 .4 1.1.3 1.9.6 2.4 1l.4.3v-10.2l-.2-.1c-.8-.4-2.1-.6-3.8-.6M185.5 22.9c-7.1 0-12.7 2.1-16.7 6.2s-6 9.8-6 16.9c0 6.7 2 12.1 5.9 16.1 3.9 3.9 9.2 5.9 15.8 5.9 6.9 0 12.4-2.1 16.4-6.3 4-4.2 6-9.8 6-16.7 0-6.8-1.9-12.3-5.7-16.2-3.7-3.9-9-5.9-15.7-5.9m8 33.1c-1.9 2.4-4.8 3.6-8.5 3.6s-6.6-1.2-8.7-3.7c-2.1-2.4-3.1-5.9-3.1-10.3 0-4.6 1.1-8.1 3.1-10.6 2.1-2.5 5-3.7 8.6-3.7 3.6 0 6.4 1.2 8.4 3.6 2 2.4 3.1 5.9 3.1 10.5s-1 8.2-2.9 10.6M229.3 41.7c-3.2-1.3-5.2-2.3-6.1-3.2-.8-.8-1.2-1.9-1.2-3.3 0-1.2.5-2.3 1.6-3.1 1.1-.8 2.5-1.2 4.4-1.2 1.7 0 3.5.3 5.2.8 1.7.5 3.3 1.2 4.5 2.1l.4.3v-9.4l-.2-.1c-1.2-.5-2.7-.9-4.6-1.3-1.9-.3-3.6-.5-5-.5-4.8 0-8.8 1.2-11.9 3.7-3.1 2.4-4.6 5.7-4.6 9.5 0 2 .3 3.8 1 5.3s1.7 2.9 3.1 4c1.4 1.1 3.4 2.3 6.2 3.5 2.3 1 4.1 1.8 5.2 2.4 1.1.6 1.8 1.3 2.3 1.9.4.6.6 1.4.6 2.4 0 2.9-2.2 4.3-6.6 4.3-1.7 0-3.5-.3-5.6-1-2.1-.7-4-1.7-5.7-2.9l-.4-.3v9.9l.2.1c1.5.7 3.3 1.2 5.4 1.7 2.2.4 4.1.7 5.8.7 5.2 0 9.5-1.2 12.5-3.7 3.1-2.5 4.7-5.7 4.7-9.8 0-2.9-.8-5.4-2.5-7.4-1.8-2-4.7-3.8-8.7-5.4M267.6 22.9c-7.1 0-12.7 2.1-16.7 6.2s-6 9.8-6 16.9c0 6.7 2 12.1 5.9 16.1 3.9 3.9 9.2 5.9 15.8 5.9 6.9 0 12.4-2.1 16.4-6.3 4-4.2 6-9.8 6-16.7 0-6.8-1.9-12.3-5.7-16.2-3.8-3.9-9.1-5.9-15.7-5.9m8 33.1c-1.9 2.4-4.8 3.6-8.5 3.6s-6.6-1.2-8.7-3.7c-2.1-2.4-3.1-5.9-3.1-10.3 0-4.6 1.1-8.1 3.1-10.6 2.1-2.5 5-3.7 8.6-3.7 3.5 0 6.4 1.2 8.4 3.6 2 2.4 3.1 5.9 3.1 10.5s-1 8.2-2.9 10.6"/><path d="M342.9 32.2v-8.2h-10.2v-12.9l-.3.1-9.6 2.9-.2.1v9.7h-15.2v-5.4c0-2.5.6-4.4 1.7-5.7 1.1-1.3 2.7-1.9 4.7-1.9 1.4 0 2.9.3 4.5 1l.4.2v-8.7l-.2-.1c-1.4-.5-3.3-.8-5.7-.8-3 0-5.7.7-8.1 1.9-2.4 1.3-4.2 3.1-5.5 5.5-1.3 2.3-2 5-2 8v6h-7.2v8.2h7.1v34.8h10.2v-34.7h15.2v22.1c0 9.1 4.3 13.7 12.8 13.7 1.4 0 2.9-.2 4.3-.5 1.5-.3 2.6-.7 3.2-1l.1-.1v-8.3l-.4.3c-.6.4-1.2.7-2.1.9-.8.2-1.5.3-2 .3-2 0-3.4-.5-4.4-1.6-.9-1.1-1.4-2.9-1.4-5.5v-20.3h10.3z"/></g></svg>
				</a>
			</div>
			<div id="copyright">
				© 2011 - 2018 Microsoft
			</div>
		</div>
	</div><!-- .site-info -->
</footer><!-- .site-footer -->

</div><!-- .site -->

</body>
</html>