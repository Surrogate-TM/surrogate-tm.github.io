<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<title>Функция RUNMACRO. Справка Visio 2010</title>
<link rel="stylesheet" href="../../styles/main.css" type="text/css">

</head>

<body lang=RU link="#0560A6" vlink=purple>

<div class=WordSection1>

<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
 style='width:100.0%;border:none;border-bottom:solid #C8CDDE 1.0pt'>
 <tr>
  <td valign=top style='border:none;border-bottom:solid #D4DFFF 1.0pt;
  padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:3.0pt'><b><span style='font-size:9.5pt;
  line-height:115%;font-family:"Segoe UI","sans-serif";color:#003399'>Функция
  RUNMACRO</span></span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;line-height:9.75pt;background:white'><span style='font-size:
8.5pt;font-family:"Tahoma","sans-serif"'>Вызывает макрос в проекте Microsoft
Visual Basic для приложений (VBA). </span></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;background:white'><b><span style='font-size:10.0pt;font-family:
"Tahoma","sans-serif";color:#003399'>Синтаксис</span></b></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;line-height:9.75pt;background:white'><b><span style='font-size:
8.5pt;font-family:"Tahoma","sans-serif"'>RUNMACRO (<i>macroname </i>[, <i>projname_opt</i>])</span></b></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;background:white'><b><span style='font-size:10.0pt;font-family:
"Tahoma","sans-serif";color:#003399'>Parameters</span></b></p>

<table class=MsoNormalTable border=0 cellpadding=0 width="100%"
 style='width:100.0%'>
 <tr>
  <td style='border:none;border-bottom:solid #C8CDDE 1.0pt;background:#EFEFF7;
  padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin-top:3.75pt;margin-right:0cm;margin-bottom:
  3.75pt;margin-left:0cm'><b><span style='font-size:8.0pt;line-height:115%;
  font-family:"Segoe UI","sans-serif";color:#000066'>Имя</span></b></p>
  </td>
  <td style='border:none;border-bottom:solid #C8CDDE 1.0pt;background:#EFEFF7;
  padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin-top:3.75pt;margin-right:0cm;margin-bottom:
  3.75pt;margin-left:0cm'><b><span style='font-size:8.0pt;line-height:115%;
  font-family:"Segoe UI","sans-serif";color:#000066'>Требуется/Необязательно</span></b></p>
  </td>
  <td width="10%" style='width:10.0%;border:none;border-bottom:solid #C8CDDE 1.0pt;
  background:#EFEFF7;padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin-top:3.75pt;margin-right:0cm;margin-bottom:
  3.75pt;margin-left:0cm'><b><span style='font-size:8.0pt;line-height:115%;
  font-family:"Segoe UI","sans-serif";color:#000066'>Тип данных</span></b></p>
  </td>
  <td style='border:none;border-bottom:solid #C8CDDE 1.0pt;background:#EFEFF7;
  padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin-top:3.75pt;margin-right:0cm;margin-bottom:
  3.75pt;margin-left:0cm'><b><span style='font-size:8.0pt;line-height:115%;
  font-family:"Segoe UI","sans-serif";color:#000066'>Описание</span></b></p>
  </td>
 </tr>
 <tr>
  <td style='border-top:none;border-left:solid #D5D5D3 1.0pt;border-bottom:
  solid #D5D5D3 1.0pt;border-right:none;background:#F7F7FF;padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin:.75pt'><i><span style='font-size:8.0pt;
  line-height:115%;font-family:"Segoe UI","sans-serif"'>macroname</span></i></p>
  </td>
  <td style='border-top:none;border-left:solid #D5D5D3 1.0pt;border-bottom:
  solid #D5D5D3 1.0pt;border-right:none;background:#F7F7FF;padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin:.75pt'><span style='font-size:8.0pt;
  line-height:115%;font-family:"Segoe UI","sans-serif"'>Требуется</span></p>
  </td>
  <td style='border-top:none;border-left:solid #D5D5D3 1.0pt;border-bottom:
  solid #D5D5D3 1.0pt;border-right:none;background:#F7F7FF;padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin:.75pt'><b><span style='font-size:8.0pt;
  line-height:115%;font-family:"Segoe UI","sans-serif"'>Строка</span></b></p>
  </td>
  <td style='border-top:none;border-left:solid #D5D5D3 1.0pt;border-bottom:
  solid #D5D5D3 1.0pt;border-right:none;background:#F7F7FF;padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin:.75pt'><span style='font-size:8.0pt;
  line-height:115%;font-family:"Segoe UI","sans-serif"'>Имя макроса, который
  необходимо вызвать.</span></p>
  </td>
 </tr>
 <tr>
  <td style='border-top:none;border-left:solid #D5D5D3 1.0pt;border-bottom:
  solid #D5D5D3 1.0pt;border-right:none;background:#F7F7FF;padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin:.75pt'><i><span style='font-size:8.0pt;
  line-height:115%;font-family:"Segoe UI","sans-serif"'>projname_opt</span></i></p>
  </td>
  <td style='border-top:none;border-left:solid #D5D5D3 1.0pt;border-bottom:
  solid #D5D5D3 1.0pt;border-right:none;background:#F7F7FF;padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin:.75pt'><span style='font-size:8.0pt;
  line-height:115%;font-family:"Segoe UI","sans-serif"'>Необязательно</span></p>
  </td>
  <td style='border-top:none;border-left:solid #D5D5D3 1.0pt;border-bottom:
  solid #D5D5D3 1.0pt;border-right:none;background:#F7F7FF;padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin:.75pt'><b><span style='font-size:8.0pt;
  line-height:115%;font-family:"Segoe UI","sans-serif"'>Строка</span></b></p>
  </td>
  <td style='border-top:none;border-left:solid #D5D5D3 1.0pt;border-bottom:
  solid #D5D5D3 1.0pt;border-right:none;background:#F7F7FF;padding:.75pt 3.75pt .75pt 3.75pt'>
  <p class=MsoNormal style='margin:.75pt'><span style='font-size:8.0pt;
  line-height:115%;font-family:"Segoe UI","sans-serif"'>Проект, содержащий
  макрос.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;background:white'><b><span style='font-size:10.0pt;font-family:
"Tahoma","sans-serif";color:#003399'>Заметки</span></b></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;line-height:9.75pt;background:white'><span style='font-size:
8.5pt;font-family:"Tahoma","sans-serif"'>Если проект указан, Microsoft Visio
ищет среди всех открытых документов тот, который содержит проект <i>projname_opt</i>,
и вызывает в нем макрос <i>macroname</i>. Если аргумент <i>projname_opt</i>
опущен или содержит пустую строку (&quot;&quot;), предполагается, что макрос <i>macroname</i>
находится в VBA-проекте документа, содержащего вычисляемую формулу RUNMACRO.</span></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;line-height:9.75pt;background:white'><span style='font-size:
8.5pt;font-family:"Tahoma","sans-serif"'>Функция RUNMACRO отличается от функции
CALLTHIS тем, что не передает ссылку на фигуру, содержащую вычисляемую формулу,
в макрос <i>macroname</i>. Как и CALLTHIS, функция RUNMACRO не требует ссылки
на проект <i>projname_opt</i>.</span></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;line-height:9.75pt;background:white'><span style='font-size:
8.5pt;font-family:"Tahoma","sans-serif"'>Код VBA, который вызывается при
вычислении экземпляром Visio функции RUNMACRO в формуле, не должен закрывать
документ, содержащий ячейку, в которой используется функция, поскольку в этом случае
возникнет ошибка и работа Visio будет завершена.</span></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;line-height:9.75pt;background:white'><span style='font-size:
8.5pt;font-family:"Tahoma","sans-serif"'>Если требуется закрыть документ,
содержащий ячейку с функцией RUNMACRO, воспользуйтесь одним из следующих
способов:</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
9.75pt;background:white'><span style='font-size:10.0pt;font-family:Symbol'><img
width=6 height=9 src="../../images/arrowdown.gif" alt="*"><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Tahoma","sans-serif"'>закройте
документ с помощью кода, не являющегося кодом VBA; </span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
9.75pt;background:white'><span style='font-size:10.0pt;font-family:Symbol'><img
width=6 height=9 src="../../images/arrowdown.gif" alt="*"><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Tahoma","sans-serif"'>закройте
документ из проекта, отличного от того, который закрывается; </span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;line-height:
9.75pt;background:white'><span style='font-size:10.0pt;font-family:Symbol'><img
width=6 height=9 src="../../images/arrowdown.gif" alt="*"><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:8.5pt;font-family:"Tahoma","sans-serif"'>закройте
не документ, а его окна с помощью адресованных им сообщений. </span></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;line-height:9.75pt;background:white'><span style='font-size:
8.5pt;font-family:"Tahoma","sans-serif"'>Дополнительные сведения о выполнении
кода в Visio см. в разделе <a
href="">Параметры
безопасности и выполнение кода в Visio</a> настоящего руководства по таблице
свойств фигуры.</span></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;background:white'><b><span style='font-size:10.0pt;font-family:
"Tahoma","sans-serif";color:#003399'>Пример</span></b></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;line-height:9.75pt;background:white'><span style='font-size:
8.5pt;font-family:"Tahoma","sans-serif"'>В следующем примере вызывается макрос
с именем &quot;МойТест&quot; в модуле класса ThisDocument проекта VBA с
формулой RUNMACRO: </span></p>

<p class=MsoNormal style='margin-top:7.2pt;margin-right:0cm;margin-bottom:7.2pt;
margin-left:0cm;line-height:9.75pt;background:white'><span style='font-size:
8.5pt;font-family:"Tahoma","sans-serif"'>RUNMACRO
(&quot;ThisDocument.МойТест&quot;)</span></p>

</div>

</body>

</html>
