<!DOCTYPE html>
<html lang="en-US">
<head>
              <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.5/css/bootstrap.min.css">
<title>Adding Your Own Shapes to Visio &#8211; Archive of Visio Insights blog (2006-2018)</title>
<link rel='dns-prefetch' href='//ajax.aspnetcdn.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='stylesheet' id='wds-ratings-css'  href='https://blogs.msdn.microsoft.com/wp-content/plugins/wds-ratings/wds-ratings.css?ver=20161014' type='text/css' media='all' />
<link rel='stylesheet' id='microsoft-parent-style-css'  href='https://blogs.msdn.microsoft.com/wp-content/themes/microsoft/style.css?ver=02092017' type='text/css' media='all' />
<link rel='stylesheet' id='microsoft-child-style-css'  href='https://blogs.msdn.microsoft.com/wp-content/themes/microsoft-msdn/style.css?ver=04152016' type='text/css' media='all' />
	<div id='msccBanner' dir='ltr' data-site-name='uhf-TechNetBlogs' data-mscc-version='0.4.0' data-nver='aspnet-2.0.7' data-sver='0.1.2' class='cc-banner' role='alert'>
<link rel=""shortcut icon"" href=""https://i1.social.s-msft.com/Forums/GlobalResources/images/Technet/favicon.ico"">

<link rel='canonical' href='https://blogs.msdn.microsoft.com/visio/2006/08/08/adding-your-own-shapes-to-visio/' />
<!-- og:title -->
<meta property="og:title" content="Adding Your Own Shapes to Visio" />
<!-- og:description -->
<meta property="og:description" content="Visio users and developers often wonder how to distribute their newly created Visio shapes to their colleagues, friends and family (all depends on your friends and family I guess J). Visio offers two mechanisms to publish content, each suited to different situations.&nbsp; This blog entry covers both.&nbsp; But first, an introduction for those new to..." />
</head>
<body class="post-template-default single single-post postid-1623 single-format-standard">
<div id="page" class="site container-fluid">
	<header id="site-header" class="site-header row" role="banner">
		<div id="site-header-global-wrapper" class="site-header-global-wrapper">
			<div id="site-header-global" class="site-header-global">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#site-profile-menu" aria-label="toggle menu" tabindex="0" aria-expanded="false">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<div id="site-logo" class="col-sm-5 row navbar-header">
					<div id="header-microsoft-logo">
						<a id="home-link" href="https://www.microsoft.com/" tabindex="1" aria-label="Microsoft logo">
							<img id="header-microsoft-logo-svg" src="https://blogs.msdn.microsoft.com/visio/wp-content/themes/microsoft/images/ms-logo-gray.svg" alt="Microsoft logo">
							<span id="brand">
								<span id="brand-separator">|</span>
								<span id="brand-name"></span>
							</span>
						</a>
					</div>
				</div>
				<div id="site-header-global-right" class="col-sm-7">
				</div>
			</div>

		</div>
		<div id="site-header-blog-wrapper" class="site-header-blog-wrapper ms-blog-header clear-both">
			<div id="site-header-blog" class="site-header-blog">
				<nav class="navbar navbar-inverse">
					<div id="blog-logo-area" class="navbar-header">
						<div id="blog-logo" data-toggle="collapse" data-target="#blog-menu" tabindex="0" aria-label="blog logo">
														<div id="blog-logo-text">
<h1 class="site-title ms-blog-title">
					
						Archive of Visio Insights blog (2006-2018)
					
				</h1>
<!-- blog description -->
<p class="site-description ms-blog-description">The official blog of the Microsoft Visio product team</p>
			</div>
									</div>
					</div>
									</nav>
			</div>
			
		</div>
		<div id="site-content" class="site-content row">

	<div id="primary" class="content-area col-sm-9">
	<main id="site-main" class="site-main" role="main">
		<div id="single-content" class="div-content">
<!-- Post start -->
<article id="post-1623" class="post-1623 post type-post status-publish format-standard hentry category-uncategorized tag-all-posts tag-programming tag-shape-design">
	<header class="entry-header">
<h1 class="entry-title">Adding Your Own Shapes to Visio</h1>
<div class="entry-meta">
<span class="byline"><span class="author vcard"><a class="url fn n profile-usercard-hover" data-profile-userid="eb78383b108c4193a0a593011dd29f8e" href="https://social.msdn.microsoft.com/profile/Visio+Team">Visio Team</a></span>
</span><span class="posted-on posted-on-margin">
			<span class="screen-reader-text"></span>
<time class="entry-date published updated" datetime="2006-08-08T00:00:00+00:00">August 8, 2006</time>
			</span>
		</div>
		<hr>
	</header><!-- .entry-header -->
<div class="entry-content single">
		<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">Visio users and developers often wonder how to distribute their newly created Visio shapes to their colleagues, friends and family (all depends on your friends and family I guess <span style="FONT-FAMILY: Wingdings; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-char-type: symbol; mso-symbol-font-family: Wingdings"><span style="mso-char-type: symbol; mso-symbol-font-family: Wingdings">J</span></span>). Visio offers two mechanisms to publish content, each suited to different situations.<span style="mso-spacerun: yes">&nbsp; </span>This blog entry covers both.<span style="mso-spacerun: yes">&nbsp; </span>But first, an introduction for those new to content creation.<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" />
</p>
<h2 style="MARGIN: 10pt 0in 0pt"><font size="4">What&rsquo;s content?
</p>
<p></font></h2>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">In the Visio world, content refers to shapes, stencils and templates; if you&rsquo;re familiar with these concepts, please skip to the next section, if not please read on.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpFirst"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><strong>Master shapes</strong> are the basic unit of content; they are Visio entities that you can assemble on a drawing page that graphically represent a real-world object or concept. Visio provides a rich set of pre-made master shapes and also enables the creation of custom shapes. To get started authoring shapes, read through <a href="../../../2006/06/16/how-it-all-began.htm" mce_href="http://blogs.msdn.com/visio/archive/2006/06/16/624406.aspx">this</a> Archive of Visio Insights blog (2006-2018) blog posting as well as <a href="http://office.microsoft.com/en-us/assistance/CH010192111033.aspx" mce_href="http://office.microsoft.com/en-us/assistance/CH010192111033.aspx">this</a> set of documents from Microsoft Office Online.
</p>
<p style="MARGIN: 0in 0in 0pt 0.5in" class="MsoListParagraphCxSpMiddle">
<p><font face="Calibri">&nbsp;</font></p>
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpMiddle"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><strong>Stencils</strong> are collections of related master shapes that are presented together in the UI. Again Visio provides a large set of pre-made stencils and lets you create your own stencils containing custom made and/or pre-built Visio shapes by following the steps outlined <a href="http://office.microsoft.com/en-us/assistance/HP010376841033.aspx" mce_href="http://office.microsoft.com/en-us/assistance/HP010376841033.aspx">here</a>. Stencils files have a &ldquo;.VSS&rdquo; or &ldquo;.VSX&rdquo; extension.
</p>
<p style="MARGIN: 0in 0in 0pt 0.5in" class="MsoListParagraphCxSpMiddle">
<p>&nbsp;</p>
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpMiddle"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span><strong>Templates</strong> are Visio files that set up the Visio workspace for a particular drawing type by opening appropriate stencils, opening anchored windows and setting page properties such as scale and grid. For example the Space Plan template that ships with Visio opens four stencils, changes paper size and scaling. Instructions on how to create templates may be found <a href="http://office.microsoft.com/en-us/assistance/HA011822611033.aspx" mce_href="http://office.microsoft.com/en-us/assistance/HA011822611033.aspx">here</a>. Template files have a &ldquo;.VST&rdquo; or &ldquo;.VTX&rdquo; extension.
</p>
<p style="MARGIN: 0in 0in 10pt; mso-add-space: auto" class="MsoListParagraphCxSpLast">
<p>&nbsp;</p>
</p>
<h2 style="MARGIN: 10pt 0in 0pt"><font size="4">Publishing Content
</p>
<p></font></h2>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">Publishing a piece of content to Visio adds entry points to the user interface side-by-side with content created by Microsoft. For a stencil this translates into a menu entry added to the File &gt; Shapes fly-out menu while for a template this means an entry in Visio&rsquo;s startup screen (as seen below) and in the File &gt; New fly-out menu. In this blog entry we will focus on publishing templates to Visio; publishing stencils is quite similar.</p>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal"><font size="1">&nbsp;</font></p>
<p><img style="WIDTH: 540px; HEIGHT: 415px" src="publish4-080806.png" width="508" height="531" mce_src="publish4-080806.png">
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal" mce_keep="true">&nbsp;</p>
<h2 style="MARGIN: 10pt 0in 0pt"><font size="3">Method #1: Sharing Templates using Path Discovery
</p>
<p></font></h2>
<p style="MARGIN: 0in 0in 0pt; mso-add-space: auto" class="MsoListParagraphCxSpFirst">The simplest way to publish a template to Visio is to use the Path Discovery method described below:
</p>
<p style="MARGIN: 0in 0in 0pt; mso-add-space: auto" class="MsoListParagraphCxSpMiddle">
<p>&nbsp;</p>
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l0 level1 lfo2" class="MsoListParagraphCxSpMiddle"><span style="mso-bidi-font-family: Calibri"><span style="mso-list: Ignore">1.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Copy your template and supporting stencils to a known location on a drive.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l0 level1 lfo2" class="MsoListParagraphCxSpMiddle"><span style="mso-bidi-font-family: Calibri"><span style="mso-list: Ignore">2.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Add the location defined in step 1 to Visio&rsquo;s &ldquo;Template Paths&rdquo;; this tells Visio where to find extra content to populate its startup screen. This can be done manually by following the steps <a href="http://office.microsoft.com/en-us/assistance/HP011377681033.aspx" mce_href="http://office.microsoft.com/en-us/assistance/HP011377681033.aspx">here</a> or may be automated using code that sets the <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vissdk11/html/viproTemplatePaths_HV81900971.asp" mce_href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vissdk11/html/viproTemplatePaths_HV81900971.asp"><span style="mso-bidi-font-weight: bold">TemplatePaths</span></a> property on the Visio Application object.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 10pt 0.5in; mso-list: l0 level1 lfo2" class="MsoListParagraphCxSpLast"><span style="mso-bidi-font-family: Calibri"><span style="mso-list: Ignore">3.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Restart Visio &ndash; your template should appear in the (Other) category.
</p>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">The advantages of this approach are:
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l2 level1 lfo5" class="MsoListParagraphCxSpFirst"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>It is simple.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 10pt 0.5in; mso-list: l2 level1 lfo5" class="MsoListParagraphCxSpLast"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>It is supported across most versions of Visio.
</p>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">It however has a few drawbacks:
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpFirst"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Your users may be subjected to potentially long and error prone manual work.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpMiddle"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Your templates will always end up in the (Other) content category in the startup screen.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpMiddle"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>You don&rsquo;t have any way of repairing content on a user&rsquo;s machine if it gets damaged.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpMiddle"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>You cannot control which language of Visio will load your stencils and templates.<span style="mso-spacerun: yes">&nbsp; </span>
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpMiddle"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>This approach does not scale well. The Path Discovery publishing method does just that: every time you boot Visio it searches a user&rsquo;s hard drive for content files &ndash; an expensive operation.
</p>
<p style="MARGIN: 0in 0in 0pt; mso-add-space: auto" class="MsoListParagraphCxSpMiddle">
<p>&nbsp;</p>
</p>
<p style="MARGIN: 0in 0in 10pt; mso-add-space: auto" class="MsoListParagraphCxSpLast">Sharing templates through Path Discovery is good for small scale content deployments as well as deployments to older versions of Visio.</p>
<h2 style="MARGIN: 10pt 0in 0pt"><font size="3">Method #2: Sharing using the PublishComponent System
</p>
<p></font></h2>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">The PublishComponent system introduced in Visio 2003 lets developers use <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/windows_installer_start_page.asp" mce_href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/windows_installer_start_page.asp">Windows Installer</a> technology for template distribution to register their content with Visio in a richer and more robust way. The main advantages of this method are quite interesting:
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpFirst"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>The Windows Installer setup wizard is familiar to users and easy to use.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpMiddle"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>You may choose where your content appears in the File &gt; Shapes or startup screen hierarchies.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpMiddle"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>You benefit from Windows Installer repair, install-on-demand and add/remove features.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpMiddle"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>You may choose what language versions of Visio to publish your content to.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpMiddle"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>The approach scales well: Visio only rebuilds its content cache, a moderately expensive operation, when new content is published.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 10pt 0.5in; mso-list: l5 level1 lfo1" class="MsoListParagraphCxSpLast"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>The approach is tried and tested since the product publishes its own content this way since the 2003 release. <span style="mso-spacerun: yes">&nbsp;</span>
</p>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">That said, using the Publish Component system is:
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 0pt 0.5in; mso-list: l1 level1 lfo6" class="MsoListParagraphCxSpFirst"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>A little more complicated than the Path Discovery method.
</p>
<p style="TEXT-INDENT: -0.25in; MARGIN: 0in 0in 10pt 0.5in; mso-list: l1 level1 lfo6" class="MsoListParagraphCxSpLast"><span style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><span style="mso-list: Ignore">&middot;<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Will only work for Visio 2003 and or later.
</p>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">To use this method you&rsquo;ll need Visual Studio .NET or later, the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=557120BD-B0BB-46E7-936A-B8539898D44D&amp;displaylang=en" mce_href="http://www.microsoft.com/downloads/details.aspx?FamilyID=557120BD-B0BB-46E7-936A-B8539898D44D&amp;displaylang=en">Visio 2003 SDK</a> (or the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=373D34B8-5EF7-4E6E-A582-C8D6B5EE4E33&amp;displaylang=en" mce_href="http://www.microsoft.com/downloads/details.aspx?FamilyId=373D34B8-5EF7-4E6E-A582-C8D6B5EE4E33&amp;displaylang=en">Visio 2007 Beta SDK</a>) and the following steps:
</p>
<ol style="MARGIN-TOP: 0in" type="1">
<li style="MARGIN: 0in 0in 10pt; mso-list: l4 level1 lfo3; tab-stops: list .5in" class="MsoNormal">Create a setup project in Visual Studio.
</p>
</li>
<li style="MARGIN: 0in 0in 10pt; mso-list: l4 level1 lfo3; tab-stops: list .5in" class="MsoNormal">Select the "Application folder" and change its default location property to your target install location. Add your template and their supporting stencils to this location by dragging files into the folders. Your project should look something like the figure below at this point.</li>
</ol>
<p><img style="WIDTH: 564px; HEIGHT: 563px" src="publish2-080806.png" width="564" height="645" mce_src="publish2-080806.png">
<p style="MARGIN: 0in 0in 10pt; mso-list: l4 level1 lfo3; tab-stops: list .5in" class="MsoNormal" mce_keep="true">&nbsp;</p>
<ol style="MARGIN-TOP: 0in" type="1" start="3">
<li style="MARGIN: 0in 0in 10pt; mso-list: l4 level1 lfo3; tab-stops: list .5in" class="MsoNormal">Build the project. This will produce an MSI file - a multi-table installation database that is used by windows to coordinate setup.
</p>
</li>
</ol>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">If you installed the package as it is; Visio would not discover the files the MSI installed. To notify Visio on the whereabouts of these files, the next thing to do is populate the PublishComponent table of the MSI produced above with registration data. Once installed, this extra information will force Visio to rebuild its content cache and incorporate and display the new templates and stencils.
</p>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">The extra information you need to add may be found <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;832029" mce_href="http://support.microsoft.com/default.aspx?scid=kb;en-us;832029">here</a>. Be warned however, it is not for the faint of heart to enter this data manually. For those of us who would rather not spend their Saturday night writing MSI tables entries you can follow the steps below using the PublishComponent tool shipped in SDK to populate the appropriate MSI table easily:
</p>
<ol style="MARGIN-TOP: 0in" type="1">
<li style="MARGIN: 0in 0in 10pt; mso-list: l3 level1 lfo4; tab-stops: list .5in" class="MsoNormal">Install the Visio SDK &amp; start the publish component tool (this tool may be found in the Start menu entry for the Visio SDK).
</p>
</li>
<li style="MARGIN: 0in 0in 10pt; mso-list: l3 level1 lfo4; tab-stops: list .5in" class="MsoNormal">On the File menu, select New. It will prompt you for an MSI; navigate to the one that you've just built.
</p>
</li>
<li style="MARGIN: 0in 0in 10pt; mso-list: l3 level1 lfo4; tab-stops: list .5in" class="MsoNormal">This will present the Visio Files that are in MSI. You must now, for each entry:
</p>
<ol style="MARGIN-TOP: 0in" type="a">
<li style="MARGIN: 0in 0in 10pt; mso-list: l3 level2 lfo4; tab-stops: list 1.0in" class="MsoNormal">Set the <a href="http://www.microsoft.com/globaldev/reference/lcid-all.mspx" mce_href="http://www.microsoft.com/globaldev/reference/lcid-all.mspx">LCID</a> of the language for which you want the templates to be accessible in. Do the same for the supporting stencils.
</p>
</li>
<li style="MARGIN: 0in 0in 10pt; mso-list: l3 level2 lfo4; tab-stops: list 1.0in" class="MsoNormal">Set the position in the Visio startup screen hierarchy you want the template to live in. This is defined by separating different levels of the hierarchy by &ldquo;&rdquo; symbols for example: &ldquo;MyTemplateCategoryMyTemplateSubCategoryMyTemplateName&rdquo;. Do the same with the supporting stencils, setting their location in the File &gt; Shapes fly-out.
</p>
</li>
</ol>
</li>
</ol>
<p style="MARGIN: 0in 0in 10pt 35.45pt" class="MsoNormal">To make the changes described above double click on each entry to bring up the &ldquo;Template Information&rdquo; dialog seen below, or its counterpart the &ldquo;Stencil Information&rdquo; dialog.
</p>
<p><img style="WIDTH: 577px; HEIGHT: 509px" src="publish3-080806.png" width="577" height="612" mce_src="publish3-080806.png">&nbsp;<font size="1"></font></p>
<ol style="MARGIN-TOP: 0in" type="1" start="4">
<li style="MARGIN: 0in 0in 10pt; mso-list: l3 level1 lfo4; tab-stops: list .5in" class="MsoNormal">Press the "!" button in the tools toolbar; this will make modifications to the MSI's Publish Component table.
</p>
</li>
<li style="MARGIN: 0in 0in 10pt; mso-list: l3 level1 lfo4; tab-stops: list .5in" class="MsoNormal">Voil<span style="mso-ansi-language: FR-CA" lang="FR-CA">&agrave;</span>&hellip; you&rsquo;re done.
</p>
</li>
</ol>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">The MSI can now be distributed; Windows Installer and Visio will do the rest. Although we haven&rsquo;t discussed it here, the same techniques can be used to publish add-ins and help files. For the curious, use <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43-E24F-4EA3-A93E-40C0EC4F68E5&amp;displaylang=en" mce_href="http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43-E24F-4EA3-A93E-40C0EC4F68E5&amp;displaylang=en">ORCA</a> and the guidance in the KB article above to understand what modifications the tool made to the MSI.
</p>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">As a final note, you&rsquo;ll see that the template you just published shows up in the startup screen, however the template preview is blank; I&rsquo;ll leave it up to crafty souls out there to figure out how to get template preview&rsquo;s this working&hellip; OR you could stay tuned to the Archive of Visio Insights blog (2006-2018) blog for more info =).
</p>
<p style="MARGIN: 0in 0in 10pt" class="MsoNormal">
<p>&nbsp;</p></p>
	</div><!-- .entry-content -->
<hr>

</article><!-- #post-## -->
</div><!-- #single-content -->
</div><!-- #primary -->
<!-- Before Navigation --></main><!-- #site-main -->

<a class=""""screen-reader-shortcut"""" href=""""#primary"""" tabindex=""""1""""></a> 

<div id=""secondary"" class=""sidebar col-sm-3"">
	<div id=""sidebar-widget-area"" class=""sidebar-widget-area"" role=""complementary"">
		<div class=""widget sfmsb_widget"">

		</div>
		<aside id="tag_cloud-2" class="widget widget_tag_cloud">
</aside>
<aside id="msdn-archive-widget-2" class="widget msdn-archive-widget"><h2 class="widget-title">Archives</h2>	
	<li><a href='..\..\..\years\2018\index.htm'>All of 2018</a>&nbsp;(5)</li>
	<li><a href='..\..\..\years\2017\index.htm'>All of 2017</a>&nbsp;(8)</li>
	<li><a href='..\..\..\years\2016\index.htm'>All of 2016</a>&nbsp;(3)</li>
	<li><a href='..\..\..\years\2012\index.htm'>All of 2012</a>&nbsp;(2)</li>
	<li><a href='..\..\..\years\2011\index.htm'>All of 2011</a>&nbsp;(11)</li>
	<li><a href='..\..\..\years\2010\index.htm'>All of 2010</a>&nbsp;(35)</li>
	<li><a href='..\..\..\years\2009\index.htm'>All of 2009</a>&nbsp;(50)</li>
	<li><a href='..\..\..\years\2008\index.htm'>All of 2008</a>&nbsp;(11)</li>
	<li><a href='..\..\..\years\2007\index.htm'>All of 2007</a>&nbsp;(26)</li>
	<li><a href='..\..\..\years\2006\index.htm'>All of 2006</a>&nbsp;(46)</li>
</aside>
</div><!-- #secondary -->
</div><!-- .site-content -->
</div>

<footer id="site-footer" class="site-footer row" role="contentinfo">
	<div id="site-info" class="site-info">
		<div id="footer-text" class="col-sm-4 col-sm-offset-6">
			<span>
				<a href="https://privacy.microsoft.com" data-mscc-ic="false">Privacy</a>
			</span>
			<span>
				<a href="https://msdn.microsoft.com/cc300389" data-mscc-ic="false">Terms of Use</a>
			</span>
			<span>
				<a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-mscc-ic="false">Trademarks</a>
			</span>
		</div>
		<div id="footer-far" class="col-sm-2">
			<div id="footer-microsoft-logo">
				<a href="https://www.microsoft.com" aria-label="Microsoft Logo">
					<svg id="footer-microsoft-logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 347 70.5" enable-background="new 0 0 347 70.5"><g fill="#fff"><path d="M39.5 44.6l-2.8 7.9h-.2c-.5-1.8-1.3-4.5-2.7-7.8l-15-37.7h-14.7v60h9.7v-37c0-2.3 0-5-.1-8.2-.1-1.6-.2-2.9-.3-3.8h.2c.5 2.3 1 4 1.4 5.1l18 43.8h6.8l17.9-44.2c.4-1 .8-3 1.2-4.7h.2c-.2 4.4-.4 8.4-.5 10.8v38.1h10.4v-60h-14.1l-15.4 37.7zM78.8 23.9h10.1v43h-10.1zM83.9 5.7c-1.7 0-3.1.6-4.3 1.7-1.2 1.1-1.8 2.5-1.8 4.2 0 1.6.6 3 1.8 4.1 1.2 1.1 2.6 1.6 4.3 1.6 1.7 0 3.2-.6 4.3-1.6 1.2-1.1 1.8-2.5 1.8-4.1 0-1.6-.6-3-1.8-4.2-1-1.2-2.5-1.7-4.3-1.7M124.7 23.5c-1.9-.4-3.8-.6-5.7-.6-4.6 0-8.8 1-12.3 3s-6.3 4.8-8.1 8.3c-1.9 3.6-2.8 7.7-2.8 12.4 0 4.1.9 7.8 2.7 11.1 1.8 3.3 4.3 5.9 7.6 7.7 3.2 1.8 6.9 2.7 11.1 2.7 4.8 0 8.9-1 12.2-2.9l.1-.1v-9.3l-.4.3c-1.5 1.1-3.2 2-4.9 2.6-1.8.6-3.4.9-4.8.9-4 0-7.2-1.2-9.5-3.7s-3.5-5.9-3.5-10.2c0-4.4 1.2-7.9 3.6-10.5 2.4-2.6 5.6-3.9 9.5-3.9 3.3 0 6.6 1.1 9.6 3.3l.4.3v-9.8l-.1-.1c-1.2-.6-2.8-1.1-4.7-1.5M158 23.2c-2.5 0-4.8.8-6.8 2.4-1.7 1.4-2.9 3.4-3.9 5.8h-.1v-7.4h-10.1v43h10.1v-22c0-3.7.8-6.8 2.5-9.1s3.9-3.5 6.5-3.5c.9 0 1.9.2 3 .4 1.1.3 1.9.6 2.4 1l.4.3v-10.2l-.2-.1c-.8-.4-2.1-.6-3.8-.6M185.5 22.9c-7.1 0-12.7 2.1-16.7 6.2s-6 9.8-6 16.9c0 6.7 2 12.1 5.9 16.1 3.9 3.9 9.2 5.9 15.8 5.9 6.9 0 12.4-2.1 16.4-6.3 4-4.2 6-9.8 6-16.7 0-6.8-1.9-12.3-5.7-16.2-3.7-3.9-9-5.9-15.7-5.9m8 33.1c-1.9 2.4-4.8 3.6-8.5 3.6s-6.6-1.2-8.7-3.7c-2.1-2.4-3.1-5.9-3.1-10.3 0-4.6 1.1-8.1 3.1-10.6 2.1-2.5 5-3.7 8.6-3.7 3.6 0 6.4 1.2 8.4 3.6 2 2.4 3.1 5.9 3.1 10.5s-1 8.2-2.9 10.6M229.3 41.7c-3.2-1.3-5.2-2.3-6.1-3.2-.8-.8-1.2-1.9-1.2-3.3 0-1.2.5-2.3 1.6-3.1 1.1-.8 2.5-1.2 4.4-1.2 1.7 0 3.5.3 5.2.8 1.7.5 3.3 1.2 4.5 2.1l.4.3v-9.4l-.2-.1c-1.2-.5-2.7-.9-4.6-1.3-1.9-.3-3.6-.5-5-.5-4.8 0-8.8 1.2-11.9 3.7-3.1 2.4-4.6 5.7-4.6 9.5 0 2 .3 3.8 1 5.3s1.7 2.9 3.1 4c1.4 1.1 3.4 2.3 6.2 3.5 2.3 1 4.1 1.8 5.2 2.4 1.1.6 1.8 1.3 2.3 1.9.4.6.6 1.4.6 2.4 0 2.9-2.2 4.3-6.6 4.3-1.7 0-3.5-.3-5.6-1-2.1-.7-4-1.7-5.7-2.9l-.4-.3v9.9l.2.1c1.5.7 3.3 1.2 5.4 1.7 2.2.4 4.1.7 5.8.7 5.2 0 9.5-1.2 12.5-3.7 3.1-2.5 4.7-5.7 4.7-9.8 0-2.9-.8-5.4-2.5-7.4-1.8-2-4.7-3.8-8.7-5.4M267.6 22.9c-7.1 0-12.7 2.1-16.7 6.2s-6 9.8-6 16.9c0 6.7 2 12.1 5.9 16.1 3.9 3.9 9.2 5.9 15.8 5.9 6.9 0 12.4-2.1 16.4-6.3 4-4.2 6-9.8 6-16.7 0-6.8-1.9-12.3-5.7-16.2-3.8-3.9-9.1-5.9-15.7-5.9m8 33.1c-1.9 2.4-4.8 3.6-8.5 3.6s-6.6-1.2-8.7-3.7c-2.1-2.4-3.1-5.9-3.1-10.3 0-4.6 1.1-8.1 3.1-10.6 2.1-2.5 5-3.7 8.6-3.7 3.5 0 6.4 1.2 8.4 3.6 2 2.4 3.1 5.9 3.1 10.5s-1 8.2-2.9 10.6"/><path d="M342.9 32.2v-8.2h-10.2v-12.9l-.3.1-9.6 2.9-.2.1v9.7h-15.2v-5.4c0-2.5.6-4.4 1.7-5.7 1.1-1.3 2.7-1.9 4.7-1.9 1.4 0 2.9.3 4.5 1l.4.2v-8.7l-.2-.1c-1.4-.5-3.3-.8-5.7-.8-3 0-5.7.7-8.1 1.9-2.4 1.3-4.2 3.1-5.5 5.5-1.3 2.3-2 5-2 8v6h-7.2v8.2h7.1v34.8h10.2v-34.7h15.2v22.1c0 9.1 4.3 13.7 12.8 13.7 1.4 0 2.9-.2 4.3-.5 1.5-.3 2.6-.7 3.2-1l.1-.1v-8.3l-.4.3c-.6.4-1.2.7-2.1.9-.8.2-1.5.3-2 .3-2 0-3.4-.5-4.4-1.6-.9-1.1-1.4-2.9-1.4-5.5v-20.3h10.3z"/></g></svg>
				</a>
			</div>
			<div id="copyright">
				© 2006 - 2018 Microsoft
			</div>
		</div>
	</div><!-- .site-info -->
</footer><!-- .site-footer -->

</div><!-- .site -->

</body>
</html>