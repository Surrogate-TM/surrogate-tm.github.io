<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>Формирование фигур в Visio.</TITLE>
	</HEAD>
	<BODY MARGINHEIGHT="30" TOPMARGIN="30" MARGINWIDTH="40" LEFTMARGIN="40" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
	<IMG ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72>
	<H1><P ALIGN=CENTER>Формирование фигур в Visio 2000 Ru и Visio 2002 Ru.</H1></P><BR>
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<IMG src="../images/null.gif" width=20 height=10>
	Объекты в Visio, как известно, представлены в виде векторов, векторы, с точки зрения программы, состоят из вершин. Вершины векторов являются точками. Проследим весь процесс формирования линий и фигур.<BR>
	<h3>Линии.</h3>
	Простая линия в Visio состоит из 2-х точек и является одномерной фигурой. Поэтому только для нее в ТаблицеФигур есть раздел 1-D конечные точки. В этом разделе 4 ячейки:
	<UL>
	<li>Ячейка BeginX – это X координата начала линии.
	<li>Ячейка BeginY – это Y координата начала линии.
	<li>Ячейка EndX – это X координата конца линии.
	<li>Ячейка EndY – это Y координата конца линии.
	</UL>
	<BR><IMG ALT="Раздел 1-D" src="../images/pic1101.png" width="197" height="52"><BR>
	<BR>Именно эти координаты и выводятся в окне “Позиция и размер”<BR>
	<BR><IMG ALT="Окно Позиция и размер" src="../images/pic1102.png" width="145" height="159"><BR>
	<BR>
	<h3>Прямоугольники.</h3>
	По умолчанию программа не производит заливку незамкнутых фигур. К примеру нарисуем 3 стороны прямоугольника.<BR>
	<BR><IMG ALT="ломаная и прямоугольник" src="../images/pic1103.png" width="181" height="131"><BR>
	<BR>Visio не произвел заливку. У этой фигуры определено начало ломанной и конец. И удаляя 1 из точек, Visio автоматически удаляет вектор. Но если закончить прямоугольник, то удалив 1 из вершин, ломаной линии не получится, а будет прямоугольный треугольник. Т.е Visio совмещает конец и начало ломаной линии и дальше на размыкает ее.
	<BR>При создании любой фигуры, Visio сразу создает ТаблицуФигуры. Обратимся к разделу Геометрия. В нем перечислены строки формирования начерченной фигуры.
	<BR>В разделе Геометрия1 есть в первой строке 4 ячейки:
	<BR>
	<BR><IMG ALT="Раздел Геометрия" src="../images/pic1104.png" width="580" height="35"><BR>
	<UL>
	<LI>Ячейка Geometry1.NoFill отвечает, как раз, именно за разрешение заливки фигуры. Если записать в ячейку 0, то программа произведет заливку незамкнутой фигуры. Если 1, то заливки не будет даже если фигура замкнутая.
	<LI>Ячейка Geometry1.NoLine отвечает за отображение линий у объекта. Если записать 1, то линия отображаться не будет. По умолчанию, записано в ячейку 0.
	<LI>Ячейка Geometry1.NoShow отвечает за полное отображение фигуры, т.е. будет ли она вообще отображаться программой или нет. Если записать 1, то фигура отображаться не будет, но ее можно будет выделить.
	<LI>Ячейка Geometry1.NoSnap отвечает за использование контура или элементов фигуры как шаг.
	<BR>Чтобы это понять, надо нарисовать круг и линию и попробовать переместить конец линии на контур круга. Конец линии станет скользить по контуру, т.е. минимальное перемещение конца линии стало меньше, чем шаг сетки. Теперь перемещение по линии контура будет считаться минимальным шагом. Если записать в ячейку 1, то этого происходить не будет, т.е. шаг перемещения линии останется неизменным и будет равен шагу сетки.
	<BR>
	<BR><IMG ALT="Скользящий шаг" src="../images/pic1105.png" width="781" height="301"><BR>
	</UL>
	Следующими строками идут вектора.<BR>
	<BR><IMG ALT="Продолжение раздела Геометрия" src="../images/pic1106.png" width="466" height="103"><BR>
	<BR>Начало фигуры обозначается строкой MoveTo и она же является самой верхней строкой. Столбцы X и Y в данном случае показывают расположение вершин в локальной системе отсчета фигуры.<BR>
	<BR><IMG ALT="Выбор вершины" src="../images/pic1107.png" width="101" height="61"><BR>
	<BR>Если переместить курсор на эту ячейку, то на фигуре точка с этими координатами будет выделена черным квадратом. Ниже идут строки LineTo, т.е. куда везти линию и координаты этой точки. Таким образом получается, что прямоугольник будет состоять из точки начала и 4-х векторов. Если дочертить 4-й вектор, то именно так оно и будет. Если вставить еще пару строку ниже и изменить тип строки на MoveTo, то все равно 2 фигуры не получится. Просто получится разрыв между векторами, хотя начало и конец у фигуры все равно будет 1. Можно даже составить 2 замкнутых прямоугольника (по точкам вручную), и применить заливку.<BR>
	<BR><IMG ALT="Фигура из 8 вершин" src="../images/pic1108.png" width="474" height="308"><BR>
	<BR>При черчении линий и ломаных есть возможность назначить стрелки концам линии, но если применить заливку линии, путем записи 0 в ячейку Geometry1.NoFill, автоматически исчезнут стрелки. Равно как существует и обратный процесс, т.е. если нарисовать прямоугольник и записать 1, то станет возможным назначить стрелки фигуре.<BR>
	<BR><IMG ALT="Значение параметра" src="../images/pic1109.png" width="401" height="141"><BR>
	<H3>Окружности.</H3>
	Окружность можно сделать по разному. Её можно составить из 4 дуг или просто выбрать инструмент Эллипс и начертить. Но с точки зрения программы это будут разные объекты.
	<BR>Рассмотрим “простой” способ, т.е. выберем инструмент Эллипс и начертим его. Затем зайдем в ТаблицуФигур. В разделе Геометрия1, вместо MoveTo и 4-х LineTo стала всего 1 строка Ellipse.<BR>
	<BR><IMG ALT="Раздел Геометрия для эллипса" src="../images/pic1110.png" width="592" height="69"><BR>
	<BR>Таким образом для программы эллипс является примитивной фигурой. Прямоугольник тоже в своем роде “примитивная фигура”, т.к. для построения прямоугольника надо знать 2 точки (и угол конечно, если он отличается от 0), но видимо создатели программы решили иначе.
	<BR>Помимо стандартных ячеек X и Y записаны также следующие ячейки:
	<UL>
	<LI>Ячейка A – это X координата точки пересечения контура эллипса с большой осью. 
	<LI>Ячейка B – это Y координата точки пересечения контура эллипса с большой осью.
	<LI>Ячейка C – это X координата точки пересечения контура эллипса с малой осью.
	<LI>Ячейка D – это Y координата точки пересечения контура эллипса с малой осью.
	</UL>
	<BR><IMG ALT="Фокусы и точки эллипса" src="../images/pic1111.png" width="493" height="241"><BR>
	<H3>Трансформация.</H3>
	Теперь рассмотрим процесс трансформации одного объекта в другой. Как известно, все фигуры из трафаретов перемещаемые на рабочую страницу, сохраняют свои связи не с мастером трафарета, а копируются в трафарет документа и уже связываются с локальным мастером. Это легко увидеть если открыть трафарет документа (Visio 2000: Окно>Показать трафарет документа, Visio 2002:Файл>Трафареты>Трафарет чертежа) и затем открыть трафарет Basic Shapes. При перемещении прямоугольника на страницу чертежа, он автоматически появляется в локальном трафарете.<BR>
	<BR><IMG ALT="Создание локального мастера" src="../images/pic1112.png" width="376" height="381"><BR>
	<BR>Это сделано для того, чтобы не возникло проблем на другом компьютере или с программами просмотра (типа Visio Viewer). Ведь такого трафарета на другом компьютере могли и не устанавливать. Теперь поместим на страницу еще с десяток прямоугольников и изменим из размеры. Как видите, на локальном трафарете так и остался 1 мастер. Теперь в каждый прямоугольник внесите надписи и Другие свойства. Затем откройте локальный мастер для редактирования и откройте ТаблицуФигур. Теперь выделите в разделе Геометрия1 любую ячейку в строке LineTo, нажмите правой кнопкой мыши и выберите Изменить тип строки. В открывшемся окне отметьте Ellipse и нажимайте ОК.<BR>
	<BR><IMG ALT="Окно изменения типа строки" src="../images/pic1114.png" width="215" height="297"><BR>
	<BR>Теперь в разделе Геометрия1 всего 1 строка и мастер из прямоугольника стал эллипсом. Если закрыть окно редактирования, то увидим, что все фигуры на листе сменились на эллипсы, но надписи и свойства остались неизменными.<BR>
	<BR><IMG ALT="Трансформация" src="../images/pic1113.png" width="381" height="321"><BR>
	<BR>
	Обратный процесс тоже легко сделать, но это, как говорится, уже совсем другая история…
	<BR>
	<BR><HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	&#160;<A HREF="../articles/article10.html">Предыдущая статья</A>
	&#160;<A HREF="../articles/article12.html">Следующая статья</A>
	&#160;Автор: Ничков Алексей <A HREF="mailto:digitall@mail.ru">(Digitall)</A></P>

</body>
</html> 