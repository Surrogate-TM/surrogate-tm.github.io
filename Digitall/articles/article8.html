<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>Методы создания градиентных заливок линий.</TITLE>
	</HEAD>
	<BODY MARGINHEIGHT="30" TOPMARGIN="30" MARGINWIDTH="40" LEFTMARGIN="40" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
	<IMG ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72>
	<H1><P ALIGN=CENTER>Методы создания градиентных заливок линий.</H1></P><BR>
<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<IMG src="../images/null.gif" width=20 height=10>При создании бизнес диаграмм иногда возникает необходимость  в красочном обрамлении фигур этой диаграммы, но Visio позволяет делать контур только одного цвета. Существует несколько способов обойти это ограничение. Все красивые градиентные заливки в Visio это не что иное, как просто ступенчатое изменение цвета на какую-то величину. Если этих ступеней перехода цвета много, то для глаза этот переход будет казаться сплошным.
	<BR>Рассмотрим несколько примеров с увеличивающимся числом ступеней.<BR>
	<BR><IMG ALT="Примеры с разным числом переходов" src="../images/pic0801.png" width=480 height=180><BR>
	<BR><IMG src="../images/null.gif" width=20 height=10>Как видно на рисунке, после 64 ступеней для глаза они уже незаметны, но для Visio они представляют собой просто множество фигур со сплошной заливкой. Теперь достаточно создать новый узор линии, поместить созданную сплошную заливку и все, она готова к применению.
	<BR><IMG src="../images/null.gif" width=20 height=10>Теперь необходимо создать этот новый узор. Этот способ работает только для Visio 2000. Это связано с особенностью представления прямоугольников для метафайлов в последующих версиях. Делается это следующим образом:
	<BR>Создается узор линии. Для этого необходимо сделать видимым окно Обозревателя чертежа (Drawing Explorer window), в меню выбрать <b>Вид<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Окно Обозревателя чертежа</b> (<b>View<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Drawing Explorer window</b>). В окне выбираем «Узоры линии» левой кнопкой мыши и в контекстном меню выбираем Создать узор…(New pattern…). В диалоговом окне назначаем имя (Градиент, например) и нажимаем ОК.<BR>
	<BR><IMG ALT="Окно создания шаблона" src="../images/pic0802.png" width=390 height=249><BR>
	<BR>Теперь выбираем только что созданный узор и нажимая правой кнопкой мыши в контекстном меню выбираем Изменить узор (Edit pattern). В открывшемся окне рисуем прямоугольник 1х5 мм. Убираем линию обводки этого прямоугольника, либо через панель инструментов, либо через диалоговое окно в меню <b>Формат<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Линия...</b>(<b>Format<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Line…</b>) и в разделе «Шаблон» выбрать Отсутствует (None).<BR>
	<BR><IMG ALT="Окно настройки линии" src="../images/pic0803.png" width=431 height=357><BR>
	<BR>Делаем заливку необходимыми цветами через диалоговое окно в меню <b>Формат<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Заливка...</b>(<b>Format<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Fill…</b>) или нажатием F3 (например с красного на синий, вертикально).<BR>
	<BR><IMG ALT="Окно настройки заливки" src="../images/pic0804.png" width=404 height=309><BR>
	<BR>Выделяем прямоугольник и вырезам его (Ctrl+X), в меню выбираем, <b>Правка<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Специальная вставка… </b>(<b>Edit<span style="mso-char-type: symbol; font-family: Webdings;mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Paste Special…</b>) и в появившемся окне выбираем Рисунок (расширенный метафайл)(Picture (Enhanced Metafile)).<BR>
	<BR><IMG ALT="Окно Специальная вставка" src="../images/pic0805.png" width=371 height=295><BR>
	<BR>Разгруппируем полученную фигуру (Ctrl+U) (этим преобразуем его в Visio объекты) и сгруппируем (Ctrl+G). И теперь выходим из окна редактирования, соглашаясь на обновление узора.
Создадим предполагаемую фигуру (прямоугольник с округлением углов) и в диалоговом окне выберем шаблон линии на название только что созданной заливки линии. Недостатками данного способа являются, медленность работы на слабых машинах (очень много объектов), невозможность использования очень темных цветов (программа будет воспринимать их как шаблон цвета узора). К достоинствам данного способа относится простота. 
	<BR><BR><IMG src="../images/null.gif" width=20 height=10>Следующий способ является самым долгим, но он будет иметь возможность изменять цвет заливки линии и работает во всех версиях Visio. Для начала необходимо создать в ТаблицеФигур документа Раздел Ячейки пользователя. Для этого в окне Обозревателя чертежа на имени документа нажимается правая кнопка и в контекстном меню выбирается Показать ТаблицуФигуры (Show ShapeSheet).<BR>
	<BR><IMG ALT="Выбор ТаблицыФигур для документа" src="../images/pic0806.png" width=401 height=244><BR>
	<BR>Далее в любом пустом месте этой таблицы нажать на правую кнопку мыши и выбрать в контекстном меню Вставка раздела…(Insert Section…).<BR>
	<BR><IMG ALT="Меню вставки раздела" src="../images/pic0807.png" width=318 height=257><BR>
	<BR>В диалоговом окне вставки раздела отметить раздел Ячейки пользователя (User-Defined Cells) и нажать ОК.<BR>
	<BR><IMG ALT="Окно вставки раздела" src="../images/pic0808.png" width=350 height=241><BR>
	<BR>Теперь необходимо создать еще одну строку в этом разделе. Для этого надо нажать на строке этого раздела и в появившемся меню выбрать Вставка строки (Inser Row).<BR>
	<BR><IMG ALT="Добавление строки" src="../images/pic0809.png" width=331 height=241><BR>
	<BR>С этой таблицей все. Закрываем ее.
	Теперь необходимо создать узор линии, как было описано выше. Дальнейшие действия производятся в окне редактирования узора. В этом окне необходимо создать квадрат с размерами 5х5 мм. Первой созданной фигурой будет фигура с ID (уникальным номером) равным 5. Следующей созданной фигурой будет фигура с ID равным 6 и т.д. 
	Для созданного прямоугольника необходимо внести изменения в ТаблицуФигур. Для этого надо выделить этот квадрат и в меню выбрать <b>Окно<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Показать ТаблицуФигур</b> (<b>Window<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Show ShapeSheet</b>). Нужно в разделе Формат заливки внести следующие изменения:
<BR>Для Visio 2000 и Visio 2002
<BR><BR><IMG src="../images/null.gif" width=20 height=10>В ячейку FillForegnd:<BR>
=RGB(RED(TheDoc!User.Row_1)-(RED(TheDoc!User.Row_1)-RED(TheDoc!User.Row_2))/64*(ID()-5);GREEN(TheDoc!User.Row_1)-(GREEN(TheDoc!User.Row_1)-GREEN(TheDoc!User.Row_2))/64*(ID()-5);BLUE(TheDoc!User.Row_1)-(BLUE(TheDoc!User.Row_1)-BLUE(TheDoc!User.Row_2))/64*(ID()-5))<BR>
<BR>Для Visio 2003
<BR><BR><IMG src="../images/null.gif" width=20 height=10>В ячейку FillForegnd:<BR>
=RGB(RED(TheDoc!User.Row_1)-(RED(TheDoc!User.Row_1)-RED(TheDoc!User.Row_2))/64*(ID()-5),GREEN(TheDoc!User.Row_1)-(GREEN(TheDoc!User.Row_1)-GREEN(TheDoc!User.Row_2))/64*(ID()-5),BLUE(TheDoc!User.Row_1)-(BLUE(TheDoc!User.Row_1)-BLUE(TheDoc!User.Row_2))/64*(ID()-5))<BR>
Далее необходимо скопировать этот квадрат (переместить с зажатой кнопкой Ctrl), потом еще раз, затем скопированные.<BR>
	<BR><IMG ALT="Копирование объекта" src="../images/pic0810.png" width=223 height=78><BR>
	<BR>Т.е. удваивание копируемых прямоугольников пока их не станет 64.
	Далее в 65 (он будет такого же цвета, что и 1-й) прямоугольник нужно в разделе Формат заливки внести следующие изменения:
<BR>Для Visio 2000 и Visio 2002
<BR><BR><IMG src="../images/null.gif" width=20 height=10>В ячейку FillForegnd:<BR>
=RGB(RED(TheDoc!User.Row_1)-(RED(TheDoc!User.Row_1)-RED(TheDoc!User.Row_2))/64*(ID()-70);GREEN(TheDoc!User.Row_1)-(GREEN(TheDoc!User.Row_1)-GREEN(TheDoc!User.Row_2))/64*(ID()-70);BLUE(TheDoc!User.Row_1)-(BLUE(TheDoc!User.Row_1)-BLUE(TheDoc!User.Row_2))/64*(ID()-70))<BR>
<BR>Для Visio 2003
<BR><BR><IMG src="../images/null.gif" width=20 height=10>В ячейку FillForegnd:<BR>
=RGB(RED(TheDoc!User.Row_1)-(RED(TheDoc!User.Row_1)-RED(TheDoc!User.Row_2))/64*(ID()-70),GREEN(TheDoc!User.Row_1)-(GREEN(TheDoc!User.Row_1)-GREEN(TheDoc!User.Row_2))/64*(ID()-70),BLUE(TheDoc!User.Row_1)-(BLUE(TheDoc!User.Row_1)-BLUE(TheDoc!User.Row_2))/64*(ID()-70))<BR>
	И снова скопировать, пока общее количество не станет 128. 
	 Т.е. получатся 2 полных перехода из первого цвета во второй, а если получится часть третьего перехода, ее следует удалить.<BR>
	<BR><IMG ALT="2 перехода" src="../images/pic0811.png" width=541 height=33><BR>
	<BR>Далее необходимо выделить 1 полный переход, сгруппировать и обратить горизонтально (Ctrl+H). Так получается один полный переход из одного цвета и обратно. Теперь выделив все фигуры и разгруппировав все на отдельные фигуры, выберите в меню <b>Формат<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Поведение...</b>(<b>Format<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Behavior...</b>). В диалоговом окне отметьте "Только изменения положения"(Reposition only).<BR>
	<BR><IMG ALT="Окно настроек поведения объекта" src="../images/pic0812.png" width=543 height=373><BR>
	<BR>Затем сгруппируйте все фигуры сразу в одну группу. Делаем фигуры без обводной линии. Уменьшив ширину группы в двое (645 mm-320 mm), получаем половинное перекрытие фигур. Далее необходимо обновить маркеры фигуры. Для этого выделяем группу и выбираем в меню <b>Фигура<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Операции<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Обновить маркеры фигуры</b> (<b>Shape<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Operations<span style="mso-char-type: symbol; font-family: Webdings; mso-symbol-font-family: Webdings; mso-ascii-font-family: Times New Roman">4</span>Update Alignment Box</b>). И наконец, закрываем окно редактирования, соглашаясь на обновление узора. Далее необходимо выбрать фигуру, указать в качестве шаблона «Градиент». Теперь надо зайти в ТаблицуФигур данной фигуры и создать Раздел Действия.<BR>
	<BR><IMG ALT="Окно вставки разделов" src="../images/pic0813.png" width=350 height=240><BR>
	<BR>Добавить строку к этому разделу и внести изменения:
	<BR>В ячейку Action первой строки:
	<BR>=SETF(GetRef(TheDoc!User.Row_1);LineColor)
	<BR>В ячейку Menu первой строки:
	<BR>="Установить первый цвет линии"
	<BR>И создать вторую строку.<BR>
	<BR><IMG ALT="Вставка строки в раздел" src="../images/pic0814.png" width=481 height=249><BR>
	<BR>
	<BR>В ячейку Action второй строки:
	<BR>=SETF(GetRef(TheDoc!User.Row_2);LineColor)
	<BR>В ячейку Menu второй строки:
	<BR>="Установить второй цвет линии"<BR>
	<BR><IMG ALT="Заполненый раздел" src="../images/pic0815.png" width=668 height=52><BR>
	<BR>Теперь выбрав первый цвет в настройках линии и нажав правой кнопкой мыши на фигуре и в меню выбрав «Установить первый цвет» установите первый цвет градиентной заливки линии.<BR>
	<BR><IMG ALT="Результат" src="../images/pic0816.png" width=298 height=291><BR>
	<BR>Повторив операцию, выберите второй цвет линии. Теперь просто сменив цвет линии третий раз, получите результат.
	<BR>Логично предположить, что если сделать пересчет цвета в двух направлениях, то получится настраиваемая градиентная заливка, возможности которой будут выше, чем встроенные в Visio.
	<BR><BR><A HREF="../stencils/index.html">Примеры из статьи.</A><BR>
	<BR><HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	   &#160;<A HREF="../articles/article7.html">Предыдущая статья</A>
	   &#160;<A HREF="../articles/article9.html">Следующая статья</A>
	   &#160;Автор: Ничков Алексей <A HREF="mailto:digitall@mail.ru">(Digitall)</A></P>

</body>
</html> 
