<DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//RU">
<HTML>
	<HEAD>
		<TITLE>Почти конфиденциально в Visio 2003.</TITLE>
	</HEAD>
	<BODY MARGINHEIGHT="30" TOPMARGIN="30" MARGINWIDTH="40" LEFTMARGIN="40" BACKGROUND="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="Blue" ALINK="Navy" VLINK="Purple">
	<IMG ALT="Раздел Статьи" ALIGN=LEFT src="../images/article.gif" width=72 height=72>
	<H1><P ALIGN=CENTER>Почти конфиденциально в Visio 2003.</H1></P><BR>
	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<IMG src="../images/null.gif" width=20 height=10>
	Защита документа представлена в Visio скупо. Вернее защиты нет как таковой. Есть только защита некоторых свойств документа, стилей. Но в самом простом случае её можно отключить. Итак, как же защитить свой документ? Причем еще сделать это лучше так, чтобы человек мог только просмотреть документ или распечатать и еще надпись во весь экран «Конфиденциально». Да, для этих целей подойдет PDF. Но ведь после преобразования в PDF редактировать документ можно только в этом самом reader’е. Да и вообще, отсутствие средств к защите документа раньше решалась просто, сохранением в графическом формате. Графический формат лучше всего подходит для пересылки по почте всяких чертежей. Для черно-белых лучше всего подходит PNG или TIFF, но дальше, дело вкуса.<br><br>

	Но иногда все же возникала необходимость отправки чертежей в векторном формате. Тоже есть решение, импортирование в метафайл в Word.<br><br>

	Ну да ладно. Есть Visio, и с его помощью и будем решать эту задачу. Открываем Visio, рисуем что-либо и пытаемся это защитить.<br><br>
	<img src="../images/pic2501.png"><br><br>
	
	Сначала создаем страницу по шаблону текущей.(<b>Insert>New Page...</b>)<br><br>
	<img src="../images/pic2502.png"><br><br>

	Потом делаем страницу с фигурами фоновой.(<b>File>Page Setup...>Page properties>Type>Background</b>)<br><br>
	<img src="../images/pic2503.png"><br><br>

	Настраиваем фоновую страницу как фон к основной.(<b>File>Page Setup...>Page properties>Background>Page-1</b>)<br><br>
	<img src="../images/pic2504.png"><br><br>

	И скрываем фоновую из возможности выбора страниц. Для этого входим в TаблицуФигур(ShapeSheet) страницы Page-1, т.е. фоновую страницу и в разделе Page Properties в ячейку UIVisibility вносим 1.<br><br>
	<img src="../images/pic2505.png"><br><br>
	<img src="../images/pic2506.png"><br><br>
	Пока еще активное окно принадлежит странице с фигурами, но стоит переключится на другую страницу, как выбрать фигуры и что-либо с ними сделать не получится.<br><br>
	Что получилось? Получилось, что есть одна единственная страница, на которой нельзя ничего выделить, можно чертить поверх данных фигур, распечатывать, и более ничего. Можно еще удалить все мастера документа, если есть интересные. :-)<br><br>
	
	Но раз есть способ все это скрыть, значит должен существовать способ все это вернуть обратно. Через интерфейс пользователя этого сделать не получится и в этом случае можно рассматривать как «плюс». Нужен макрос.<br><br>
	Вызываем окно редактора Microsoft Visual Basic, либо через меню (<b>Tools>Macros>Visual Basic Editor</b>), либо комбинацией клавиш Alt+F11. Затем в редакторе выбираем документ(ThisDocument) и двойным нажатием на нем открываем окно редактора. Далее в это окно вносим код.<br><br>
	
	Sub Test()<br>i = ThisDocument.Pages.Count<br>For k = 1 To i<br>ThisDocument.Pages.Item(k).PageSheet.CellsSRC(visSectionObject, visRowPage, visPageUIVisibility).FormulaU = "0"<br>Next k<br>End Sub<br><br>
	<img src="../images/pic2507.png"><br><br>

	Данный макрос ставит 0 в ячейку невидимости всех страниц.<br><br>
	
	Можно конечно и все сделать по другому. Сделать слой, потом защитить его или еще как-нибудь, но дело в том, что вернуть это все можно тоже использую интерфейс пользователя, стандартный интерфейс. В данном же случае надо знать, что есть фоновая страница, надо знать, что их можно скрывать и вообще глубоко разбираться в вопросе. Т.е. в сущности надо хорошо знать Visio да и еще VBA немного знать. Так что данный тип защиты подойдет для большинства пользователей Visio. Для пущей сложности, можно комбинировать информацию на основной странице с фоновой, если конечно в этом есть смысл. Иначе выльется это все в головную боль.<br><br>
	<h2>Советы по работе с программой</h2>
	<ol><li>Чтобы в дальнейшем вас не беспокоило окно наличия макросов в документе, просто удалите их. Странный совет, однако это так. Если вы удалили все модули из документа, а окно все равно появляется, значит надо зайти в ThisDocument, нажать Ctrl+A и затем Delete. После этого не закрывая окна сохраните документ средствами Visual Basic Editor'а. Окно о наличии макросов в документе более не будет появляться.
	<li>Простое объединение одной фигуры удаляет с него все соединительные точки. Легко и просто.
	<li>Мульти-мастер. Если в мастере создать 2-3 группы, и в образе удалить одну из них, скажем группу А, то если внести новую фигуру в группу А мастера, в образе её не будет! Достаточно сложный механизм для понимания, однако с помощью этого простого правила можно создавать <b>2! и более</b> различных образов одного мастера с возможностью последующего <b>раздельного</b> редактирования.
	<img src="../images/pic2508.png">
	</ol>

	<HR WIDTH=75% ALIGN=CENTER COLOR="#6699FF"><BR>
	<P>&#160;<A HREF="../articles/index.html">В начало раздела</A>
	   &#160;<A HREF="../articles/article24.html">Предыдущая статья</A>
	   &#160;<A HREF="../articles/article26.html">Следующая статья</A>
	   &#160;Автор: Ничков Алексей <A HREF="mailto:digitall@mail.ru">(Digitall)</A></P>

</body>
</html>