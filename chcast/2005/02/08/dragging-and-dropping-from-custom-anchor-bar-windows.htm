<!DOCTYPE html>
<html lang="en-US">
<head>
              <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.5/css/bootstrap.min.css">
<title>Dragging-and-dropping from Custom Anchor Bar Windows &#8211; Chris Castillo&#039;s WebLog</title>
<link rel='dns-prefetch' href='//ajax.aspnetcdn.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='stylesheet' id='wds-ratings-css'  href='https://blogs.msdn.microsoft.com/wp-content/plugins/wds-ratings/wds-ratings.css?ver=20161014' type='text/css' media='all' />
<link rel='stylesheet' id='microsoft-parent-style-css'  href='https://blogs.msdn.microsoft.com/wp-content/themes/microsoft/style.css?ver=02092017' type='text/css' media='all' />
<link rel='stylesheet' id='microsoft-child-style-css'  href='https://blogs.msdn.microsoft.com/wp-content/themes/microsoft-msdn/style.css?ver=04152016' type='text/css' media='all' />
	<div id='msccBanner' dir='ltr' data-site-name='uhf-TechNetBlogs' data-mscc-version='0.4.0' data-nver='aspnet-2.0.7' data-sver='0.1.2' class='cc-banner' role='alert'>
<link rel=""shortcut icon"" href=""https://i1.social.s-msft.com/Forums/GlobalResources/images/Technet/favicon.ico"">

<link rel="canonical" href="https://blogs.msdn.microsoft.com/chcast/2005/02/08/dragging-and-dropping-from-custom-anchor-bar-windows/" />
<!-- og:title -->
<meta property="og:title" content="Dragging-and-dropping from Custom Anchor Bar Windows" />
<!-- og:description -->
<meta property="og:description" content="I think the Visio application environment is pretty impressive because of all the things you can do to customize the user interface. There are not very many apps out there that will let you add your own custom windows. Visio allows developers to do just that by enabling you to add Windows Forms as anchor..." />
</head>
<body class="post-template-default single single-post postid-63 single-format-standard">
<div id="page" class="site container-fluid">
	<header id="site-header" class="site-header row" role="banner">
		<div id="site-header-global-wrapper" class="site-header-global-wrapper">
			<div id="site-header-global" class="site-header-global">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#site-profile-menu" aria-label="toggle menu" tabindex="0" aria-expanded="false">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<div id="site-logo" class="col-sm-5 row navbar-header">
					<div id="header-microsoft-logo">
						<a id="home-link" href="https://www.microsoft.com/" tabindex="1" aria-label="Microsoft logo">
							<img id="header-microsoft-logo-svg" src="https://blogs.msdn.microsoft.com/visio/wp-content/themes/microsoft/images/ms-logo-gray.svg" alt="Microsoft logo">
							<span id="brand">
								<span id="brand-separator">|</span>
								<span id="brand-name"></span>
							</span>
						</a>
					</div>
				</div>
				<div id="site-header-global-right" class="col-sm-7">
				</div>
			</div>

		</div>
		<div id="site-header-blog-wrapper" class="site-header-blog-wrapper ms-blog-header clear-both">
			<div id="site-header-blog" class="site-header-blog">
				<nav class="navbar navbar-inverse">
					<div id="blog-logo-area" class="navbar-header">
						<div id="blog-logo" data-toggle="collapse" data-target="#blog-menu" tabindex="0" aria-label="blog logo">
														<div id="blog-logo-text">
<h1 class="site-title ms-blog-title">
					<a href="https://blogs.msdn.microsoft.com/chcast" class="for-desktop">
						Chris Castillo&#039;s WebLog					</a>
					<a href="https://blogs.msdn.microsoft.com/chcast" class="for-mobile">
						Chris Castillo&#039;s WebLog					</a>
				</h1>
<!-- blog description -->
<p class="site-description ms-blog-description">Visio Solution Development</p>
			</div>
									</div>
					</div>
									</nav>
			</div>
			
		</div>
		<div id="site-content" class="site-content row">

	<div id="primary" class="content-area col-sm-9">
	<main id="site-main" class="site-main" role="main">
		<div id="single-content" class="div-content">
<!-- Post start -->
<article id="post-63" class="post-63 post type-post status-publish format-standard hentry category-uncategorized">
	<header class="entry-header">
<h1 class="entry-title">Dragging-and-dropping from Custom Anchor Bar Windows</h1>
<div class="entry-meta">
<span class="byline"><span class="author vcard"><a class="url fn n profile-usercard-hover" data-profile-userid="" href="https://blogs.msdn.microsoft.com/chcast/author/msdnarchive/">MSDN Archive</a></span>
</span><span class="posted-on posted-on-margin">
			<span class="screen-reader-text"></span>
<time class="entry-date published updated" datetime="2005-02-08T17:26:00+00:00">February 8, 2005</time>
			</span>
		</div>
		<hr>
	</header><!-- .entry-header -->
<div class="entry-content single">
		<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">I think the Visio application environment is pretty impressive because of all the things you can do to customize the user interface. There are not very many apps out there that will let you add your own custom windows. Visio allows developers to do just that by enabling you to add Windows Forms as anchor bar windows. The Custom Properties window and the Pan &amp; Zoom window are examples anchor bar windows. They can be docked, pinned, and resized on top of the Visio drawing surface.<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">I hope by now you have downloaded the Visio 2003 SDK. It has so many code samples for VB6, VB.NET and C#. There is even a sample that shows you how to create an anchor bar window. It also shows you how to drag and drop items from a list view control on to the Visio drawing surface as a shape. For those of you who are new to the Visio 2003 SDK, or Visio development in general, I would like to show you how to use the Code Librarian samples included with the Visio 2003 SDK.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">The code samples in the Code Librarian are intended to be used in a variety of development scenarios. You can use them when creating a Visio add-in or add-on, when using the Visio drawing control, or even in standard Windows Applications that just launch and automate the Visio application environment. The <b style="mso-bidi-font-weight: normal">Anchor Bar Usage</b> sample would most commonly be used in a Visio add-in scenario, but for illustrative purposes, we will create a standard Windows Application:<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<ol style="MARGIN-TOP: 0in" type="1">
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l3 level1 lfo1; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">First, launch Microsoft Visual Studio .NET 2003.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l3 level1 lfo1; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Create a <b style="mso-bidi-font-weight: normal">New Project</b>.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l3 level1 lfo1; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">In the New Project dialog, select <b style="mso-bidi-font-weight: normal">Visual Basic Projects</b>. Then, select the <b style="mso-bidi-font-weight: normal">Windows Application</b> template.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l3 level1 lfo1; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Name the project <b style="mso-bidi-font-weight: normal">Anchor Bar Usage</b>, or whatever you want. Click OK.<o:p></o:p></span></li>
</ol>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">Next, you will need to add a reference to the Visio Primary Interoperability Assembly (“PIA” for short). The Visio PIA gives you access to the COM-based Visio Object Model. To add a reference to the Visio 11 PIA:<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<ol style="MARGIN-TOP: 0in" type="1">
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l2 level1 lfo2; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">From your VB.NET project, click the <b style="mso-bidi-font-weight: normal">Project</b> menu, and then click <b style="mso-bidi-font-weight: normal">Add Reference</b>. <o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l2 level1 lfo2; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">In the Add Reference dialog, click the <b style="mso-bidi-font-weight: normal">COM</b> tab. <o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l2 level1 lfo2; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Scroll down the list and select <b style="mso-bidi-font-weight: normal">Microsoft Visio 11.0 Type Library</b>. Click the <b style="mso-bidi-font-weight: normal">Select</b> button, then click OK<o:p></o:p></span></li>
</ol>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">Then you need to remove the default root namespace that is assigned when creating Visual Basic .NET projects. Note: You don’t have to do this in C# projects.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<ol style="MARGIN-TOP: 0in" type="1">
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l5 level1 lfo5; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">In Visual Studio .NET, click the <b style="mso-bidi-font-weight: normal">Project </b>menu, and then click <b style="mso-bidi-font-weight: normal">Anchor Bar Usage Properties</b>.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l5 level1 lfo5; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Under the General properties, remove the contents of the <b style="mso-bidi-font-weight: normal">Root namespace</b> text box. Click OK.<o:p></o:p></span></li>
</ol>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">Now let’s get some code from the Code Librarian. After installing the Visio 2003 SDK, you should have a shortcut titled <b style="mso-bidi-font-weight: normal">Microsoft Office Visio Code Librarian Viewer</b> under the <b style="mso-bidi-font-weight: normal">Microsoft Office Visio 2003 SDK</b> Start Menu folder. Go ahead and start up the Code Librarian.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">The Code Librarian has a tree in the top left-hand corner that allows you to navigate the different samples. Alternatively, you can use the search button on the toolbar. Find the <b style="mso-bidi-font-weight: normal">Anchor Bar Usage </b>sample for <b style="mso-bidi-font-weight: normal">Microsoft Visual Basic .NET</b> under <b style="mso-bidi-font-weight: normal">User Interface</b>.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">The Anchor Bar Usage sample consists of two parts: a form and a module. Let’s add the module first because it’s more straightforward:<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<ol style="MARGIN-TOP: 0in" type="1">
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo3; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">In Visual Studio .NET, click the <b style="mso-bidi-font-weight: normal">Project</b> menu, and then click <b style="mso-bidi-font-weight: normal">Add New Item</b>. <o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo3; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Select the <b style="mso-bidi-font-weight: normal">Module </b>template.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo3; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Name it <b style="mso-bidi-font-weight: normal">AnchorBarsUsage.vb</b>. (Note: You can find a suggested name in the comments towards the top of the sample in Code Librarian.) Click OK.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo3; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">In Code Librarian, make sure the <b style="mso-bidi-font-weight: normal">Anchor Bars Usage</b> module is selected in the tree.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo3; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Copy the code from the code pane to the clipboard.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo3; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Replace the contents of AnchorBarsUsage.vb with the code in the clipboard. Save.<o:p></o:p></span></li>
</ol>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">Now adding the form is a bit tricky because a form as a resource file associated with it. The resource file is not in the Code Librarian, but rather in a folder where the Code Librarian database is installed. Here’s how you add the sample Anchor Bar form.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<ol style="MARGIN-TOP: 0in" type="1">
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l4 level1 lfo4; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">In Visual Studio .NET, click the <b style="mso-bidi-font-weight: normal">Project</b> menu, and then click <b style="mso-bidi-font-weight: normal">Add New Item</b>. <o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l4 level1 lfo4; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Select the <b style="mso-bidi-font-weight: normal">Windows Form </b>template.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l4 level1 lfo4; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Name it <b style="mso-bidi-font-weight: normal">AnchorBarForm.vb</b>. Click OK.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l4 level1 lfo4; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">In Code Librarian, select the <b style="mso-bidi-font-weight: normal">Anchor Bars Form</b> form sample is in the tree.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l4 level1 lfo4; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Copy the code from the code pane to the clipboard.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l4 level1 lfo4; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Replace the contents of AnchorBarForm.vb with the code in the clipboard. Save.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l4 level1 lfo4; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Open Windows Explorer.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l4 level1 lfo4; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Find the Code Librarian folder. If you selected the default options during setup, it should be under <b style="mso-bidi-font-weight: normal">\Program Files\Microsoft Office\Visio11\SDK\Samples\Code Librarian\</b>.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l4 level1 lfo4; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Copy the file <b style="mso-bidi-font-weight: normal">AnchorBarForm.resx</b>.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l4 level1 lfo4; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Paste it to the Anchor Bars Usage VB.NET solution folder. There should be one there already from step #6, but replace it with the copy from steps #8 and #9.<o:p></o:p></span></li>
</ol>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt 0.25in"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">Now, we are ready to use the sample. When we first created our Windows Application project, a default Windows Form was added. It should still be named <b style="mso-bidi-font-weight: normal">Form1.vb</b>. Let’s add a button to it to call our code sample:<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt 0.25in"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<ol style="MARGIN-TOP: 0in" type="1">
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l1 level1 lfo6; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">In Visual Studio .NET, open <b style="mso-bidi-font-weight: normal">Form1.vb</b> in design mode. <o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l1 level1 lfo6; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Add a <b style="mso-bidi-font-weight: normal">Button </b>control to the form.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l1 level1 lfo6; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Double click on the <b style="mso-bidi-font-weight: normal">Button1</b> to add a click event handler.<o:p></o:p></span></li>
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l1 level1 lfo6; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">We need to use some namespaces. Add the following statements to the top of the code file:<o:p></o:p></span></li>
</ol>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt 0.25in"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt 0.25in; TEXT-INDENT: 0.25in; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">Imports</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> Visio = Microsoft.Office.Interop.Visio<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt 0.5in"><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">Imports</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> Microsoft.Samples.Visio.VBNet</span><span style="FONT-FAMILY: Verdana"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<ol style="MARGIN-TOP: 0in" type="1" start="5">
<li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l1 level1 lfo6; tab-stops: list .5in"><span style="FONT-FAMILY: Verdana">Then, add the following code to the <b style="mso-bidi-font-weight: normal">Button1_Click</b> procedure to demo the sample code:<o:p></o:p></span></li>
</ol>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt 0.25in"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt 0.25in; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">&nbsp;&nbsp; </span><span style="COLOR: blue">Dim</span> visioApp = <span style="COLOR: blue">New</span> Visio.Application<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt 0.5in"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">DemoAnchorBar(visioApp)<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">Finally, we are ready to run our sample project. Go ahead and compile and run the project (F5). The Windows Form with the button control should display. When you click on this button, Visio should start. When it does, an anchor bar window should be collapsed towards the bottom of Visio. Hover over it to make it expand. It is populated with a list of shape names. Try dragging-and-dropping one of these items to the page. Voila!<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">This is a fairly complex sample and you should definitely step through the DemoAnchorBar function to learn how you add an anchor bar window to Visio. You should also step through the code when a drag occurs from the list view control.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">We had to jump over some hurdles to set up the project. This sample in particular had some extra steps because it required a resource file. However, I hope you understand how you can take code straight from the Code Librarian and use it in your Visio development projects.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana">-Chris<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p>&nbsp;<span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Trebuchet MS'">This posting is provide “AS IS” with no warranties, and confers no rights. </span></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-FAMILY: Verdana"><o:p><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Trebuchet MS'"></span></o:p></span>&nbsp;</p>
	</div><!-- .entry-content -->
<hr>

</article><!-- #post-## -->
</div><!-- #single-content -->
</div><!-- #primary -->
<!-- Before Navigation --></main><!-- #site-main -->

<a class=""""screen-reader-shortcut"""" href=""""#primary"""" tabindex=""""1""""></a> 

<div id=""secondary"" class=""sidebar col-sm-3"">
	<div id=""sidebar-widget-area"" class=""sidebar-widget-area"" role=""complementary"">
		<div class=""widget sfmsb_widget"">

		</div>
		<aside id="tag_cloud-2" class="widget widget_tag_cloud">
</aside>
<aside id="msdn-archive-widget-2" class="widget msdn-archive-widget"><h2 class="widget-title">Archives</h2>	
	<li><a href='..\..\..\years\2007\index.htm'>All of 2007</a>&nbsp;(1)</li>
	<li><a href='..\..\..\years\2006\index.htm'>All of 2006</a>&nbsp;(1)</li>
	<li><a href='..\..\..\years\2005\index.htm'>All of 2005</a>&nbsp;(4)</li>
	<li><a href='..\..\..\years\2004\index.htm'>All of 2004</a>&nbsp;(6)</li>

</aside>
</div><!-- #secondary -->
</div><!-- .site-content -->
</div>

<footer id="site-footer" class="site-footer row" role="contentinfo">
	<div id="site-info" class="site-info">
		<div id="footer-text" class="col-sm-4 col-sm-offset-6">
			<span>
				<a href="https://privacy.microsoft.com" data-mscc-ic="false">Privacy</a>
			</span>
			<span>
				<a href="https://msdn.microsoft.com/cc300389" data-mscc-ic="false">Terms of Use</a>
			</span>
			<span>
				<a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-mscc-ic="false">Trademarks</a>
			</span>
		</div>
		<div id="footer-far" class="col-sm-2">
			<div id="footer-microsoft-logo">
				<a href="https://www.microsoft.com" aria-label="Microsoft Logo">
					<svg id="footer-microsoft-logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 347 70.5" enable-background="new 0 0 347 70.5"><g fill="#fff"><path d="M39.5 44.6l-2.8 7.9h-.2c-.5-1.8-1.3-4.5-2.7-7.8l-15-37.7h-14.7v60h9.7v-37c0-2.3 0-5-.1-8.2-.1-1.6-.2-2.9-.3-3.8h.2c.5 2.3 1 4 1.4 5.1l18 43.8h6.8l17.9-44.2c.4-1 .8-3 1.2-4.7h.2c-.2 4.4-.4 8.4-.5 10.8v38.1h10.4v-60h-14.1l-15.4 37.7zM78.8 23.9h10.1v43h-10.1zM83.9 5.7c-1.7 0-3.1.6-4.3 1.7-1.2 1.1-1.8 2.5-1.8 4.2 0 1.6.6 3 1.8 4.1 1.2 1.1 2.6 1.6 4.3 1.6 1.7 0 3.2-.6 4.3-1.6 1.2-1.1 1.8-2.5 1.8-4.1 0-1.6-.6-3-1.8-4.2-1-1.2-2.5-1.7-4.3-1.7M124.7 23.5c-1.9-.4-3.8-.6-5.7-.6-4.6 0-8.8 1-12.3 3s-6.3 4.8-8.1 8.3c-1.9 3.6-2.8 7.7-2.8 12.4 0 4.1.9 7.8 2.7 11.1 1.8 3.3 4.3 5.9 7.6 7.7 3.2 1.8 6.9 2.7 11.1 2.7 4.8 0 8.9-1 12.2-2.9l.1-.1v-9.3l-.4.3c-1.5 1.1-3.2 2-4.9 2.6-1.8.6-3.4.9-4.8.9-4 0-7.2-1.2-9.5-3.7s-3.5-5.9-3.5-10.2c0-4.4 1.2-7.9 3.6-10.5 2.4-2.6 5.6-3.9 9.5-3.9 3.3 0 6.6 1.1 9.6 3.3l.4.3v-9.8l-.1-.1c-1.2-.6-2.8-1.1-4.7-1.5M158 23.2c-2.5 0-4.8.8-6.8 2.4-1.7 1.4-2.9 3.4-3.9 5.8h-.1v-7.4h-10.1v43h10.1v-22c0-3.7.8-6.8 2.5-9.1s3.9-3.5 6.5-3.5c.9 0 1.9.2 3 .4 1.1.3 1.9.6 2.4 1l.4.3v-10.2l-.2-.1c-.8-.4-2.1-.6-3.8-.6M185.5 22.9c-7.1 0-12.7 2.1-16.7 6.2s-6 9.8-6 16.9c0 6.7 2 12.1 5.9 16.1 3.9 3.9 9.2 5.9 15.8 5.9 6.9 0 12.4-2.1 16.4-6.3 4-4.2 6-9.8 6-16.7 0-6.8-1.9-12.3-5.7-16.2-3.7-3.9-9-5.9-15.7-5.9m8 33.1c-1.9 2.4-4.8 3.6-8.5 3.6s-6.6-1.2-8.7-3.7c-2.1-2.4-3.1-5.9-3.1-10.3 0-4.6 1.1-8.1 3.1-10.6 2.1-2.5 5-3.7 8.6-3.7 3.6 0 6.4 1.2 8.4 3.6 2 2.4 3.1 5.9 3.1 10.5s-1 8.2-2.9 10.6M229.3 41.7c-3.2-1.3-5.2-2.3-6.1-3.2-.8-.8-1.2-1.9-1.2-3.3 0-1.2.5-2.3 1.6-3.1 1.1-.8 2.5-1.2 4.4-1.2 1.7 0 3.5.3 5.2.8 1.7.5 3.3 1.2 4.5 2.1l.4.3v-9.4l-.2-.1c-1.2-.5-2.7-.9-4.6-1.3-1.9-.3-3.6-.5-5-.5-4.8 0-8.8 1.2-11.9 3.7-3.1 2.4-4.6 5.7-4.6 9.5 0 2 .3 3.8 1 5.3s1.7 2.9 3.1 4c1.4 1.1 3.4 2.3 6.2 3.5 2.3 1 4.1 1.8 5.2 2.4 1.1.6 1.8 1.3 2.3 1.9.4.6.6 1.4.6 2.4 0 2.9-2.2 4.3-6.6 4.3-1.7 0-3.5-.3-5.6-1-2.1-.7-4-1.7-5.7-2.9l-.4-.3v9.9l.2.1c1.5.7 3.3 1.2 5.4 1.7 2.2.4 4.1.7 5.8.7 5.2 0 9.5-1.2 12.5-3.7 3.1-2.5 4.7-5.7 4.7-9.8 0-2.9-.8-5.4-2.5-7.4-1.8-2-4.7-3.8-8.7-5.4M267.6 22.9c-7.1 0-12.7 2.1-16.7 6.2s-6 9.8-6 16.9c0 6.7 2 12.1 5.9 16.1 3.9 3.9 9.2 5.9 15.8 5.9 6.9 0 12.4-2.1 16.4-6.3 4-4.2 6-9.8 6-16.7 0-6.8-1.9-12.3-5.7-16.2-3.8-3.9-9.1-5.9-15.7-5.9m8 33.1c-1.9 2.4-4.8 3.6-8.5 3.6s-6.6-1.2-8.7-3.7c-2.1-2.4-3.1-5.9-3.1-10.3 0-4.6 1.1-8.1 3.1-10.6 2.1-2.5 5-3.7 8.6-3.7 3.5 0 6.4 1.2 8.4 3.6 2 2.4 3.1 5.9 3.1 10.5s-1 8.2-2.9 10.6"/><path d="M342.9 32.2v-8.2h-10.2v-12.9l-.3.1-9.6 2.9-.2.1v9.7h-15.2v-5.4c0-2.5.6-4.4 1.7-5.7 1.1-1.3 2.7-1.9 4.7-1.9 1.4 0 2.9.3 4.5 1l.4.2v-8.7l-.2-.1c-1.4-.5-3.3-.8-5.7-.8-3 0-5.7.7-8.1 1.9-2.4 1.3-4.2 3.1-5.5 5.5-1.3 2.3-2 5-2 8v6h-7.2v8.2h7.1v34.8h10.2v-34.7h15.2v22.1c0 9.1 4.3 13.7 12.8 13.7 1.4 0 2.9-.2 4.3-.5 1.5-.3 2.6-.7 3.2-1l.1-.1v-8.3l-.4.3c-.6.4-1.2.7-2.1.9-.8.2-1.5.3-2 .3-2 0-3.4-.5-4.4-1.6-.9-1.1-1.4-2.9-1.4-5.5v-20.3h10.3z"/></g></svg>
				</a>
			</div>
			<div id="copyright">
				© 2011 - 2018 Microsoft
			</div>
		</div>
	</div><!-- .site-info -->
</footer><!-- .site-footer -->

</div><!-- .site -->

</body>
</html>