<!DOCTYPE html>
<html lang="en-US">
<head>
              <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.5/css/bootstrap.min.css">
<title>Creating Visio Add-ins with VSTO 2005 SE &#8211; Chris Castillo&#039;s WebLog</title>
<link rel='dns-prefetch' href='//ajax.aspnetcdn.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='stylesheet' id='wds-ratings-css'  href='https://blogs.msdn.microsoft.com/wp-content/plugins/wds-ratings/wds-ratings.css?ver=20161014' type='text/css' media='all' />
<link rel='stylesheet' id='microsoft-parent-style-css'  href='https://blogs.msdn.microsoft.com/wp-content/themes/microsoft/style.css?ver=02092017' type='text/css' media='all' />
<link rel='stylesheet' id='microsoft-child-style-css'  href='https://blogs.msdn.microsoft.com/wp-content/themes/microsoft-msdn/style.css?ver=04152016' type='text/css' media='all' />
	<div id='msccBanner' dir='ltr' data-site-name='uhf-TechNetBlogs' data-mscc-version='0.4.0' data-nver='aspnet-2.0.7' data-sver='0.1.2' class='cc-banner' role='alert'>
<link rel=""shortcut icon"" href=""https://i1.social.s-msft.com/Forums/GlobalResources/images/Technet/favicon.ico"">

<link rel="canonical" href="https://blogs.msdn.microsoft.com/chcast/2007/03/28/creating-visio-add-ins-with-vsto-2005-se/" />
<!-- og:title -->
<meta property="og:title" content="Creating Visio Add-ins with VSTO 2005 SE" />
<!-- og:description -->
<meta property="og:description" content="Introduction On November 2006, Microsoft released Visual Studio 2005 Tools for the 2007 Office System, also known as VSTO 2005 SE (Second Edition). Developers have long been able to create custom add-ins for Visio. With VSTO 2005 SE, developers are now able to create VSTO add-ins for Visio. You might be wondering, “Why should I..." />
</head>
<body class="post-template-default single single-post postid-23 single-format-standard">
<div id="page" class="site container-fluid">
	<header id="site-header" class="site-header row" role="banner">
		<div id="site-header-global-wrapper" class="site-header-global-wrapper">
			<div id="site-header-global" class="site-header-global">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#site-profile-menu" aria-label="toggle menu" tabindex="0" aria-expanded="false">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<div id="site-logo" class="col-sm-5 row navbar-header">
					<div id="header-microsoft-logo">
						<a id="home-link" href="https://www.microsoft.com/" tabindex="1" aria-label="Microsoft logo">
							<img id="header-microsoft-logo-svg" src="https://blogs.msdn.microsoft.com/visio/wp-content/themes/microsoft/images/ms-logo-gray.svg" alt="Microsoft logo">
							<span id="brand">
								<span id="brand-separator">|</span>
								<span id="brand-name"></span>
							</span>
						</a>
					</div>
				</div>
				<div id="site-header-global-right" class="col-sm-7">
				</div>
			</div>

		</div>
		<div id="site-header-blog-wrapper" class="site-header-blog-wrapper ms-blog-header clear-both">
			<div id="site-header-blog" class="site-header-blog">
				<nav class="navbar navbar-inverse">
					<div id="blog-logo-area" class="navbar-header">
						<div id="blog-logo" data-toggle="collapse" data-target="#blog-menu" tabindex="0" aria-label="blog logo">
														<div id="blog-logo-text">
<h1 class="site-title ms-blog-title">
					<a href="https://blogs.msdn.microsoft.com/chcast" class="for-desktop">
						Chris Castillo&#039;s WebLog					</a>
					<a href="https://blogs.msdn.microsoft.com/chcast" class="for-mobile">
						Chris Castillo&#039;s WebLog					</a>
				</h1>
<!-- blog description -->
<p class="site-description ms-blog-description">Visio Solution Development</p>
			</div>
									</div>
					</div>
									</nav>
			</div>
			
		</div>
		<div id="site-content" class="site-content row">

	<div id="primary" class="content-area col-sm-9">
	<main id="site-main" class="site-main" role="main">
		<div id="single-content" class="div-content">
<!-- Post start -->
<article id="post-23" class="post-23 post type-post status-publish format-standard hentry category-uncategorized">
	<header class="entry-header">
<h1 class="entry-title">Creating Visio Add-ins with VSTO 2005 SE</h1>
<div class="entry-meta">
<span class="byline"><span class="author vcard"><a class="url fn n profile-usercard-hover" data-profile-userid="" href="https://blogs.msdn.microsoft.com/chcast/author/msdnarchive/">MSDN Archive</a></span>
</span><span class="posted-on posted-on-margin">
			<span class="screen-reader-text"></span>
<time class="entry-date published updated" datetime="2007-03-28T17:45:00+00:00">March 28, 2007</time>
			</span>
		</div>
		<hr>
	</header><!-- .entry-header -->
<div class="entry-content single">
		<p><H1 style="MARGIN: 24pt 0in 0pt"><FONT face=Cambria color=#365f91 size=5>Introduction</FONT></H1><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>On November 2006, Microsoft released Visual Studio 2005 Tools for the 2007 Office System, also known as VSTO 2005 SE (Second Edition). Developers have long been able to create custom add-ins for Visio. With VSTO 2005 SE, developers are now able to create VSTO add-ins for Visio. </FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>You might be wondering, “Why should I care about VSTO 2005 SE when I have already been able to create custom add-ins for Visio?”</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>Here’s why. VSTO 2005 SE allows you to create secure add-ins for Visio. When you create a VSTO add-in, you can isolate your add-in from unexpected crashes of other add-ins. You can digitally sign your VSTO add-in. This allows your add-in to run when an administrator turns on the “Require Application Add-ins to be signed by Trusted Publisher” setting. Finally, VSTO add-ins operate under the .NET Code Access Security model. Your VSTO add-in has to be granted Full Trust in order to be loaded by Visio.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>In this blog entry, I am going to: </FONT></P><br />
<P class=MsoListParagraphCxSpFirst style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l6 level1 lfo1"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Overview of the different Visio solution options</FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l6 level1 lfo1"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Recap the problem with Shared Add-ins</FONT></P><br />
<P class=MsoListParagraphCxSpLast style="MARGIN: 0in 0in 10pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l6 level1 lfo1"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Walkthrough on creating and deploying VSTO add-in for Visio</FONT></P><br />
<H1 style="MARGIN: 24pt 0in 0pt"><FONT face=Cambria color=#365f91 size=5>Overview of Visio Solution Options</FONT></H1><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>Simply put, there are many ways to create a Visio solution. The following list briefly describes each of the options, in the order they were first made available:</FONT></P><br />
<P class=MsoListParagraphCxSpFirst style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l14 level1 lfo2"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT size=3><FONT face=Calibri><B style="mso-bidi-font-weight: normal">VSL add-ons: </B>VSL’s (ViSio Libraries) were first made available with Visio 2.0. In fact, many of the out-of-the-box Visio solutions, such as the Organization Chart, are implemented as a VSL add-on. You create VSL add-ons using C or C++. The emphasis of this Visio solution option is sheer speed.</FONT></FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l14 level1 lfo2"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT size=3><FONT face=Calibri><B style="mso-bidi-font-weight: normal">EXE add-ons: </B>EXE add-ons were also first made available with Visio 2.0. They are simply standalone executables that can be launched from Visio and can be created with virtually any programming language. EXE add-ons run in a separate process space as Visio, so you should avoid this option if your solution needs to access the Visio Automation Library a lot.<B style="mso-bidi-font-weight: normal"><?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></B></FONT></FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l14 level1 lfo2"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT size=3><FONT face=Calibri><B style="mso-bidi-font-weight: normal">VBA</B>: Before Microsoft acquired Visio Corporation, Visio was probably one of the first non-Microsoft products to support Visual Basic for Applications (or VBA). VBA solutions are document-centric, meaning that code is embedded within the Visio drawing file. I like to use VBA for quick prototypes, especially with the Macro Recorder.<B style="mso-bidi-font-weight: normal"><o:p></o:p></B></FONT></FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l14 level1 lfo2"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT size=3><FONT face=Calibri><B style="mso-bidi-font-weight: normal">COM add</B>-<B style="mso-bidi-font-weight: normal">ins: </B>While VBA macros run at the document level, COM add-ins run at the Visio application level. They are created using unmanaged environments like Visual Basic 6.0, or unmanaged C++.<B style="mso-bidi-font-weight: normal"><o:p></o:p></B></FONT></FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l14 level1 lfo2"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT size=3><FONT face=Calibri><B style="mso-bidi-font-weight: normal">Shared add-ins: </B>Shared add-ins are application-level solutions created using .NET languages like VB.NET and C#. They are typically created using the Shared Add-in wizard, or by using the “Visio add-in or add-on” wizard that comes with the Visio SDK. They still fundamentally use COM to extend Visio, but using managed code.<B style="mso-bidi-font-weight: normal"><o:p></o:p></B></FONT></FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l14 level1 lfo2"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT size=3><FONT face=Calibri><B style="mso-bidi-font-weight: normal">Visio Drawing Control: </B>The Visio Drawing Control is an ActiveX component that lets you put your own chrome around Visio. You can embed the Visio Drawing Control in your Windows Forms or browser-based applications. It is essentially a wrapper around the Visio engine itself. You need to have Visio installed on the client machine.<B style="mso-bidi-font-weight: normal"><o:p></o:p></B></FONT></FONT></P><br />
<P class=MsoListParagraphCxSpLast style="MARGIN: 0in 0in 10pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l14 level1 lfo2"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT size=3><FONT face=Calibri><B style="mso-bidi-font-weight: normal">VSTO add-ins</B>: VSTO add-ins are also managed code add-ins that run at the Visio application level, but require the VSTO runtime. The VSTO runtime includes a dedicated add-in loader that provides AppDomain isolation. VSTO add-ins must be granted full-trust on the target machine. The emphasis here is security.<B style="mso-bidi-font-weight: normal"><o:p></o:p></B></FONT></FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>For more information on VSL add-ons and EXE add-ons, please refer to </FONT><A href="http://msdn2.microsoft.com/en-gb/library/aa168138(office.11).aspx" mce_href="http://msdn2.microsoft.com/en-gb/library/aa168138(office.11).aspx"><FONT face=Calibri color=#0000ff size=3>About Microsoft Office Visio Add-ons and COM Add-ins</FONT></A><FONT face=Calibri size=3>.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>For more information on the Visio Drawing Control, please refer to </FONT><A href="http://msdn2.microsoft.com/en-gb/library/aa168480(office.11).aspx" mce_href="http://msdn2.microsoft.com/en-gb/library/aa168480(office.11).aspx"><FONT face=Calibri color=#0000ff size=3>Programming with the Microsoft Office Visio 2003 ActiveX Control</FONT></A><FONT face=Calibri size=3> and </FONT><A href="http://msdn.microsoft.com/msdnmag/issues/03/12/Visio2003/default.aspx" mce_href="http://msdn.microsoft.com/msdnmag/issues/03/12/Visio2003/default.aspx"><FONT face=Calibri color=#0000ff size=3>Host an Interactive Visio Drawing Surface in .NET Custom Clients</FONT></A><FONT face=Calibri size=3>.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>Since Visio 2002, Visio solution developers have had a helpful Visio software development kit (SDK), which provides code samples, sample applications, tools, and documentation. The Visio SDK includes the “Visio add-in or add-on” wizard, that shows up as an additional project type for VB.NET, C#, and C++ in Visual Studio. The add-ins you create with this “Visio add-in or add-on” wizard is identical to the ones you create using the Shared Add-in wizard. <SPAN style="mso-spacerun: yes">&nbsp;</SPAN>The difference is that the “Visio add-in or add-on” wizard allows you to create add-ons. For VB.NET and C#, you can create EXE add-ons. For C++ you also can create VSL add-ons.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>The </FONT><A href="http://www.microsoft.com/downloads/details.aspx?FamilyID=373D34B8-5EF7-4E6E-A582-C8D6B5EE4E33&amp;displaylang=en" mce_href="http://www.microsoft.com/downloads/details.aspx?FamilyID=373D34B8-5EF7-4E6E-A582-C8D6B5EE4E33&amp;displaylang=en"><FONT face=Calibri size=3>Visio 2007 SDK</FONT></A><FONT face=Calibri size=3> has been updated with more code samples and documentation that highlight the new Data Link and Data Graphics capabilities in Visio 2007. For more information, please go to the </FONT><A href="http://msdn2.microsoft.com/en-us/office/aa905478.aspx" mce_href="http://msdn2.microsoft.com/en-us/office/aa905478.aspx"><FONT face=Calibri color=#0000ff size=3>Visio Developer Portal</FONT></A><FONT face=Calibri size=3>.</FONT></P><br />
<H1 style="MARGIN: 24pt 0in 0pt"><FONT face=Cambria color=#365f91 size=5>Recap of the Problems of Shared Add-ins</FONT></H1><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>Shared add-ins are not all that bad. If your add-in needs to work in multiple Office applications (e.g. Visio, Excel, and Word), you need to create a Shared add-in. VSTO add-ins are specific to their Office host. Also, if your add-in needs to work when multiple versions of Office applications are installed on the same machine, you will have better luck with a Shared add-in (although this is not recommended). Microsoft does not support VSTO development in the scenario where different versions of the same Office application are installed on the same machine.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>VSTO add-ins address several problems that Shared add-ins have. Here I will shamelessly copy and paste from a couple of other blogs and articles that already do a great job describing the problems of Shared add-ins.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>Brian A. Randall describes three problems with Shared add-ins in </FONT><A href="http://msdn2.microsoft.com/en-us/library/aa663367.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/aa663367.aspx"><FONT face=Calibri color=#0000ff size=3>Migrating a Shared Add-in to a Visual Studio Tools for Office Add-In</FONT></A><FONT face=Calibri size=3>:</FONT></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 0.5in; TEXT-ALIGN: justify"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'">Mscoree.dll is the main entry DLL to the goodness that is the common language runtime (CLR). To ensure that the CLR is correctly loaded into a host application before your shared add-in, mscoree.dll is listed in the registry as the in-process server to load, not your managed assembly. This creates a few problems. <o:p></o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 0.5in; TEXT-ALIGN: justify"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'"><o:p>&nbsp;</o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 0.5in; TEXT-ALIGN: justify"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'">The first problem is that if your shared add-in (or some other one) causes an unhandled exception and crashes the host, the host will provide the user with an opportunity to stop the add-in from loading the next time. If the user chooses this option, the host lists the add-in as disabled. The problem is that the host application cannot distinguish between one shared add-in and another. It will ban mscoree.dll and thus all shared managed add-ins from the host.<o:p></o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 0.5in; TEXT-ALIGN: justify"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'"><o:p>&nbsp;</o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 0.5in; TEXT-ALIGN: justify"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'">The second problem is that when the CLR is initialized, it creates a default application domain and all shared add-ins loaded by the host are put into the same application domain. The problem with this is that one add-in can cause another add-in to fail. For example, one add-in could call <B>ReleaseComObject</B> on an object that both add-ins are using. This could happen in a case where there are two add-ins loaded into Excel, ExcelAddinOne and ExcelAddinTwo. By default, the two add-ins are put into the same default application domain. One of them is aggressive about memory management, say ExcelAddinTwo, and it calls <B>FinalReleaseComObject</B> on the Excel.Application reference that both add-ins are holding a reference to via a shared runtime callable wrapper (RCW). When ExcelAddinOne tries to access its reference to Excel it is a System.AccessViolationException: Attempted to read or write protected memory.<o:p></o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 0.5in; TEXT-ALIGN: justify"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'"><o:p>&nbsp;</o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 0.5in; TEXT-ALIGN: justify"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'">The third problem is an issue of trust. While most Office applications (in Office 2003, for example) trust add-ins out of the box (Publisher 2003 being an exception), it is possible for a security-minded user or administrator to disallow unsigned add-ins (those that don not have a valid X.509 signature). If this is done, your shared add-in will not work—even if you do sign it. Why? Once again it is mscoree.dll. Your Office application is looking to see if mscoree.dll is signed, not your managed assembly.<o:p></o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 0.5in"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'"><o:p>&nbsp;</o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>You can avoid these problems associated with Shared add-ins by creating a custom COM shim. A COM shim is essentially an unmanaged DLL that creates a separate AppDomain for your managed Shared add-in to run. You can then digitally sign your custom COM shim. </FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>COM shims aren’t without problems either, as Andrew Whitechapel points out in </FONT><A href="http://msdn2.microsoft.com/en-us/library/aa537182(office.11).aspx" mce_href="http://msdn2.microsoft.com/en-us/library/aa537182(office.11).aspx"><FONT face=Calibri color=#0000ff size=3>Architecture of the Outlook Add-in Support in Visual Studio 2005 Tools for Office</FONT></A><FONT face=Calibri size=3>. Although the article was written for Outlook Add-in Support (VSTO 2005 “First Edition”), many of the points in this article still apply to VSTO 2005 SE:</FONT></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 0.5in; TEXT-ALIGN: justify"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'">You can download a Visual Studio COM Shim Wizard and project set from Microsoft, which enables you to build an unmanaged shim for managed add-ins. This approach solves some of the problems of a managed add-in that does not include a shim, but some issues remain: <o:p></o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 0.5in; TEXT-ALIGN: justify"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'"><o:p>&nbsp;</o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 1in; TEXT-INDENT: -0.25in; TEXT-ALIGN: justify; mso-list: l17 level1 lfo3"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore">·<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'">This approach is unsupported by Microsoft.<o:p></o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 1in; TEXT-INDENT: -0.25in; TEXT-ALIGN: justify; mso-list: l17 level1 lfo3"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore">·<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'">This approach requires you to deploy an unmanaged shim component, plus one or more managed components with different installation requirements. This can be confusing for administrators (and developers) to maintain.<o:p></o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 1in; TEXT-INDENT: -0.25in; TEXT-ALIGN: justify; mso-list: l17 level1 lfo3"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore">·<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'">The (wizard-generated) shim is written in C++, a development language with which managed add-in developers are not always familiar.<o:p></o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 1in; TEXT-INDENT: -0.25in; TEXT-ALIGN: justify; mso-list: l17 level1 lfo3"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore">·<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'">With this model, each add-in requires an associated shim DLL, even though more than 99 percent of the code is identical across all such shims.<o:p></o:p></SPAN></P><br />
<P class=MsoNoSpacing style="MARGIN: 0in 0in 0pt 1in"><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'"><o:p>&nbsp;</o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>VSTO 2005 SE overcomes these issues by providing a supported, codesigned, single VSTO add-in loader.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>For more information on the COM Shim Wizard, please see Andrew Whitechapel’s blog entry titled, </FONT><A href="http://blogs.msdn.com/andreww/archive/2006/06/09/624596.aspx" mce_href="http://blogs.msdn.com/andreww/archive/2006/06/09/624596.aspx"><FONT face=Calibri color=#0000ff size=3>COM Shim Wizards v2</FONT></A><FONT face=Calibri size=3>. It’s worth pointing out again from the early quote regarding the COM Shim Wizard, “This approach is unsupported by Microsoft.”</FONT></P><br />
<H1 style="MARGIN: 24pt 0in 0pt"><FONT face=Cambria color=#365f91 size=5>Creating a VSTO add-in for Visio 2007</FONT></H1><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>Creating a VSTO add-in project for Visio is really simple. After you </FONT><A href="http://www.microsoft.com/downloads/details.aspx?familyid=5E86CAB3-6FD6-4955-B979-E1676DB6B3CB&amp;displaylang=en" mce_href="http://www.microsoft.com/downloads/details.aspx?familyid=5E86CAB3-6FD6-4955-B979-E1676DB6B3CB&amp;displaylang=en"><FONT face=Calibri color=#0000ff size=3>download and install the Visual Studio 2005 Tools for the 2007 Office System</FONT></A><FONT face=Calibri size=3>, you will get several new project templates in Visual Studio. Under your preferred programming language, let’s say Visual Basic, expand Office, and then 2007 Add-ins. There you will find a project template to create a Visio Add-in.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt; TEXT-ALIGN: center" align=center><SPAN style="mso-no-proof: yes"><?xml:namespace prefix = v ns = "urn:schemas-microsoft-com:vml" /><v:shapetype id=_x0000_t75 stroked="f" filled="f" path="m@4@5l@4@11@9@11@9@5xe" o:preferrelative="t" o:spt="75" coordsize="21600,21600"><v:stroke joinstyle="miter"></v:stroke><v:formulas><v:f eqn="if lineDrawn pixelLineWidth 0"></v:f><v:f eqn="sum @0 1 0"></v:f><v:f eqn="sum 0 0 @1"></v:f><v:f eqn="prod @2 1 2"></v:f><v:f eqn="prod @3 21600 pixelWidth"></v:f><v:f eqn="prod @3 21600 pixelHeight"></v:f><v:f eqn="sum @0 0 1"></v:f><v:f eqn="prod @6 1 2"></v:f><v:f eqn="prod @7 21600 pixelWidth"></v:f><v:f eqn="sum @8 21600 0"></v:f><v:f eqn="prod @7 21600 pixelHeight"></v:f><v:f eqn="sum @10 21600 0"></v:f></v:formulas><v:path o:connecttype="rect" gradientshapeok="t" o:extrusionok="f"></v:path><o:lock aspectratio="t" v:ext="edit"></o:lock></v:shapetype><v:shape id=_x0000_i1034 style="VISIBILITY: visible; WIDTH: 334.8pt; HEIGHT: 261pt; mso-wrap-style: square" type="#_x0000_t75"><v:imagedata o:title="" src="C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image001.png" mce_src="C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image001.png"><FONT face=Calibri size=3></FONT></v:imagedata></v:shape></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>Here are the steps to follow to create your first VSTO add-in for Visio 2007:</FONT></P><br />
<P class=MsoListParagraphCxSpFirst style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l15 level1 lfo4"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>1.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Start Visual Studio 2005. Click <B style="mso-bidi-font-weight: normal">Create Project</B>.</FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l15 level1 lfo4"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>2.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Under <B style="mso-bidi-font-weight: normal">Visual Basic | Office | 2007 Add-ins</B>, and then select <B style="mso-bidi-font-weight: normal">Visio Add-in</B>.</FONT></P><br />
<P class=MsoListParagraphCxSpLast style="MARGIN: 0in 0in 10pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l15 level1 lfo4"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>3.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Type <B style="mso-bidi-font-weight: normal">MyVisioVSTOAddin </B>for the name of the project. Click OK.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>Visual Studio will then create a new project for a VSTO add-in that can be loaded in Visio 2007. The project will have all the required references, including the Visio 2007 Primary Interop Assembly. The debug settings of the project will be set so that when you press F5 to debug, Visio starts up. A class named ThisAddIn will also be defined automatically for you. This class replaces the Connect class that you may have been familiar with in a Shared Add-in. Finally, Visual Studio will create a new setup project for your add-in <I style="mso-bidi-font-style: normal">to get you started</I>. (Emphasis on the “to get you started”-- you need to do more to actually get it to deploy your add-in on a test machine.)</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>ThisAddIn is an improvement from the Connect class. Instead of the four methods you had to implement with IDTExensibility interface, ThisAddIn requires two: Startup and Shutdown. ThisAddIn also takes advantage of the partial class feature introduces with Visual Studio 2005. The VSTO add-in project template adds ThisAddIn.Designer.vb, a partial class that contains generated code to support VSTO add-in functionality. Tip: If you are using Visual Basic, you might need to click the “Show All Files” option under the Project menu to see ThisAddIn.Designer.vb.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>By default the partial class defined in ThisAddIn.Designer.vb declares the Visio Application object using WithEvents:</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 0.5in"><SPAN style="FONT-SIZE: 8pt; COLOR: blue; LINE-HEIGHT: 115%; FONT-FAMILY: 'Courier New'; mso-no-proof: yes">Friend</SPAN><SPAN style="FONT-SIZE: 8pt; LINE-HEIGHT: 115%; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"> <SPAN style="COLOR: blue">WithEvents</SPAN> Application <SPAN style="COLOR: blue">As</SPAN> Microsoft.Office.Interop.Visio.Application</SPAN><SPAN style="FONT-SIZE: 8pt; LINE-HEIGHT: 115%"><o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>I strongly recommend that you remove the WithEvents keyword. As you may know, Visio has two event handling models. The first is by using the WithEvents keyword, the second is by using the </FONT><A href="http://msdn2.microsoft.com/en-us/library/ms367505.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/ms367505.aspx"><FONT face=Calibri color=#0000ff size=3>AddAdvise method</FONT></A><FONT face=Calibri size=3>. When you use AddAdvise, Visio will raise an event for the events that you specify. When you use WithEvents, Visio will raise all events, even though you may not have an event handlers defined for all events. I recommend that you always use AddAdvise when creating Visio solutions because Visio won’t have to raise events for events you don’t care about.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>For now, let’s display a simple “Hello, world!” message box when Visio starts up.</FONT></P><br />
<P class=MsoListParagraphCxSpFirst style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l15 level1 lfo4"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>4.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Add the following code to the ThisAdd_Startup procedure:</FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in"><SPAN style="FONT-SIZE: 8pt; LINE-HEIGHT: 115%; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><o:p>&nbsp;</o:p></SPAN></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in"><SPAN style="FONT-SIZE: 8pt; LINE-HEIGHT: 115%; FONT-FAMILY: 'Courier New'; mso-no-proof: yes">System.Windows.Forms.MessageBox.Show(<SPAN style="COLOR: #a31515">"Hello, world!"</SPAN>)<o:p></o:p></SPAN></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in"><SPAN style="FONT-SIZE: 8pt; LINE-HEIGHT: 115%; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><o:p>&nbsp;</o:p></SPAN></P><br />
<P class=MsoListParagraphCxSpLast style="MARGIN: 0in 0in 10pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l15 level1 lfo4"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>5.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Compile and run.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>When you run the code, Visio should start up and display “Hello, world!” in a message box.</FONT></P><br />
<H1 style="MARGIN: 24pt 0in 0pt"><FONT face=Cambria color=#365f91 size=5>Deployment</FONT></H1><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>Now here’s where it starts to get pretty tricky. In order for your add-in to work on a non-development machine, you have to make sure that the following steps are taken:</FONT></P><br />
<P class=MsoListParagraphCxSpFirst style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l19 level1 lfo5"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>1.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Install .NET 2.0 Framework</FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l19 level1 lfo5"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>2.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Install VSTO SE Runtime</FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l19 level1 lfo5"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>3.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Install Visio 2007 Primary Interop Assembly</FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l19 level1 lfo5"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>4.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Add required add-in registry settings</FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l19 level1 lfo5"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>5.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Copy add-in assembly. </FONT></P><br />
<P class=MsoListParagraphCxSpMiddle style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l19 level1 lfo5"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>6.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Copy any Visio templates and stencils</FONT></P><br />
<P class=MsoListParagraphCxSpLast style="MARGIN: 0in 0in 10pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l19 level1 lfo5"><SPAN style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin"><SPAN style="mso-list: Ignore"><FONT face=Calibri size=3>7.</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><FONT face=Calibri size=3>Grant full trust to add-in</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>The Setup project that is created for you by the VSTO SE add-in project template only takes care of steps 1, 4 and 5. Step 6, adding Visio templates and stencils is very easy. You just have to right-click on the setup project in Solution Explorer, and then click <B style="mso-bidi-font-weight: normal">Add | File</B>. </FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>To do steps 2, 3, and 7, you need to customize the setup project. Fortunately, there are two great MSDN articles that show you how to do these customizations:</FONT></P><br />
<P class=MsoListParagraphCxSpFirst style="MARGIN: 0in 0in 0pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l9 level1 lfo6"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><A href="http://msdn2.microsoft.com/en-us/library/bb332051.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/bb332051.aspx"><FONT face=Calibri size=3>Deploying Visual Studio 2005 Tools for Office Second Edition Solutions Using Windows Installer (Part 1 of 2)</FONT></A></P><br />
<P class=MsoListParagraphCxSpLast style="MARGIN: 0in 0in 10pt 0.5in; TEXT-INDENT: -0.25in; mso-list: l9 level1 lfo6"><SPAN style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN style="mso-list: Ignore"><FONT size=3>·</FONT><SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><A href="http://msdn2.microsoft.com/en-us/library/bb332052.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/bb332052.aspx"><FONT face=Calibri color=#0000ff size=3>Deploying Visual Studio 2005 Tools for Office Second Edition Solutions Using Windows Installer: Walkthroughs (Part 2 of 2)</FONT></A></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>In the next few sections, I will copy and paste excerpts from the above two articles, including and editing what is relevant for Visio 2007 solution development. However, I strongly recommend that you take the time to read the above two articles in its entirety.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>The first step is to install the accompanying download of the above two articles: </FONT><A href="http://go.microsoft.com/fwlink/?linkid=83721" mce_href="http://go.microsoft.com/fwlink/?linkid=83721"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; FONT-FAMILY: 'Verdana','sans-serif'"><FONT color=#0000ff>OfficeVSTO2005SEWindowsInstaller.msi</FONT></SPAN></A><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; FONT-FAMILY: 'Verdana','sans-serif'">. This download contains custom setup bootstrapper packages for the VSTO 2005 SE runtime and Office 2007 PIA’s. It also contains the required custom action project to grant full trust to your add-in assembly.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; FONT-FAMILY: 'Verdana','sans-serif'">After you install the accompanying download, follow the steps below from </SPAN><A href="http://msdn2.microsoft.com/en-us/library/bb332051.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/bb332051.aspx"><FONT face=Calibri size=3>Deploying Visual Studio 2005 Tools for Office Second Edition Solutions Using Windows Installer (Part 1 of 2)</FONT></A><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; FONT-FAMILY: 'Verdana','sans-serif'">. The default location of the {SamplesDir} token below is “C:\Program Files\Microsoft Visual Studio 2005 Tools for Office SE Resources\VSTO2005SE Windows Installer Sample”:<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria>Adding the Visual Studio Tools for Office Packages to the Bootstrapper<o:p></o:p></FONT></FONT></SPAN></H3><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">The following instructions describe how to add the packages listed above to the bootstrapper package directory. These changes need be made only once and only on your development computer.<o:p></o:p></SPAN></P><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">This task shows how to use the files that are available in the Windows Installer download that accompanies this article. To use them, prepare the files before you copy them into the bootstrapper package directory.<o:p></o:p></SPAN></P><br />
<H4 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><EM><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">Preparing the Runtime</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></EM></H4><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria>To prepare the VSTO 2005 SE runtime bootstrapper package<o:p></o:p></FONT></FONT></SPAN></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l18 level1 lfo7; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Download </SPAN><A href="http://go.microsoft.com/fwlink/?linkid=49612" mce_href="http://go.microsoft.com/fwlink/?linkid=49612"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><FONT color=#0000ff>Microsoft Visual Studio 2005 Tools for Office Second Edition runtime</FONT></SPAN></A><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"> from the Microsoft Download Center.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l18 level1 lfo7; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Copy vstor.exe into the {SamplesDir}\packages\VSTOSERuntime directory.<o:p></o:p></SPAN></P><br />
<H4 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><EM><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">Preparing the Visual Studio Tools for Office Language Pack Bootstrapper Package</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></EM></H4><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">If any users run your solutions with non–English settings for Windows, they must have the Visual Studio Tools for Office Language Pack to see runtime messages in the same language as Windows.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To prepare the Visual Studio Tools for Office Language Pack</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l1 level1 lfo8; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Download the </SPAN><A href="http://go.microsoft.com/fwlink/?linkid=56602" mce_href="http://go.microsoft.com/fwlink/?linkid=56602"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><FONT color=#0000ff>Microsoft Visual Studio 2005 Tools for the Microsoft Office System (VSTO2005) Language Package</FONT></SPAN></A><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"> from the Microsoft Download Center.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l1 level1 lfo8; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Copy the file vstolp20.exe into the directory {SamplesDir}\packages\VSTOLP.<o:p></o:p></SPAN></P><br />
<H4 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><EM><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">Preparing the Office Component Check</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></EM></H4><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Compile the Office component checker sample for the primary interop assemblies redistributable packages.<o:p></o:p></SPAN></P><br />
<TABLE class=MsoNormalTable style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; MARGIN: auto auto auto 0.5in; BORDER-LEFT: medium none; WIDTH: 100%; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-border-alt: solid #DDDDDD .5pt; mso-yfti-tbllook: 1184" cellSpacing=0 cellPadding=0 width="100%" border=1 class="MsoNormalTable"><br />
<TBODY><br />
<TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #dddddd 1pt solid; PADDING-LEFT: 3pt; BACKGROUND: #cccccc; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt" vAlign=bottom><br />
<P class=MsoNormal style="MARGIN: 6pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; mso-no-proof: yes"><v:shape id=Picture_x0020_1 style="VISIBILITY: visible; WIDTH: 7.8pt; HEIGHT: 7.8pt; mso-wrap-style: square" type="#_x0000_t75" alt="Note" o:spid="_x0000_i1033"><v:imagedata o:title="Note" src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif" mce_src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif"></v:imagedata></v:shape></SPAN></B><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Important: <o:p></o:p></FONT></SPAN></B></P></TD></TR><br />
<TR style="mso-yfti-irow: 1"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #f0f0f0; PADDING-LEFT: 3pt; BACKGROUND: white; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt; mso-border-top-alt: solid #DDDDDD .5pt" vAlign=top><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>If you are using VSTO 2005 SE in conjunction with VSTO 2005, ensure that you have installed both the .NET Framework 2.0 software development kit (SDK) and the Windows SDK.<o:p></o:p></FONT></SPAN></P></TD></TR><br />
<TR style="mso-yfti-irow: 2"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #f0f0f0; PADDING-LEFT: 3pt; BACKGROUND: #cccccc; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt; mso-border-top-alt: solid #DDDDDD .5pt" vAlign=bottom><br />
<P class=MsoNormal style="MARGIN: 6pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; mso-no-proof: yes"><v:shape id=Picture_x0020_2 style="VISIBILITY: visible; WIDTH: 7.8pt; HEIGHT: 7.8pt; mso-wrap-style: square" type="#_x0000_t75" alt="Note" o:spid="_x0000_i1032"><v:imagedata o:title="Note" src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif" mce_src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif"><FONT face=Calibri></FONT></v:imagedata></v:shape></SPAN></B><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Note: <o:p></o:p></FONT></SPAN></B></P></TD></TR><br />
<TR style="mso-yfti-irow: 3; mso-yfti-lastrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #f0f0f0; PADDING-LEFT: 3pt; BACKGROUND: white; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt; mso-border-top-alt: solid #DDDDDD .5pt" vAlign=top><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>By default, Visual Studio Tools for Office does not install the .NET Framework 2.0 SDK. You can download it or install it from the installation media by using the <B>Add or Remove</B>&nbsp;<B>Programs</B> command in Visual Studio Tools for Office. In addition, you need to download a copy of the </FONT></SPAN><A href="http://go.microsoft.com/fwlink/?linkid=84451" mce_href="http://go.microsoft.com/fwlink/?linkid=84451"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri color=#0000ff>Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components</FONT></SPAN></A><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri> from the Microsoft Download Center. You can also download a copy of the </FONT></SPAN><A href="http://www.microsoft.com/downloads/details.aspx?familyid=fe6f2099-b7b4-4f47-a244-c96d69c35dec&amp;displaylang=en" mce_href="http://www.microsoft.com/downloads/details.aspx?familyid=fe6f2099-b7b4-4f47-a244-c96d69c35dec&amp;displaylang=en"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri color=#0000ff>.NET Framework 2.0 Software Development Kit (SDK) (x86)</FONT></SPAN></A><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri> from the Microsoft Download Center.<o:p></o:p></FONT></SPAN></P></TD></TR></TBODY></TABLE><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="DISPLAY: none; FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-hide: all"><o:p>&nbsp;</o:p></SPAN></P><br />
<TABLE class=MsoNormalTable style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; MARGIN: auto auto auto 0.5in; BORDER-LEFT: medium none; WIDTH: 100%; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-border-alt: solid #DDDDDD .5pt; mso-yfti-tbllook: 1184" cellSpacing=0 cellPadding=0 width="100%" border=1 class="MsoNormalTable"><br />
<TBODY><br />
<TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #dddddd 1pt solid; PADDING-LEFT: 3pt; BACKGROUND: #cccccc; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt" vAlign=bottom><br />
<P class=MsoNormal style="MARGIN: 6pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; mso-no-proof: yes"><v:shape id=_x0000_i1031 style="VISIBILITY: visible; WIDTH: 7.8pt; HEIGHT: 7.8pt; mso-wrap-style: square" type="#_x0000_t75" alt="Note"><v:imagedata o:title="Note" src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif" mce_src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif"></v:imagedata></v:shape></SPAN></B><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Note: <o:p></o:p></FONT></SPAN></B></P></TD></TR><br />
<TR style="mso-yfti-irow: 1; mso-yfti-lastrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #f0f0f0; PADDING-LEFT: 3pt; BACKGROUND: white; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt; mso-border-top-alt: solid #DDDDDD .5pt" vAlign=top><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>These downloads are not required if you are using a version of Visual Studio with Visual C++ installed.<o:p></o:p></FONT></SPAN></P></TD></TR></TBODY></TABLE><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To prepare the Office component check</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l10 level1 lfo9; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Open the Command Prompt window needed to compile the check.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">If you are using Visual Studio 2005 Professional, Team Suite, or one of the role-based Team editions, open the Visual Studio 2005 Command Prompt window by clicking <B>Start</B>, and then pointing to <B>Programs</B>, pointing to <B>Microsoft Visual Studio 2005</B>, pointing to <B>Visual Studio Tools</B>, and then clicking <B>Visual Studio 2005 Command Prompt</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">If you are using Visual Studio Tools for Office, run <B>CMD Shell</B> by clicking <B>Start</B>, pointing to <B>Programs</B>, pointing to <B>Microsoft Windows SDK</B>, and then clicking <B>CMD Shell</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">[If you are running on Vista, you should right-click and Run as administrator.]<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l10 level1 lfo9; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">At the command prompt, change the directory to {SamplesDir}\projects\Checks<o:p></o:p></SPAN></P><br />
<TABLE class=MsoNormalTable style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; MARGIN: auto auto auto 60pt; BORDER-LEFT: medium none; WIDTH: 100%; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-border-alt: solid #DDDDDD .5pt; mso-yfti-tbllook: 1184" cellSpacing=0 cellPadding=0 width="100%" border=1 class="MsoNormalTable"><br />
<TBODY><br />
<TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #dddddd 1pt solid; PADDING-LEFT: 3pt; BACKGROUND: #cccccc; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt" vAlign=bottom><br />
<P class=MsoNormal style="MARGIN: 6pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; mso-no-proof: yes"><v:shape id=Picture_x0020_4 style="VISIBILITY: visible; WIDTH: 7.8pt; HEIGHT: 7.8pt; mso-wrap-style: square" type="#_x0000_t75" alt="Note" o:spid="_x0000_i1030"><v:imagedata o:title="Note" src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif" mce_src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif"></v:imagedata></v:shape></SPAN></B><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Tip: <o:p></o:p></FONT></SPAN></B></P></TD></TR><br />
<TR style="mso-yfti-irow: 1; mso-yfti-lastrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #f0f0f0; PADDING-LEFT: 3pt; BACKGROUND: white; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt; mso-border-top-alt: solid #DDDDDD .5pt" vAlign=top><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>By default, the SamplesDir directory is C:\Program Files\Microsoft Visual Studio 2005 Tools for Office SE Resources\VSTO2005SE Windows Installer Sample.<o:p></o:p></FONT></SPAN></P></TD></TR></TBODY></TABLE><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l10 level1 lfo9; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Compile the component checker by typing the following command. <o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="BACKGROUND: #dddddd; MARGIN: 0in 6pt 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt"><SPAN style="FONT-SIZE: 10pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Lucida Console'; mso-bidi-font-family: 'Courier New'">cl.exe /Oxs /MT /GS ComponentCheck.cpp advapi32.lib<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l10 level1 lfo9; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">4.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Close the Command Prompt window.</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-bidi-font-family: 'Times New Roman'"><o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l10 level1 lfo9; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">5.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Using Windows Explorer, copy the executable file ComponentCheck.exe into {SamplesDir}\packages\Office2003PIA and {SamplesDir}\packages\Office2007PIA.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p>&nbsp;</o:p></SPAN></P><br />
<H4 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%"><EM><FONT color=#4f81bd><FONT face=Cambria>Preparing for the 2007 Release of Office<o:p></o:p></FONT></FONT></EM></SPAN></H4><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">You must include the primary interop assemblies for 2007 in the corresponding bootstrapper package if your solution will run in the 2007 release of Office, including VSTO 2005 Excel and Word document solutions.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To prepare the primary interop assemblies bootstrapper package</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l11 level1 lfo10; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Download the </SPAN><A href="http://www.microsoft.com/downloads/details.aspx?familyid=59daebaa-bed4-4282-a28c-b864d8bfa513" mce_href="http://www.microsoft.com/downloads/details.aspx?familyid=59daebaa-bed4-4282-a28c-b864d8bfa513"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><FONT color=#0000ff>2007 Microsoft Office System Update: Redistributable Primary Interop Assemblies</FONT></SPAN></A><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"> from the Microsoft Download Center.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l11 level1 lfo10; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Run the primary interop assembly installer.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l11 level1 lfo10; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Accept the Microsoft Software License Terms, which gives you the right to package the primary interop assemblies as part of your installer.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l11 level1 lfo10; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">4.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In Windows Explorer, open the folder to which the installer extracted the files.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l11 level1 lfo10; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">5.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Copy O2007PIA.msi into the directory {SamplesDir}\packages\Office2007PIA.<o:p></o:p></SPAN></P><br />
<TABLE class=MsoNormalTable style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; MARGIN: auto auto auto 60pt; BORDER-LEFT: medium none; WIDTH: 100%; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-border-alt: solid #DDDDDD .5pt; mso-yfti-tbllook: 1184" cellSpacing=0 cellPadding=0 width="100%" border=1 class="MsoNormalTable"><br />
<TBODY><br />
<TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #dddddd 1pt solid; PADDING-LEFT: 3pt; BACKGROUND: #cccccc; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt" vAlign=bottom><br />
<P class=MsoNormal style="MARGIN: 6pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; mso-no-proof: yes"><v:shape id=Picture_x0020_11 style="VISIBILITY: visible; WIDTH: 7.8pt; HEIGHT: 7.8pt; mso-wrap-style: square" type="#_x0000_t75" alt="Note" o:spid="_x0000_i1029"><v:imagedata o:title="Note" src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif" mce_src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif"></v:imagedata></v:shape></SPAN></B><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Note: <o:p></o:p></FONT></SPAN></B></P></TD></TR><br />
<TR style="mso-yfti-irow: 1; mso-yfti-lastrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #f0f0f0; PADDING-LEFT: 3pt; BACKGROUND: white; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt; mso-border-top-alt: solid #DDDDDD .5pt" vAlign=top><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Because you cannot directly download the redistributable package, you must always include it with your Windows Installer. If you set the prerequisite installation location to the Web, you are warned that this particular package must be included when you build the Setup project, as shown here:<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%">WARNING: No 'HomeSite' attribute has been provided for '2007 Microsoft Office Primary Interop Assemblies', so the package will be published to the same location as the bootstrapper.</SPAN></B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"> <o:p></o:p></SPAN></FONT></P></TD></TR></TBODY></TABLE><br />
<H1 style="MARGIN: 24pt 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#365f91><FONT face=Cambria><SPAN style="FONT-SIZE: 9.5pt; LINE-HEIGHT: 140%">Copying the Packages into the Bootstrapper Directory</SPAN><SPAN style="FONT-SIZE: 9.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H1><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Now that you have prepared the prerequisites, copy them into the bootstrapper package directory.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To copy the packages into the bootstrapper</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l16 level1 lfo11; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Determine where your bootstrapper package directory is located.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In Visual Studio Tools for Office, the default directory is here:<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">C:\Program Files\Microsoft.NET\SDK\v2.0\BootStrapper\Packages\<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In Visual Studio 2005 Professional, Team Suite, or one of the role-based Team editions, the default directory is here:<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\BootStrapper\Packages<o:p></o:p></SPAN></P><br />
<TABLE class=MsoNormalTable style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; MARGIN: auto auto auto 60pt; BORDER-LEFT: medium none; WIDTH: 100%; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-border-alt: solid #DDDDDD .5pt; mso-yfti-tbllook: 1184" cellSpacing=0 cellPadding=0 width="100%" border=1 class="MsoNormalTable"><br />
<TBODY><br />
<TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #dddddd 1pt solid; PADDING-LEFT: 3pt; BACKGROUND: #cccccc; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt" vAlign=bottom><br />
<P class=MsoNormal style="MARGIN: 6pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; mso-no-proof: yes"><v:shape id=Picture_x0020_12 style="VISIBILITY: visible; WIDTH: 7.8pt; HEIGHT: 7.8pt; mso-wrap-style: square" type="#_x0000_t75" alt="Note" o:spid="_x0000_i1028"><v:imagedata o:title="Note" src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif" mce_src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif"></v:imagedata></v:shape></SPAN></B><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Tip: <o:p></o:p></FONT></SPAN></B></P></TD></TR><br />
<TR style="mso-yfti-irow: 1; mso-yfti-lastrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #f0f0f0; PADDING-LEFT: 3pt; BACKGROUND: white; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt; mso-border-top-alt: solid #DDDDDD .5pt" vAlign=top><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>If in doubt, you can determine the location by appending \bootstrapper\packages to the value of this registry key: \HKLM\SOFTWARE\Microsoft\.NETFramework\sdkInstallRootv2.0<o:p></o:p></FONT></SPAN></P></TD></TR></TBODY></TABLE><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l16 level1 lfo11; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Copy the contents of the directory {SamplesDir}\packages into the bootstrapper directory.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><o:p><FONT face=Calibri size=3>&nbsp;</FONT></o:p></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>The next set of steps is to be completed for each of your VSTO add-in projects for Visio. Let’s do these steps for our MyVisioVSTOAddin project. The excerpt below is from </FONT><A href="http://msdn2.microsoft.com/en-us/library/bb332052.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/bb332052.aspx"><FONT face=Calibri color=#0000ff size=3>Deploying Visual Studio 2005 Tools for Office Second Edition Solutions Using Windows Installer: Walkthroughs (Part 2 of 2)</FONT></A><FONT face=Calibri size=3> with my revisions:</FONT></P><br />
<H1 style="MARGIN: 24pt 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 9.5pt; LINE-HEIGHT: 140%"><FONT color=#365f91><FONT face=Cambria>Walkthrough: Enhancing the Visio Add-in Setup Project<o:p></o:p></FONT></FONT></SPAN></H1><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">This section describes how to enhance the Setup project that Visual Studio defines when you create an Outlook add-in project. It explains how to perform the following steps:<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 6pt 3pt 48pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l3 level1 lfo12; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 10pt; LINE-HEIGHT: 140%; FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol; mso-bidi-font-size: 8.5pt"><SPAN style="mso-list: Ignore">·<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Modify the Setup project so that it installs the prerequisites: the VSTO 2005 SE runtime and, optionally, the Visual Studio 2005 Tools for Office Language Pack.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 6pt 3pt 48pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l3 level1 lfo12; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 10pt; LINE-HEIGHT: 140%; FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol; mso-bidi-font-size: 8.5pt"><SPAN style="mso-list: Ignore">·<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Add a step to the Setup project to grant security trust to the customization assembly.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 6pt 3pt 48pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l3 level1 lfo12; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 10pt; LINE-HEIGHT: 140%; FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol; mso-bidi-font-size: 8.5pt"><SPAN style="mso-list: Ignore">·<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Add launch conditions to the Windows Installer (.msi) file to prevent installation if the prerequisites are not installed.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">Signing the Assembly</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Later in this article, you will grant trust to the customization assembly based upon a strong name and its location. However, you must first sign the assembly.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To sign the assembly</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l22 level1 lfo13; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In <B>Solution Explorer</B>, right-click <B style="mso-bidi-font-weight: normal">MyVisioVSTOAddin</B>, and then click <B>Properties</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l22 level1 lfo13; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Click the <B>Signing</B> tab.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l22 level1 lfo13; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Select the <B>Sign the assembly</B> check box.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l22 level1 lfo13; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">4.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Choose a strong name key file</B> list, click <B>&lt;New. . .&gt;</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l22 level1 lfo13; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">5.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Type the name <B style="mso-bidi-font-weight: normal">MyVisioVSTOAddin</B> in the <B>Key file name</B> box.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l22 level1 lfo13; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">6.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Type a password in the <B>Enter password</B> and <B>Confirm password</B> boxes.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l22 level1 lfo13; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">7.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Click <B>OK</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l22 level1 lfo13; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">8.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Close the <B>Properties</B> pages.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p>&nbsp;</o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">Adding the Prerequisites to the Setup Project</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Add the prerequisites that the bootstrapper will install. A later step addresses adding launch conditions.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To add the prerequisites</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l21 level1 lfo14; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In <B>Solution Explorer</B>, right-click <B style="mso-bidi-font-weight: normal">MyVisioVSTOAddinSetup</B>, and then click <B>Properties</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l21 level1 lfo14; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Property Pages</B> dialog box, click <B>Prerequisites</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l21 level1 lfo14; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the list of prerequisites, select the following items:<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 84pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l21 level2 lfo14; tab-stops: list 1.5in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">a.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">2007 Microsoft Office Primary Interop Assemblies<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 84pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l21 level2 lfo14; tab-stops: list 1.5in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">b.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Microsoft Visual Studio 2005 Tools for Office SE Runtime<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l21 level1 lfo14; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">4.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Select <B>Microsoft Visual Studio 2005 Tools for Office Runtime Language Pack</B> if any users run your solutions with non–English settings for Windows. These users must have the Visual Studio 2005 Tools for Office Language Pack to see runtime messages in the same language as Windows.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l21 level1 lfo14; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">5.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Click <B>OK</B> twice.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">Adding a Custom Action to Grant Trust to the Assembly</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Grant trust to the customization assembly using the supplied custom action sample.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To add the supplied project</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l5 level1 lfo15; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Using Windows Explorer, copy the <B>SetSecurity</B> project from the {SamplesDir}\projects directory to the directory that contains the OutlookAddin solution.<o:p></o:p></SPAN></P><br />
<TABLE class=MsoNormalTable style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; MARGIN: auto auto auto 60pt; BORDER-LEFT: medium none; WIDTH: 100%; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-border-alt: solid #DDDDDD .5pt; mso-yfti-tbllook: 1184" cellSpacing=0 cellPadding=0 width="100%" border=1 class="MsoNormalTable"><br />
<TBODY><br />
<TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #dddddd 1pt solid; PADDING-LEFT: 3pt; BACKGROUND: #cccccc; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt" vAlign=bottom><br />
<P class=MsoNormal style="MARGIN: 6pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; mso-no-proof: yes"><v:shape id=Picture_x0020_3 style="VISIBILITY: visible; WIDTH: 7.8pt; HEIGHT: 7.8pt; mso-wrap-style: square" type="#_x0000_t75" alt="Note" o:spid="_x0000_i1027"><v:imagedata o:title="Note" src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif" mce_src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif"></v:imagedata></v:shape></SPAN></B><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Tip: <o:p></o:p></FONT></SPAN></B></P></TD></TR><br />
<TR style="mso-yfti-irow: 1; mso-yfti-lastrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #f0f0f0; PADDING-LEFT: 3pt; BACKGROUND: white; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt; mso-border-top-alt: solid #DDDDDD .5pt" vAlign=top><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>By default, the {SamplesDir} directory is C:\Program Files\Microsoft Visual Studio 2005 Tools for Office SE Resources\VSTO2005SE Windows Installer Sample<o:p></o:p></FONT></SPAN></P></TD></TR></TBODY></TABLE><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l5 level1 lfo15; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In <B>Solution Explorer</B>, right-click <B style="mso-bidi-font-weight: normal">MyVisioVSTOAddin</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l5 level1 lfo15; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Point to <B>Add</B> on the shortcut menu, and then click <B>Existing Project</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l5 level1 lfo15; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">4.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Select the <B>SetSecurity</B> project.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l5 level1 lfo15; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">5.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Click <B>OK</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l5 level1 lfo15; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">6.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In <B>Solution Explorer</B>, right-click the <B>SetSecurity</B> project, and then click <B>Build</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">[If you are running on Vista, you should copy the setup project to a folder outside of the Program Files tree.]<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To add the primary output of the custom action project to the Setup project</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l20 level1 lfo16; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In <B>Solution Explorer</B>, right-click <B style="mso-bidi-font-weight: normal">MyVisioVSTOAddinSetup</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l20 level1 lfo16; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Point to <B>View</B> on the shortcut menu, and then click <B>Custom Actions</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l20 level1 lfo16; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the Custom Actions editor, right-click <B>Custom Actions</B>, and then click <B>Add Custom Action</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l20 level1 lfo16; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">4.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Look In</B> list, click <B>Application Folder</B>, and then click <B>Add Output</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">The <B>Add Project Output Group</B> dialog box opens.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l20 level1 lfo16; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">5.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Project</B> list, click <B>SetSecurity</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l20 level1 lfo16; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">6.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Select <B>Primary output</B> from the list of output types, and then click <B>OK</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l20 level1 lfo16; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">7.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Verify that <B>Primary output from SetSecurity (Active)</B> is added to the list of primary outputs for the Setup project.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">This enables the Windows Installer file to run the custom action that edits the application manifest.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To add the custom action data for the Install method</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l4 level1 lfo17; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the Custom Actions editor, expand <B>Install</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l4 level1 lfo17; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Right-click <B>Primary output from SetSecurity (Active)</B>, and then click <B>Properties Window</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l4 level1 lfo17; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Properties</B> window, set the <B>CustomActionData</B> property to the following string. Enter this as one long string, and change <I>MyCompanyName</I> to your company name. <o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="BACKGROUND: #dddddd; MARGIN: 0in 6pt 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt"><SPAN style="FONT-SIZE: 10pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Lucida Console'; mso-bidi-font-family: 'Courier New'">/assemblyName="MyVisioVSTOAddin.dll" /targetDir="[TARGETDIR]\" /solutionCodeGroupName="MyCompanyName.MyVisioVSTOAddin" /solutionCodeGroupDescription="Code group for MyVisioVSTOAddin" /assemblyCodeGroupName="MyVisioVSTOAddin" /assemblyCodeGroupDescription="Code group for MyVisioVSTOAddin" /allUsers=[ALLUSERS]<o:p></o:p></SPAN></P><br />
<TABLE class=MsoNormalTable style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; MARGIN: auto auto auto 0.5in; BORDER-LEFT: medium none; WIDTH: 100%; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-border-alt: solid #DDDDDD .5pt; mso-yfti-tbllook: 1184" cellSpacing=0 cellPadding=0 width="100%" border=1 class="MsoNormalTable"><br />
<TBODY><br />
<TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #dddddd 1pt solid; PADDING-LEFT: 3pt; BACKGROUND: #cccccc; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt" vAlign=bottom><br />
<P class=MsoNormal style="MARGIN: 6pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; mso-no-proof: yes"><v:shape id=Picture_x0020_5 style="VISIBILITY: visible; WIDTH: 7.8pt; HEIGHT: 7.8pt; mso-wrap-style: square" type="#_x0000_t75" alt="Note" o:spid="_x0000_i1026"><v:imagedata o:title="Note" src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif" mce_src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif"></v:imagedata></v:shape></SPAN></B><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Tip: <o:p></o:p></FONT></SPAN></B></P></TD></TR><br />
<TR style="mso-yfti-irow: 1; mso-yfti-lastrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #f0f0f0; PADDING-LEFT: 3pt; BACKGROUND: white; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt; mso-border-top-alt: solid #DDDDDD .5pt" vAlign=top><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>You do not need to add extra quotation marks if your company name contains a space.<o:p></o:p></FONT></SPAN></P></TD></TR></TBODY></TABLE><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To add the custom action data for the Rollback method</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-bidi-font-family: 'Times New Roman'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l8 level1 lfo18; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the Custom Actions editor, expand <B>Rollback</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l8 level1 lfo18; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Right-click <B>Primary output from SetSecurity (Active)</B>, and then click <B>Properties Window</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l8 level1 lfo18; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Properties</B> window, set the <B>CustomActionData</B> property to the following string: <o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="BACKGROUND: #dddddd; MARGIN: 0in 6pt 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt"><SPAN style="FONT-SIZE: 10pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Lucida Console'; mso-bidi-font-family: 'Courier New'">/solutionCodeGroupName="MyCompanyName.MyVisioVSTOAddin"<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To add the custom action data for the Uninstall method</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-bidi-font-family: 'Times New Roman'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l7 level1 lfo19; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the Custom Actions editor, expand <B>Uninstall</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l7 level1 lfo19; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Right-click <B>Primary output from SetSecurity (Active)</B>, and then click <B>Properties Window</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l7 level1 lfo19; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Properties</B> window, set the <B>CustomActionData</B> property to the following string: <o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="BACKGROUND: #dddddd; MARGIN: 0in 6pt 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt"><SPAN style="FONT-SIZE: 10pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Lucida Console'; mso-bidi-font-family: 'Courier New'">/solutionCodeGroupName="MyCompanyName.MyVisioVSTOAddin"<o:p></o:p></SPAN></P><br />
<TABLE class=MsoNormalTable style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; MARGIN: auto auto auto 0.5in; BORDER-LEFT: medium none; WIDTH: 100%; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-border-alt: solid #DDDDDD .5pt; mso-yfti-tbllook: 1184" cellSpacing=0 cellPadding=0 width="100%" border=1 class="MsoNormalTable"><br />
<TBODY><br />
<TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #dddddd 1pt solid; PADDING-LEFT: 3pt; BACKGROUND: #cccccc; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt" vAlign=bottom><br />
<P class=MsoNormal style="MARGIN: 6pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%; mso-no-proof: yes"><v:shape id=Picture_x0020_8 style="VISIBILITY: visible; WIDTH: 7.8pt; HEIGHT: 7.8pt; mso-wrap-style: square" type="#_x0000_t75" alt="Note" o:spid="_x0000_i1025"><v:imagedata o:title="Note" src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif" mce_src="file:///C:\Users\chcast\AppData\Local\Temp\msohtmlclip1\01\clip_image002.gif"></v:imagedata></v:shape></SPAN></B><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Note: <o:p></o:p></FONT></SPAN></B></P></TD></TR><br />
<TR style="mso-yfti-irow: 1; mso-yfti-lastrow: yes"><br />
<TD class="" style="BORDER-RIGHT: #dddddd 1pt solid; PADDING-RIGHT: 3pt; BORDER-TOP: #f0f0f0; PADDING-LEFT: 3pt; BACKGROUND: white; PADDING-BOTTOM: 3pt; BORDER-LEFT: #dddddd 1pt solid; PADDING-TOP: 3pt; BORDER-BOTTOM: #dddddd 1pt solid; mso-border-alt: solid #DDDDDD .5pt; mso-border-top-alt: solid #DDDDDD .5pt" vAlign=top><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 115%"><FONT face=Calibri>Although you did not override the <B>Commit</B> method with a custom action, the base Windows Installer class provides an implementation. Thus, you must still call the method. However, it does not require any custom action data.<o:p></o:p></FONT></SPAN></P></TD></TR></TBODY></TABLE><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">Adding Launch Conditions to the Windows Installer File</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-bidi-font-family: 'Times New Roman'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">When the user runs Setup.exe, the Windows Installer checks for the prerequisites, and installs them if necessary. Alternatively, the user can double-click the .msi file to install the solution. In that case, the prerequisites are not installed and the solution cannot run. In other cases, Setup might fail because resources it needs are not present; for example, custom actions might require the .NET Framework.<o:p></o:p></SPAN></P><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">This section shows you how to use the Launch Conditions editor to add launch conditions to the .msi file to prevent installation if certain dependencies are not installed.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To view the Launch Conditions editor</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l0 level1 lfo20; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In <B>Solution Explorer</B>, right-click <B style="mso-bidi-font-weight: normal">MyVisioVSTOAddinSetup</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l0 level1 lfo20; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Point to <B>View</B> on the shortcut menu, and then click <B>Launch Conditions</B>.<o:p></o:p></SPAN></P><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Add a launch condition for the VSTO 2005 SE runtime.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To add a launch condition for the VSTO 2005 SE runtime</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the Launch Conditions editor, right-click <B>Requirements on Target Machine</B>, and then click <B>Add Registry Launch Condition</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Select the newly added search condition, <B>Search for RegistryEntry1</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Rename the search condition to <B>Search for VSTO 2005 SE Runtime</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">4.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Properties</B> window, change the value of <B>Property</B> to <B>VSTORTVERSION</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">5.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Also in the <B>Properties</B> window, set the value of <B>RegKey</B> to the following string.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="BACKGROUND: #dddddd; MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 10pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Lucida Console'; mso-bidi-font-family: 'Courier New'">Software\Microsoft\vsto runtime Setup\v2.0.50727</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">6.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Leave the <B>Root</B> property set to <B>vsdrrHKLM</B> and change the <B>Value</B> property to <B>Update</B>.</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-bidi-font-family: 'Times New Roman'"><o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">7.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Select the newly added launch condition, <B>Condition1</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">8.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Rename it to <B>Display message if the Visual Studio 2005 Tools for Office SE Runtime is not installed</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">9.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Properties</B> window, change the value of the <B>Condition</B> property to the following string.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="BACKGROUND: #dddddd; MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 10pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Lucida Console'; mso-bidi-font-family: 'Courier New'">VSTORTVERSION &gt;= "#1"</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">10.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Leave the <B>InstallURL</B> property blank.</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-bidi-font-family: 'Times New Roman'"><o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l12 level1 lfo21; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">11.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Change the value of the <B>Message</B> property to <B>The Visual Studio 2005 Tools for Office SE Runtime is not installed. Please run Setup.exe</B>.<o:p></o:p></SPAN></P><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">If any users run your solutions with non–English settings for Windows, they must have the Visual Studio 2005 Tools for Office Language Pack to see runtime messages in the same language as Windows. Add a launch condition to check for the Language Pack.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To add a launch condition for the Visual Studio 2005 Tools for Office Language Pack</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l13 level1 lfo22; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">1.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the Launch Conditions editor, right-click <B>Requirements on Target Machine</B>, and then click <B>Add Windows Installer Launch Condition</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l13 level1 lfo22; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">2.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Select the newly added search condition, <B>Search for Component1</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l13 level1 lfo22; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">3.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Rename the search condition to <B>Search for VSTO Language Pack</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l13 level1 lfo22; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">4.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Properties</B> window, in the <B>ComponentId</B> property, type the following GUID:<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt 60pt; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">{2E3A394E-C9BD-40C3-9990-BA7AF7C8B4AF}</SPAN></B><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"> <o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l13 level1 lfo22; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">5.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Change the value of <B>Property</B> to <B>COMPONENTEXISTS_VSTOLP</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l13 level1 lfo22; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">6.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Select the newly added launch condition, <B>(Condition1)</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l13 level1 lfo22; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">7.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Rename it to <B>Display message if the Visual Studio 2005 Tools for Office Language Pack is not installed</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l13 level1 lfo22; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">8.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In the <B>Properties</B> window, change the value of the <B>Condition</B> property to <B>COMPONENTEXISTS_VSTOLP</B>.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l13 level1 lfo22; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">9.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Leave the <B>InstallURL</B> property blank.<o:p></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt 60pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l13 level1 lfo22; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'; mso-fareast-font-family: Verdana; mso-bidi-font-family: Verdana"><SPAN style="mso-list: Ignore">10.<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">Change the value of the <B>Message</B> property to <B>The Visual Studio 2005 Tools for Office Language Pack is not installed. Please run Setup.exe</B>.<o:p></o:p></SPAN></P><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">When you create the launch conditions for the VSTO 2005 SE runtime and the Visual Studio 2005 Tools for Office Language Pack, you must right-click the <B>Requirements on Target Machine</B> node. This created both the search condition and the corresponding launch condition.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">Testing the Installation</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P style="MARGIN-LEFT: 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">To test your Windows Installer, run it on a computer other than your development computer, because many of the prerequisites are already installed. Remember to run the Setup.exe file to test the bootstrapper. Remember first to build your Setup project.<o:p></o:p></SPAN></P><br />
<H3 style="MARGIN: 0in 0in 0pt 0.5in; VERTICAL-ALIGN: top; LINE-HEIGHT: 140%"><FONT color=#4f81bd><FONT face=Cambria><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%">To build Setup</SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'"><o:p></o:p></SPAN></FONT></FONT></H3><br />
<P class=MsoNormal style="MARGIN: 0in 6pt 3pt 48pt; VERTICAL-ALIGN: top; TEXT-INDENT: -0.25in; LINE-HEIGHT: 140%; mso-list: l2 level1 lfo23; tab-stops: list 1.0in"><SPAN style="FONT-SIZE: 10pt; LINE-HEIGHT: 140%; FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol; mso-bidi-font-size: 8.5pt"><SPAN style="mso-list: Ignore">·<SPAN style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 8.5pt; LINE-HEIGHT: 140%; FONT-FAMILY: 'Verdana','sans-serif'">In <B>Solution Explorer</B>, right-click the <B style="mso-bidi-font-weight: normal">MyVisioVSTOAddinSetup</B> project, and then click <B>Build</B>.<o:p></o:p></SPAN></P><br />
<H1 style="MARGIN: 24pt 0in 0pt"><FONT face=Cambria color=#365f91 size=5>Conclusion</FONT></H1><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3>As you can see, there are some extra steps that you have to complete in order to deploy a VSTO 2005 SE add-in for Visio. Shared add-ins are more straightforward when it comes to deployment. However, the payoff of using a VSTO 2005 SE to create Visio add-ins is significant. You will be able to digitally sign your assembly and take advantage of the VSTO add-in loader.</FONT></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 10pt"><FONT face=Calibri size=3></FONT>&nbsp;</P><br />
<P minmax_bound="true"><FONT face=Verdana minmax_bound="true">--Chris</FONT></P><br />
<P class=MsoNormal minmax_bound="true"><SPAN minmax_bound="true"><O:P minmax_bound="true">&nbsp;<SPAN minmax_bound="true">This posting is provide “AS IS” with no warranties, and confers no rights. </SPAN></O:P></SPAN></P></p>
	</div><!-- .entry-content -->
<hr>

</article><!-- #post-## -->
</div><!-- #single-content -->
</div><!-- #primary -->
<!-- Before Navigation --></main><!-- #site-main -->

<a class=""""screen-reader-shortcut"""" href=""""#primary"""" tabindex=""""1""""></a> 

<div id=""secondary"" class=""sidebar col-sm-3"">
	<div id=""sidebar-widget-area"" class=""sidebar-widget-area"" role=""complementary"">
		<div class=""widget sfmsb_widget"">

		</div>
		<aside id="tag_cloud-2" class="widget widget_tag_cloud">
</aside>
<aside id="msdn-archive-widget-2" class="widget msdn-archive-widget"><h2 class="widget-title">Archives</h2>	
	<li><a href='..\..\..\years\2007\index.htm'>All of 2007</a>&nbsp;(1)</li>
	<li><a href='..\..\..\years\2006\index.htm'>All of 2006</a>&nbsp;(1)</li>
	<li><a href='..\..\..\years\2005\index.htm'>All of 2005</a>&nbsp;(4)</li>
	<li><a href='..\..\..\years\2004\index.htm'>All of 2004</a>&nbsp;(6)</li>

</aside>
</div><!-- #secondary -->
</div><!-- .site-content -->
</div>

<footer id="site-footer" class="site-footer row" role="contentinfo">
	<div id="site-info" class="site-info">
		<div id="footer-text" class="col-sm-4 col-sm-offset-6">
			<span>
				<a href="https://privacy.microsoft.com" data-mscc-ic="false">Privacy</a>
			</span>
			<span>
				<a href="https://msdn.microsoft.com/cc300389" data-mscc-ic="false">Terms of Use</a>
			</span>
			<span>
				<a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-mscc-ic="false">Trademarks</a>
			</span>
		</div>
		<div id="footer-far" class="col-sm-2">
			<div id="footer-microsoft-logo">
				<a href="https://www.microsoft.com" aria-label="Microsoft Logo">
					<svg id="footer-microsoft-logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 347 70.5" enable-background="new 0 0 347 70.5"><g fill="#fff"><path d="M39.5 44.6l-2.8 7.9h-.2c-.5-1.8-1.3-4.5-2.7-7.8l-15-37.7h-14.7v60h9.7v-37c0-2.3 0-5-.1-8.2-.1-1.6-.2-2.9-.3-3.8h.2c.5 2.3 1 4 1.4 5.1l18 43.8h6.8l17.9-44.2c.4-1 .8-3 1.2-4.7h.2c-.2 4.4-.4 8.4-.5 10.8v38.1h10.4v-60h-14.1l-15.4 37.7zM78.8 23.9h10.1v43h-10.1zM83.9 5.7c-1.7 0-3.1.6-4.3 1.7-1.2 1.1-1.8 2.5-1.8 4.2 0 1.6.6 3 1.8 4.1 1.2 1.1 2.6 1.6 4.3 1.6 1.7 0 3.2-.6 4.3-1.6 1.2-1.1 1.8-2.5 1.8-4.1 0-1.6-.6-3-1.8-4.2-1-1.2-2.5-1.7-4.3-1.7M124.7 23.5c-1.9-.4-3.8-.6-5.7-.6-4.6 0-8.8 1-12.3 3s-6.3 4.8-8.1 8.3c-1.9 3.6-2.8 7.7-2.8 12.4 0 4.1.9 7.8 2.7 11.1 1.8 3.3 4.3 5.9 7.6 7.7 3.2 1.8 6.9 2.7 11.1 2.7 4.8 0 8.9-1 12.2-2.9l.1-.1v-9.3l-.4.3c-1.5 1.1-3.2 2-4.9 2.6-1.8.6-3.4.9-4.8.9-4 0-7.2-1.2-9.5-3.7s-3.5-5.9-3.5-10.2c0-4.4 1.2-7.9 3.6-10.5 2.4-2.6 5.6-3.9 9.5-3.9 3.3 0 6.6 1.1 9.6 3.3l.4.3v-9.8l-.1-.1c-1.2-.6-2.8-1.1-4.7-1.5M158 23.2c-2.5 0-4.8.8-6.8 2.4-1.7 1.4-2.9 3.4-3.9 5.8h-.1v-7.4h-10.1v43h10.1v-22c0-3.7.8-6.8 2.5-9.1s3.9-3.5 6.5-3.5c.9 0 1.9.2 3 .4 1.1.3 1.9.6 2.4 1l.4.3v-10.2l-.2-.1c-.8-.4-2.1-.6-3.8-.6M185.5 22.9c-7.1 0-12.7 2.1-16.7 6.2s-6 9.8-6 16.9c0 6.7 2 12.1 5.9 16.1 3.9 3.9 9.2 5.9 15.8 5.9 6.9 0 12.4-2.1 16.4-6.3 4-4.2 6-9.8 6-16.7 0-6.8-1.9-12.3-5.7-16.2-3.7-3.9-9-5.9-15.7-5.9m8 33.1c-1.9 2.4-4.8 3.6-8.5 3.6s-6.6-1.2-8.7-3.7c-2.1-2.4-3.1-5.9-3.1-10.3 0-4.6 1.1-8.1 3.1-10.6 2.1-2.5 5-3.7 8.6-3.7 3.6 0 6.4 1.2 8.4 3.6 2 2.4 3.1 5.9 3.1 10.5s-1 8.2-2.9 10.6M229.3 41.7c-3.2-1.3-5.2-2.3-6.1-3.2-.8-.8-1.2-1.9-1.2-3.3 0-1.2.5-2.3 1.6-3.1 1.1-.8 2.5-1.2 4.4-1.2 1.7 0 3.5.3 5.2.8 1.7.5 3.3 1.2 4.5 2.1l.4.3v-9.4l-.2-.1c-1.2-.5-2.7-.9-4.6-1.3-1.9-.3-3.6-.5-5-.5-4.8 0-8.8 1.2-11.9 3.7-3.1 2.4-4.6 5.7-4.6 9.5 0 2 .3 3.8 1 5.3s1.7 2.9 3.1 4c1.4 1.1 3.4 2.3 6.2 3.5 2.3 1 4.1 1.8 5.2 2.4 1.1.6 1.8 1.3 2.3 1.9.4.6.6 1.4.6 2.4 0 2.9-2.2 4.3-6.6 4.3-1.7 0-3.5-.3-5.6-1-2.1-.7-4-1.7-5.7-2.9l-.4-.3v9.9l.2.1c1.5.7 3.3 1.2 5.4 1.7 2.2.4 4.1.7 5.8.7 5.2 0 9.5-1.2 12.5-3.7 3.1-2.5 4.7-5.7 4.7-9.8 0-2.9-.8-5.4-2.5-7.4-1.8-2-4.7-3.8-8.7-5.4M267.6 22.9c-7.1 0-12.7 2.1-16.7 6.2s-6 9.8-6 16.9c0 6.7 2 12.1 5.9 16.1 3.9 3.9 9.2 5.9 15.8 5.9 6.9 0 12.4-2.1 16.4-6.3 4-4.2 6-9.8 6-16.7 0-6.8-1.9-12.3-5.7-16.2-3.8-3.9-9.1-5.9-15.7-5.9m8 33.1c-1.9 2.4-4.8 3.6-8.5 3.6s-6.6-1.2-8.7-3.7c-2.1-2.4-3.1-5.9-3.1-10.3 0-4.6 1.1-8.1 3.1-10.6 2.1-2.5 5-3.7 8.6-3.7 3.5 0 6.4 1.2 8.4 3.6 2 2.4 3.1 5.9 3.1 10.5s-1 8.2-2.9 10.6"/><path d="M342.9 32.2v-8.2h-10.2v-12.9l-.3.1-9.6 2.9-.2.1v9.7h-15.2v-5.4c0-2.5.6-4.4 1.7-5.7 1.1-1.3 2.7-1.9 4.7-1.9 1.4 0 2.9.3 4.5 1l.4.2v-8.7l-.2-.1c-1.4-.5-3.3-.8-5.7-.8-3 0-5.7.7-8.1 1.9-2.4 1.3-4.2 3.1-5.5 5.5-1.3 2.3-2 5-2 8v6h-7.2v8.2h7.1v34.8h10.2v-34.7h15.2v22.1c0 9.1 4.3 13.7 12.8 13.7 1.4 0 2.9-.2 4.3-.5 1.5-.3 2.6-.7 3.2-1l.1-.1v-8.3l-.4.3c-.6.4-1.2.7-2.1.9-.8.2-1.5.3-2 .3-2 0-3.4-.5-4.4-1.6-.9-1.1-1.4-2.9-1.4-5.5v-20.3h10.3z"/></g></svg>
				</a>
			</div>
			<div id="copyright">
				© 2011 - 2018 Microsoft
			</div>
		</div>
	</div><!-- .site-info -->
</footer><!-- .site-footer -->

</div><!-- .site -->

</body>
</html>