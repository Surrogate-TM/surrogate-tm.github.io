<html>
<head>
<title>ShapeComparer - утилита для сравнения шейпов Visio</title>

<!-- "header.inc"-->
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=windows-1251" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="../vis.css">
</head>
<body bgcolor="white">
<img alt height="2" src="../spacer.gif" width="1"><BR>
<table border="0" cellpadding="20" cellspacing="0" width="100%">
<tr><td width="100%" bgcolor="FFFFFF">
<!-- end header --------------------------- -->

<h1>ShapeComparer - утилита для сравнения шейпов Visio</h1>
<p align="right"><a href="ShapeComparer.htm">en</a></p>
<table border="0" cellpadding="20" cellspacing="0" width="100%">
<tr>
<td width="20%" bgcolor="FFFFFF">
<IMG SRC="sc.jpg" WIDTH="200" HEIGHT="123" BORDER="0" ALT="">
</td>
<td width="50%" bgcolor="FFFFFF">
<p><b>ShapeComparer</b> - это утилита для разработчиков шейпов. Утилита выполняет такие
операции, как: сравнение шейпов, копирование формул шейп-листа, копирование секций.
Утилита выполнена в виде трафарета Visio, содержащего макросы.</p>
</td>
<td width="30%" bgcolor="FFFFFF">Трафарет бесплатен.<br>Размещен на сервисе Gumroad.
<br><a href="https://gum.co/EjDU">Скачать трафарет.</a><br><font size="-1">Одновременно можно сделать
пожертвование на развитие этой и других утилит в размере $2-$5.</font> 
</td>
</tr>
</table>
<hr>
<p>Возможности:</p>
<ul>
<li>сравнение двух шейпов с выводом результатов в лог;
<li>копирование отдельных формул из одного шейпа в другой;
<li>копирование секций из одного шейпа в другой;
<li>дублирование листов.
</ul>
<p>Утилита оформлена в виде трафарета, содержащего управляющие шейпы и макросы.
Для ее применения достаточно открыть трафарет и использовать команды
контекстного меню управляющих шейпов.</p>
<h3>Сравнение шейпов</h3>
<p>Для сравнения шейпов нужно соединить управляющим коннектором два шейпа и
выполнить команду <b>Compare</b>. Управляющий коннектор находится в трафарете.
Протокол сравнения выводится в текстовый файл log.log.</p>
<p>Коннектор содержит два поля, управляющих форматом протокола.</p>
<p>Поле <b>Print cell</b> names управляет выводом перечня ячеек, участвовавших в
сравнении. Если поле принимает значение True, перечень выводится
в лог перед результатами сравнения.</p>
<p>Поле <b>Print both</b> formulas управляет форматом вывода результатов сравнения.
Если поле имеет значение True, сравниваемые ячейки выводятся рядом (в две колонки).
Если поле имеет значение False, сначала выводятся все ячейки одного шейпа, затем другого.</p>
<p>Пример вывода в формате <b>Print both formulas = True</b>:</p>
<table width=50%>
<tr><td>Sheet.2!PinX = 41 mm</td><td>Sheet.3!PinX = 152 mm</td></tr>
<tr><td>Sheet.2!PinY = 226 mm</td><td>Sheet.3!PinY = 244 mm</td></tr>
</table>
<p>Пример вывода в формате <b>Print both formulas = False</b>:</p>
<table width=50%>
<tr><td>------------------------------------</td></tr>
<tr><td>Sheet.2!PinX = 41 mm</td></tr>
<tr><td>Sheet.2!PinY = 226 mm</td></tr>
<tr><td>------------------------------------</td></tr>
<tr><td>Sheet.3!PinX = 152 mm</td></tr>
<tr><td>Sheet.3!PinY = 244 mm</td></tr>
</table>
<p>Второй вариант дает компактную запись, которая с успехом может использоваться
для документирования разработки шейпа.</p>
<IMG SRC="image002.jpg" WIDTH="401" HEIGHT="161" BORDER="0" ALT="">
<h3>Копирование отдельных формул</h3>
<p>Во время сравнения шейпов одновременно с выводом результатов в лог
формируется и записывается в шейп управляющего коннектора перечень названий
отличающихся ячеек. Он сохраняется в виде выпадающего списка в поле Differences.
Если выбрать в этом списке одну из ячеек и выполнить функцию <b>Copy formula</b>,
формула будет переписана из исходного шейпа в сравниваемый.</p>
<p>Таким образом можно быстро скопировать несколько ячеек.</p>
<IMG SRC="image004.jpg" WIDTH="244" HEIGHT="208" BORDER="0" ALT="">
<h3>Копирование секции</h3>
<p>Во время сравнения шейпов также формируется перечень секций шейп-листа,
в которых были обнаружены различия. Он сохраняется в виде выпадающего
списка в поле Sections. Если выбрать в этом поле секцию и выполнить
команду <b>Copy section</b>, все ячейки указанной секции будут перенесены
из исходного шейпа в сравниваемый.<p>
<IMG SRC="image006.jpg" WIDTH="244" HEIGHT="208" BORDER="0" ALT="">
<p>Команда <b>Copy section</b> предполагает предварительное удаление
аналогичной секции в принимающем шейпе. Существует также команда
<b>Add to section</b>. Эта команда полезна для секций с именованными
строками. При ее выполнении новые строки добавляются к имеющимся.</p>
<p>Ограничение: не копируются секции Geometry и Text Fields.</p>
<h3>Дублирование листов</h3>
<p>Дублированием листов управляет мастер CopyPage. Для выполнения операции его
нужно перенести на активную страницу документа Visio и выполнить команду меню
<b>Copy page</b>. При этом в документ добавляется еще одна страница, представляющая
собой копию активной страницы.</p>
<p>Управляющий шейп имеет поле Destination page. Если внести в него имя
страницы-копии, то командой <b>Compare</b> можно сравнить активную страницу с
копией. Протокол различий выводится в файл log.log.</p>
<p>Функция дублирования не имеет смысла для Visio 2013. Там эта операция
выполняется штатными средствами. Но в более ранних версиях Visio она может быть полезна.</p>
<p>Функция имеет ограничение - не работает при наличии групп.</p>

<!-- "bott.inc"--------------------------- -->
</td></tr></table>
<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY><tr width="100%"><td bgColor="#000000" width="100%"><img height="2"
src="spacer.gif" width="100"></td></tr></TBODY>
</table>
<img alt height="2" src="spacer.gif" width="1"><BR>

</body>
</html>