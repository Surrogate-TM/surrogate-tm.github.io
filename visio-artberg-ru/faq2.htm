<html><head><title>FAQ в категории Совместимость</title>
<meta name="GENERATOR" content="MSHTML 5.00.2614.3500">
<meta content="text/html; charset=windows-1251" http-equiv="Content-Type">
<LINK REL="STYLESHEET" HREF="vis.css">
</head>
<body bgcolor="white">
<table width="100%"><tr>
<td width="20%" align="center"><a href="./index.htm"><IMG SRC="images/vl1.png" WIDTH="230" HEIGHT="130" BORDER="0" ALT=""></a>&nbsp;</td>
<td width="10%" align="center">&nbsp;</td>
<td class='menutd' width="70%" align="center">
 <a class="menu" href="http://visio.getbb.ru/">Форум visio.getbb.ru</a> |
 <a class="menu" href="./reg.htm">О форумах</a>
<!-- 
 <a class="menu" href="./forum/default.asp">форум visio.artberg.ru</a> |
 <a class="menu" href="./f_rubr/top.htm">Указатель artberg</a>
--> 
<br/>
 <a class="menu" href="./bib.htm">Библиотека</a> |
 <a class="menu" href="./faq.htm">Частые вопросы</a> |
 <a class="menu" href="./bookpdf.htm">Литература</a> |
 <a class="menu" href="./loading.htm">Склад материалов</a>
<br/>
 <a class="menu" href="http://visio-all.blogspot.ru/p/blog-page.html">Полезные ссылки</a> |
 <a class="menu" href="./site.htm">О сайте</a>
<br/>
 <a class="menu" href="./visicorp.htm">История Visio</a> |
 <a class="menu" href="./product.htm">Продукты Visio</a>
</td></tr></table>
<table width="100%" cellpadding="0" cellspacing="0" class="min"><tr><td width="10%" align="center">&nbsp;</td>
	<td width="90%">&nbsp;&nbsp;Для русскоязычных пользователей Visio. Начинающих и профессионалов.
Где взять, как сделать, что купить и т.д.
</td></tr></table>
<!-- --------------------------- -->
<img alt height="2" src="spacer.gif" width="1"><BR>
<!-- Внутренняя табл. для чужого текста -->
<table border="0" cellpadding="20" cellspacing="0" width="100%">
<tr><td width="100%" bgcolor="FFFFFF">
<!-- --------------------------- -->
<h1>FAQ в категории Совместимость</h1> 

<p><a href='#a229'>&nbsp;О совместимости Visio 2002 с Word</a></p>
<p><a href='#a230'>&nbsp;О совместимости с аvtocad</a></p>
<p><a href='#a231'>&nbsp;Проблема с вставкой рисунка из визио2000 в ворд2000</a></p>
<p><a href='#a232'>&nbsp;Конвертация dwg -> vsd, проблема шрифтов</a></p>
<p><a href='#a233'>&nbsp;Кодировка при импорте файла Autocad</a></p>
<p><a href='#a234'>&nbsp; Как исправить кодировку в Windows 2000?</a></p>
<h1>Совместимость</h1>
<p class='n' id='a229'>О совместимости Visio 2002 с Word</p>
<p class='v'>Когда вставляю диаграмму Visio в Word, текст не распознается. Что делать? (visio 2002 pro)  </p>
<p class='o'> Я наблюдал нечто похожее при вставке картинки из Visio2002 Std в Word95 под Windows98. Кроме того, в свое время прочитал исключительно полезную статью "Шрифты и Microsoft Windows" где-то на http://www.arh.ru/~naa/ .</p><p class='o'>Пересказывать ее нет смысла (лучше прочитать оригинал), но одна из рекомендаций (для Word95) - "при работе под Windows 9x в секцию [FontSubstitutes] файла Win.ini добавить строку вида: Font,0=Font,204" </p><p class='o'>То есть ВАРИАНТ 1 можно попробовать обойтись подстановкой шрифтов: - найти файл Win.ini, найти в нем секцию [FontSubstitutes] - добавить туда строчку типа Arial,0=Arial,204 (Это если вы используете шрифт Arial. Для других шрифтов нужно по аналогии добавить свои строчки). После этого Windows будет подсовывать Word'у в нужный момент соответствующую часть кодовой таблицы. Мне помогло. </p><p class='o'>ВАРИАНТ 2, если страшно связываться с подстановками шрифтов. Не связываться с переносом объектов Visio. Сохраните рисунок Visio как картинку (например, в формате tiff) и вставьте в Word рисунок. При этом, естественно, теряется возможность редактирования на месте, но как временная мера сработает на 100 %. </p>
<p class='n' id='a230'>О совместимости с аvtocad</p>
<p class='v'>При передаче схемы из visio в аvtocad, последний не распознает шрифты. Что делать?  </p>
<p class='o'> Visio записывает в секцию HEADER dxf-файла кодировку для dwg-чертежа, а каждую текстовую строку сопровождает параметром "стиль" (код 7). Причем у меня он пишет кодировку ANSI_1252, хотя хотелось бы ANSI_1251.</p><p class='o'>Поэтому при передаче рисунка в Autocad я делаю следующее: </p><p class='o'>Сохраняю рисунок в формате dxf. </p><p class='o'>В файле dxf изменяю параметр ANSI_1252 на ANSI_1251. </p><p class='o'>Читаю рисунок Autocad'ом. </p><p class='o'>В Autocad лезу в меню Format/Text Style и переопределяю для импортированных стилей параметр Font Name на аналогичный с приставкой Cyr. (Arial cyr и т.д.). </p><p class='o'>После этого текст отображается нормально. </p><p class='o'>Примечание. Возможно, сказывается также и подстановка Font,0=Font,204 в win.ini, но скорее всего это здесь не при чем. </p>
<p class='n' id='a231'>Проблема с вставкой рисунка из визио2000 в ворд2000</p>
<p class='v'>В ворде получаю не то, что нужно, а с узившееся или вообще перекосившееся изображение. При этом по бокам имеются пустые полосы. Создается впечатление, что если бы изображение заняло все место, то все стало бы правильно.</p><p class='v'>Да, когда конвертирую в jpg или печатаю из визио(на экране все правильно), то получаю те же проблемы.  </p>
<p class='o'> Тяжело, что-то посоветовать.</p><p class='o'>Бывает, конечно, что на какой-то из комбинаций систем налетишь на искажения. Причем чаще всего в этом оказывался виноват принтер 6L. То есть на него картинка выводится неправильно, а на струйник нормально. Но это чаще всего касалось заливки и текста. А у Вас, как я понял, искажается геометрия.</p><p class='o'>В качестве выхода всегда проходило сохранение в формате .tif с последующей вставкой его в Word. Но в принципе и jpg должен бы отработать аналогично. Хотя в данном случае, по-моему вместо jpg лучше подошел бы gif. И места меньше, и искажений.</p><p class='o'>Что я бы делал - постепенно пытался бы отсекать возможные источники ошибок:</p><p class='o'>преобразовать не в jpg, а в tif; </p><p class='o'>вывести на другой принтер, может быть на какой-нибудь другой системе. </p><p class='o'>Принтер всегда может создать проблему, даже если вы не собираетесь печатать. Дело в том, что формируя изображение на экране Word делает это под тот принтер, который установлен "По умолчанию". Переключите принтер, и у вас может измениться даже число страниц в документе. Так что об это забывать тоже не следует.</p><p class='o'>Ps. В данном случае проблема решилась установкой драйвера принтера HP6L (без самого принтера). </p>
<p class='n' id='a232'>Конвертация dwg -> vsd, проблема шрифтов</p>
<p class='v'>Есть схемы, набранные в ACAD 2000, их необходимо преобразовать в Visio 2002. Проблема заключается в некорректном распознавании русских шрифтов.</p><p class='v'>ACAD использует кодовую страницу 1251 - проверено. Когда вставляешь dwg файл в Visio - все надписи видны отлично. Но вот после конвертации получается ерунда.</p><p class='v'>Было сделано следующее:</p><p class='v'>1. В ACAD использован TrueType шрифт (Arial 1251).</p><p class='v'>2. В полном соответствии с рекомендациями хелпинга Visio был изменен шаблон _dwgcnvt.vst: добавили стиль Standard, который используется в файле ACAD, определили его как исключительно текстовый (остальные флажки убрали), шрифт задали Arial (Russian). Кстати говоря, в Visio 2000 четко указывалась кодовая странца, например Arial Cyr 1251, в Visio 2002 - только невнятный Russian.</p><p class='v'>Результаты:</p><p class='v'>В Visio 2000 данная метода работала надежно.</p><p class='v'>В Visio 2002 при конвертации почему-то не используется заданный в шаблоне стиль Standard со шрифтом Arial (Russian), применяется Arial (ANSI), получается полная туфта. А после конвертации кодировку текста менять бессмысленно - ничего не происходит.</p><p class='v'>Если кто знает решение проблемы - помогите пожалуйста. Пропадает целый свет :-)  </p>
<p class='o'> А почему Standard с большой буквы?</p><p class='o'>1. Если определить стиль standard (с маленькой буквы), то все работает нормально. Уточните, не ошиблись ли Вы.</p><p class='o'>2. Насчет того, что после конвертации ничего не сделаешь, тоже, похоже, ошибка.</p><p class='o'>Возьмите неправильно перекодированный рисунок. Определите непосредственно в нем какой-нибудь стиль (например ttt) с русской кодировкой. Примените этот стиль к неправильно перекодированному тексту. Текст станет русским. Возникают, конечно, сложности с другими параметрами стиля, но кодировка исправляется. </p>
<p class='n' id='a233'>Кодировка при импорте файла Autocad</p>
<p class='v'>Когда пытаюсь сконвертировать чертеж, содержащий русский текст, из Автокада в Visio, то текст неправильно перекодируется в какую-то абракадабру. Это происходит как с dwg так и с dxf файлами. Я проверял содержимое файла dxf - все русские строки там соответствуют кодировке в заголовке (CP866). Как сделать, чтобы русские надписи в автокадовском чертеже нормально конвертировались в Visio?  </p>
<p class='o'> Если бы Вы использовали Autocad 2000, то кодировка была бы 1251. С ней Visio разбирается легко, и задача состоит только в том, чтобы определить в Visio стиль с таким же именем, что использовался в Autocad (например, standard) и установить для него правильный язык.</p><p class='o'>В данном же случае возможна последовательность: Вставить автокадовский чертеж, потом произвести его конвертацию. В первый раз конвертация шрифтов происходит неверно, но зато в список стилей добавляются все стили, которые были в чертеже-вставке. Теперь удалить вставленный чертеж (Clear) и в меню Format/Define Styles выставить тексту всех новых стилей признак Russian. Снова вставить и конвертировать этот же автокадовский чертеж. Теперь русский текст преобразуется нормально.</p><p class='o'>Еще вариант: Если dxf как обычный текст пропустить через перекодировщик и перевести в 1251, то тоже все и заработает. </p>
<p class='n' id='a234'> Как исправить кодировку в Windows 2000?</p>
<p class='v'>Скачал штамп. Есть одна "незадача", все символы в штампе на "кракозяблском" языке. Как поправить и как потом сохранить в "библиотечном" виде. Можно ткнуть в URL :)  </p>
<p class='o'> Необходимо просто поправить пару параметров в реестре.</p><p class='o'>Для Windows NT,2000,XP</p><p class='o'>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Nls\CodePage</p><p class='o'>"1250"="c_1251.nls"</p><p class='o'>"1252"="c_1251.nls"</p><p class='o'>Для Windows 9x</p><p class='o'>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Nls\Codepage и проправить следующие параметры:</p><p class='o'>1250="CP_1250.nls" и 1252="CP_1252.nls" на такие значения: 1250="CP_1251.nls" и 1252="CP_1251.nls".</p><p class='o'>И перезагрузиться. Кстати довольно универсальное решение.</p><p class='o'>Подробности здесь:</p><p class='o'>http://www.softboard.ru/index.php?act=ST&f=2&t=736&s=e79f9ee6a6bbb32f17d2d875e317d03d</p><p class='o'></p>
<!-- --------------------------- -->
</td></tr></table>
<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY><tr width="100%"><td bgColor="#000000" width="100%"><img height="2"
src="spacer.gif" width="100"></td></tr></TBODY>
</table>
<img alt height="2" src="spacer.gif" width="1"><BR>
<!-- --------------------------- -->
<b>Контакты:</b> Туманов Геннадий Евгеньевич&nbsp;&nbsp;&nbsp;<a href="mailto:gCroc@yandex.ru">gCroc@yandex.ru</a>
<br/>

</body>
</html>
