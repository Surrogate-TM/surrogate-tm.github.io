<html><body><h2>Пользовательский интерфейс</h2><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>? Своя панель инструментов.</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Предположим я создал набор макросов для оперирования с селектированными шейпами (я уже писал в прошлой теме - для сворачивания схемы сети). Как удобнее организовать их запуска ? хот-кеи конечно хороший вариант, но хочется дополнительно иметь панель инструментов "плавающую" прямо над рабочей областью. каждая кнопка - вызов опред. скрипта. как это сделать ?</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">В SDK есть пример изменения пользовательского интерфейса "Command Bar Creation"<br />Если оттуда выбросить лишнее, оставить только пример с макросом и сделать нужное количество кнопок, появится у Вас своя панелька. Можно ее и плавающей сделать.<br />Выглядит это примерно так:<br />[code]    Set cbrCommandBars = vsoApplication.CommandBars<br />    ' Add a new CommandBar object that only exists through<br />    ' this session of Visio.<br />    Set cbrCommandBar = cbrCommandBars.Add( _<br />        Name:=strCommandBarName, _<br />        Position:=msoBarTop, Temporary:=True)<br />    ' Do not allow users to modify the new CommandBar.<br />    cbrCommandBar.Protection = msoBarNoCustomize<br />    ' Display the command bar using the Context property.<br />    cbrCommandBar.Context = Str(VisUIObjSets.visUIObjSetDrawing) & "*"<br />    ' Add a button to the bar.<br />    Set cbbCommandBarButton = cbrCommandBar.Controls.Add( _<br />        Type:=msoControlButton)<br />    ' Make it run a VBA Macro.<br />    With cbbCommandBarButton<br />        .Caption = "Visual Basic Macro"<br />        .TooltipText = "Click this button to run " & _<br />            "'ThisDocument.HelloWorld' macro if it exists"<br />        ' Use the Tag property for context switching and<br />        ' for use with the FindControl method.<br />        .Tag = "VBMacro"<br />        ' Get an internal icon for the button.<br />        .FaceID = 7075<br />        ' Use OnAction to run a VBA macro contained in<br />        ' this document.<br />         .OnAction = "ThisDocument.HelloWorld"<br />    End With[/code]<br />Здесь на единственную кнопку назначен некий макрос HelloWorld.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">самое интересное как такую панель потом скриптом удалить то ? а то пока тренироватся буду я  их сотню сделаю...</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Так как в примере стоит Temporary:=True, все они исчезнут после закрытия Visio. Действуют только в пределах сессии.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">а создание вешается на событие открытия документа ? ну тож вариант )) посмотрим что будет получатся.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">не очень то удобно получается ((  иконки получаются маленькие, в линию. создать их Нное количество и оптимально разместить не получается. можно как то "нарисовать" контрол с кнопками и уже на эти кнопки повесить макросы ?</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Нарисовать - это поместить на рисунок?<br />Можно сделать Insert / Control / Microsoft Forms 2.0 CommandButton. Для подключения макроса задействовать обработчик событий кнопки. Картинка вешается через свойство Picture.<br />Можно просто к проекту VBA добавить свою форму и размещать кнопки там. Если открывать не в модальном режиме, то она так и будет болтаться рядом с рисунком.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">варинт гораздо более приятный. но...<br />несколько кнопок можно даже группировать - получается как раз что-то типа панели. <br />но : кнопка вставляется в определенные координаты чертежа. и там остается. а если я перейду на другой лист ? или просто смещуюсь по рабочей области... нажать уже невозможно. нужен такой контрол но чтобы висел как панель - всегда перед носом.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Тогда у Вас опять два варианта [:)]<br />Можно сделать Anchored Window. Это дочернее окошко с поведением типа Drawing Explorer Window. В форуме уже обсуждалось и даже примерчик был.<br />Или вообще перейти на работу с Drawing Control. Уж там-то в своем приложении можно делать любые кнопки в любом месте.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote">Можно сделать Anchored Window<hr height="1" noshade id="quote"></font id="quote"></blockquote id="quote"><br />рылся, я рылся. нашел вроде пример на мсдн. <br />[code]Public Sub Stock()<br />   Dim wAddon As Visio.Window<br />   Set wAddon = ActiveWindow.Windows.Add("Stock", visWSVisible, _<br />   visAnchorBarAddon, , , 300, 210)<br />   Dim pnLeft As Long, pnTop As Long, pnWidth As Long, pnHeight As Long<br />wAddon.GetWindowRect pnLeft, pnTop, pnWidth, pnHeight<br />wAddon.SetWindowRect pnLeft, pnTop, pnWidth + 1, pnHeight<br /><br />End Sub[/code]<br />окно да, создается. но оно пустое ( точнее показывает части большого окна) и затащить туда ничего у меня не выходит (( может потому что пример для визио 2000 ?</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Ну, это Вы размечтались... Слишком просто.<br />Вот нашел какой-то более-менее похожий примерчик. Вроде работает.<br />Public Declare Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long<br />Public Declare Function SetWindowLong Lib "user32" Alias "SetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long<br />Public Declare Function GetWindowLong Lib "user32" Alias "GetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long) As Long<br />Public Declare Function SetParent Lib "user32" (ByVal hWndChild As Long, ByVal hWndNewParent As Long) As Long<br /><br />Public Const GWL_STYLE = (-16)<br />Public Const WS_CHILD = &H40000000<br />Public Const WS_VISIBLE = &H10000000<br /><br />Public m_Base As Base<br /><br />Public Sub ShowBase()<br /><br />Dim wAddon As Visio.Window<br />Set wAddon = ActiveWindow.Windows.Add("Base", visWSVisible, visAnchorBarAddon, , , 300, 210)<br /><br />Set m_Base = New Base<br />m_Base.Caption = "Base"<br /><br />Dim FormHandle As Long<br />FormHandle = FindWindow(vbNullString, "Base")<br /><br />SetWindowLong FormHandle, GWL_STYLE, WS_CHILD Or WS_VISIBLE<br /><br />SetParent FormHandle, wAddon.WindowHandle32<br /><br />Dim pnLeft As Long, pnTop As Long, pnWidth As Long, pnHeight As Long<br />wAddon.GetWindowRect pnLeft, pnTop, pnWidth, pnHeight<br />wAddon.SetWindowRect pnLeft, pnTop, pnWidth + 1, pnHeight<br />For Each sh In ActivePage.Shapes<br />m_Base.ListBox1.AddItem sh.Name<br />Next<br /><br />End Sub <br />================================<br />Только еще руками надо поработать :)<br />Надо создать модуль Module1.<br />Загрузить в него этот текст.<br />Потом создать форму. Обозвать ее Base<br />Повесить на нее ListBox1.<br />На странице рисунка нарисовать несколько шейпов.<br />Теперь можно запускать Module1 / ShowBase<br />И если нигде не ошиблись, то выскочит формочка и выведутся в листбоксе имена присутствующих шейпов.<br />Такое окошко должно вести себя как надо.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">[code]Public m_Base As Base[/code]<br />ошибка : user defined type not defined<br />reference какой подключить наверное надо ? вопрос какой ?</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2"><b>Потом создать форму. Обозвать ее Base</b><br />А это не забыли?</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Добавление пункта меню</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Купил по VBA книжку, т.к. появилась нужда вставить доп меню с возможностью запуска приложений. Переписал макрос - в Exel работает, в Visio никак, там обьекты подругому называются помогите кто чем.
Private Sub WorkBook_Open()
MenuBuilder
End Sub

Private Sub WorkBook_BeforeClose(Cancel As Boolean)
MenuKiller
End Sub

Private Sub MenuBuilder()
  Dim cdMenuBar As CommandBar
  Set cdMenuBar = Application.CommandBars.Add(Name:="?????????????", _
                                              Position:=msoBarTop, _
                                              MenuBar:=True, _
                                              Temporary:=True)
  With cdMenuBar
       .Visible = True
       With .Controls
           With .Add(Type:=msoControlPopup)
                .Caption = "Файл"
                With .Controls
           With .Add(Type:=msoControlButton)
                .Caption = "Новый"
                .OnAction = "NewDoc"
            End With
            With .Add(Type:=msoControlButton)
                .Caption = "Сохранить"
                .OnAction = "SaveDoc"
            End With
            With .Add(Type:=msoControlButton)
                .Caption = "Выход"
                .OnAction = "ExitApp"
            End With
         End With
    End With
    End With
    End With
End Sub

Sub MenuKiller()
   On Error Resume Next
   Application.CommandBars("МояСтрокаМеню").Delete
   On Error GoTo 0
End Sub

Sub Auto_Open()
WorkBook_Open
End Sub
</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">рекомендую посмотреть "дизайнера" который входит в пакет васика6<br /><br />вот собственно мой дизайнер http://www.immortal.vstu.edu.ru/Connect.rar<br /><br />можно разобрать его, есть несколько комментов там<br /><br />визио 2003 форэвер<br /><br />...а вобще-то я белый и пушистый.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">найди через поиск в хелпе визио VBA Editor статью :<br /><br />SetCustomMenus method<br /><br />This Microsoft Visual Basic for Applications (VBA) macro shows how to add a menu and menu item to the drawing window menu set...<br /></td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Menus: Add Items to the File menu.<br /><br />Public Sub MenuItem_Add()<br /><br />Dim uiObj As Visio.UIObject<br />Dim visMenuSets As Visio.MenuSets<br />Dim visMenuSet As Visio.MenuSet<br />Dim visMenus As Visio.Menus<br />Dim visMenu As Visio.Menu<br />Dim visMenuItems As Visio.MenuItems<br />Dim visMenuItem As Visio.MenuItem<br /><br />Set uiObj = Visio.Application.BuiltInMenus<br />Set visMenuSets = uiObj.MenuSets<br />' Get the Visio object context menu set.<br />Set visMenuSet = visMenuSets.ItemAtID(visUIObjSetDrawing)<br />Set visMenus = visMenuSet.Menus<br />' Get the file menu from the menus collection.<br />Set visMenu = visMenus.Item(0)<br />' Get the items collection from the file menu<br />Set visMenuItems = visMenu.MenuItems<br /><br />' Add Example Menu Item to the File menu in the 4th position<br />Set visMenuItem = visMenuItems.AddAt(3)<br />visMenuItem.Caption = "Example"<br />visMenuItem.State = Visio.visButtonUp<br /><br />' Have Example run the HelloWorld Sub procedure<br />visMenuItem.AddOnName = "ThisDocument.HelloWorld"<br /><br />' Set the new menus.<br />Visio.Application.SetCustomMenus uiObj<br />' Tell Visio to use the new UI when the document is active.<br />ThisDocument.SetCustomMenus uiObj<br />End Sub</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">во человек... 12 дней молчал и выдал...<br />дык получилось добавить пункт в меню или нет ???</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">я не тот человек, я просто посторонний, тему открывал другой визажист</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Работа с меню Визио</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Создал в VSD VBA-код, добавляющий меню "Выход" в Визио кот должен закрывать документ. При работе - ошибка - залезает в недопустимую область памяти и обваливает само Визио.
----------------------------------------------------------------------
Dim UIObj As Visio.UIObject, mnSet As Visio.MenuSet, mn As Visio.Menu
Private Sub Document_DocumentOpened(ByVal doc As IVDocument)
Set UIObj = Visio.Application.BuiltInMenus:
Set mnSet = UIObj.MenuSets.ItemAtID(visUIObjSetDrawing)
Set mn = mnSet.Menus.AddAt(0): mn.Caption = "Выход":
mn.AddOnName "Application.DoCmd(visCmdFileClose)"
'me.AddOnName="Me.Close"
'mn.AddOnName "ThisDocument.Close": mn.Enabled=true
ThisDocument.SetCustomMenus UIObj
End Sub
--------------------------------------------
(закоментированные варианты делают меню "Выход" неактивным)
В то же время, добавив конпку CommandButton семейства MSForms 2.0
и навесив на нее Me.Close - получаем корректный выход из рис.
В чем дело? 


Багоцкий</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">У меня очень похожая ситуация.<br /><br />Такое ощущение, что, в .AddonName должна быть либо команда (DoCmd), либо реальный addon, который есть в коллекции addon-ов приложения. И описываться он должен, как имя exe-файла. Если же в AddonName передается какая-то левая строчка, то он просто дизейблит соответствующий пункт меню :((((<br /><br />Отсюда вопрос как сделать так, чтобы при нажатии на пункт меню вызывался именно какой-нибудь метод.<br /><br />Конечно, можно делать меню через CommandBar и навешивать на CommandBarButton обработчик событий, но это очень неудобно...<br /><br />Может кто-нибудь подскажет, либо как все-таки заставить MenuItem вызывать не только готовые addon-ы, либо как можно сопоставить CommandBarButton конкретному пункту меню, созданному через UIObject.</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>UIObject</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Как пользоваться объектом UIObject ?
Вычитал в SDK про него, что он хранит все Menus и ToolBars. Вызвать MenuSets я могу, но что с ним делать дальше - неизвестно. Очень сильно меня property Enabled интересует. 
Я хочу, чтобы вызывался Visio, в котором все Menu и ToolBar не активны.</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Если Вы читали про него в SDK, то там же есть и примеры использования (непосредственно в документации).<br />А если "на пальцах", то UIObject - это старый интерфейс к меню и тулбарам Visio, который сейчас заменяется CommandBars. Действовал раздельно на меню и тулбары. Основан на том, что и Application и Document могут иметь как встроенные, так и пользовательские наборы меню. Один из наборов ассоциируется с объектом UIObject, изменяется и активируется, подменяя ранее доступный пользователю набор.<br />Измененный набор может быть сохранен в файле и загружаться макросом или при старте документа или приложения.<br />UIObject - это корень выбранного Вами набора, а дальше по дереву идет обращение к отдельным панелям, меню...<br />Важно не только модифицировать меню или тулбар, но и не забыть его активировать, а то он будет в наличии, но пользователь его не почувствует.<br />Смотрите примеры...</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Попробовал использовать CommandBars. Тут все еще более непонятно и запутано. В C# это object и как из него что-то получить я не знаю. <br />Главня моя задача  - запретить пользователю добавлять новые страницы и документы к моему Application. Мне кажется, что сделать меню неактивным - это простое и красивое решение проблемы. <br />Вопрос такой: как мне программно добраться до File/New/New Drawing и Insert/New Page и сделать их неактвиными ?</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Ну вот же пример из документации. Без изменений. Из SDK.<br />Отличие только в том, что пункт не деактивируется, а удаляется, да пункт меню для примера другой выбран.<br /><br />To remove an item, use the Delete method of that item. For example, the following statements remove the Show ShapeSheet menu item from the Window menu in the drawing window for the running Visio instance: <br /><br />Dim uiObj As Visio.UIObject<br />Dim menuSetObj As Visio.MenuSet<br />Dim menuItemsObj As Visio.MenuItems<br />Dim i As Integer<br /><br />Set uiObj = Visio.Application.BuiltInMenus<br />Set menuSetObj = _<br />    uiObj.MenuSets.ItemAtID(visUIObjSetDrawing)<br /><br />'Get the Window menu.<br />Set menuItemsObj = menuSetObj.Menus(7).MenuItems<br /><br />'Get the Show ShapeSheet menu item by its CmdNum property.<br />'This technique works with localized versions of Visio.<br />For i = 0 To menuItemsObj.Count -1<br />    If menuItemsObj(i).CmdNum = _<br />        visCmdWindowShowShapeSheet Then<br />        menuItemsObj(i).Delete<br />        Exit For<br />    End If<br />Next i<br /><br />'Replace built-in Visio menus with customized set.<br />Visio.Application.SetCustomMenus uiObj</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">С CommandBars разобрался. Но тут проблемы не закончились. Когда я произвожу какие-либо изменения в меню, то эти изменения касаются всего Visio. То есть при любом последующем запуске Visio, даже если запускаю не из программы, появляется измененное мной меню. Чтобы убоать изменения, надо удалить файл custom11.vsu .<br />Меню File я обрезал как надо.<br /> С меню edit началить проблемы: не могу добраться до пункта меню, который неактивный(Enabled = false Visioble = true). Как до него добраться ?<br />Есть меню View и Toolbar View, чтобы их вызвать я пишу <br />CommandBars(View). Как мне понять, что я вызвал ?</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by Juri_Zivago</i><br /><br />Как пользоваться объектом UIObject ?<br />Вычитал в SDK про него, что он хранит все Menus и ToolBars. Вызвать MenuSets я могу, но что с ним делать дальше - неизвестно. Очень сильно меня property Enabled интересует. <br />Я хочу, чтобы вызывался Visio, в котором все Menu и ToolBar не активны.<br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"> напишите отдельную программу, вставте туда компонент Microsoft Visio Draving Control type library<br /><br />визио 2003 форэвер<br /><br />...а вобще-то я белый и пушистый.</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Popup Menu</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Можно ли добавить свой пункт в меню, появляющееся при нажатии правой кнопкой мыши на шейп?</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">когда профи молчат на сцену выходят дилетанты -:)<br />вот что я нашел в хелпе моего visio 2003:<br /><br />You could add a command to a shape's shortcut menu that goes to another page in the drawing. To do this, select the shape, and then click Show ShapeSheet on the Window menu. On the Insert menu, click Section, select the Actions check box, and then click OK. <br />Select a cell in the Actions section, and then on the Edit menu, click Action. Fill in the Menu box, and then choose an action (for this example, click the Go to page option). For more information, see the ShapeSheet Reference (on the Help menu, click Developer Reference)<br /><br /></td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by brace</i><br /><br />когда профи молчат на сцену выходят дилетанты -:)<br />вот что я нашел в хелпе моего visio 2003:<br /><br />You could add a command to a shape's shortcut menu that goes to another page in the drawing. To do this, select the shape, and then click Show ShapeSheet on the Window menu. On the Insert menu, click Section, select the Actions check box, and then click OK. <br />Select a cell in the Actions section, and then on the Edit menu, click Action. Fill in the Menu box, and then choose an action (for this example, click the Go to page option). For more information, see the ShapeSheet Reference (on the Help menu, click Developer Reference)<br /><br /><br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"> да ладно прибедняться-то, я дык по нерусски не понимаю. :-)<br />т.к. не написана версия визио и русифицирована она или нет пишу относительно русифицированной:<br />1. Выделяем шейп<br />2. Меню: Окно - показать лист<br />3. Кликаем на открывшимся листе правой кнопкой мыши и в контекстном меню жмём<br />Вставить секцию...<br />4. выбираем секцию "Действия" , жмём "ОК"<br />Появится секция Action, нам нужны ячейки: Menu и Action соответственно пишем в Menu название вашего меню в Action действие, кот. необходимо выполнить при нажатии на это меню.<br />воть и усё<br /><br /><br />визио 2003 форэвер<br /><br />...а вобще-то я белый и пушистый.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">По поводу ячейки Action:<br />Можно ли запускать свою функцию?</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">=DOCMD(&lt;номер команды&gt;) описание комманд тут http://prodigitall.narod.ru/docs/docmd.txt<br />запуск Add-on: =RUNADDON("my.exe")<br />если адд-он ваш, необходимо прописать путь к нему в меню: Инструменты - опции... Дополнительно - пути файлов... Добавления:<br /><br />визио 2003 форэвер<br /><br />...а вобще-то я белый и пушистый.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Ставлю в номер команды 1577 - Макрос, появляется окошко с выбором моих макросов, а как сразу запустить один из них?</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">=RUNADDON("имя макроса")<br />причём макрос должен лежать в документе где он запускается<br /><br />визио 2003 форэвер<br /><br />...а вобще-то я белый и пушистый.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Большое спасибо... :)</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">=DOCMD(&lt;номер команды&gt;) <br />Ya vybrala (&lt;номер команды&gt;)-  DOCMD(1451) - drawing&gt;text block tool<br /><br />V contex menu poyavilsya item s imenem, kotoroe ya zadala v  section "Actions", no ozidaemyh deystviy net.<br /><br />Probovala i drugie komandy, tot ze result: imya dobavlyaetsya, a deystviy nikakih.<br /><br />U menya stoit Visio 2003.<br /><br />Mozet eze 4egoto ne hvataet.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Выполняются не все команды (почему-то).<br />Окошки открываются исправно, как положено. А вот 1451 - не работает.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Daze ne znayu 4t0 vypolnyaetsya, probovala 1010, 1021<br />Mozet poprobovat' posadit' 1451 v macro i ottuda vyzyvat'?</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Da, tak rabotaet!!!!<br />Ura!!</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Кнопка запуска макроса на панели инструментов</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Как засунуть в VISIO кнопку в панель инструментов для запуска какого либо макроса. Заранее благодарен тем кто поможет.</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">см. в хелпе визио вба эдитор<br />примерчик на вба там есть <br />только называется это типа <br /><font color="red">customer item in menu</font id="red"></td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Спасибо за помощь "brace".</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Как подключить горячие клавиши</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Господа профессионалы, а неподскажет ли кто как подключить на шейпы горячие клавиши?</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Вопрос не доходит...<br />Что значит "подключить клавишу на шейп"?<br /></td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Я имею ввиду назначить для шейпа хоткей. Это вообще возможно?<br /><br /><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by Tumanov</i><br /><br />Вопрос не доходит...<br />Что значит "подключить клавишу на шейп"?<br /><br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"></td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">в <font color="red">visio</font id="red">  это называется <font color="red">shortcut keys</font id="red"><br />в хелпе есть поле для поиска забей туда <font color="red">shortcut</font id="red"><br />получишь инфу на эту тему.<br /></td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Похоже что Вы говорите о master shape shortcut. Это совсем другое. Это вид ссылки на шейп, а мне необходимо сделать так чтоб шейпы вставлялись на рисунок не drug-n-drop из стенсила а по комбинации клавиш. <br /><br /><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by brace</i><br /><br />в <font color="red">visio</font id="red">  это называется <font color="red">shortcut keys</font id="red"><br />в хелпе есть поле для поиска забей туда <font color="red">shortcut</font id="red"><br />получишь инфу на эту тему.<br /><br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"></td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">не так сложно <font color="red">ответить</font id="red"> как сложно <font color="red">понять</font id="red"> что человек хочет ???<br />тем более если он не может сформулировать вопрос точно.<br /><font color="red">мой ответ:</font id="red"><br />шейпов в visio неск. тысяч и никаких комбинаций клавиш не хватит на все шейпы.<br /><br /></td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by Dmitry</i><br /><br />Похоже что Вы говорите о master shape shortcut. Это совсем другое. Это вид ссылки на шейп, а мне необходимо сделать так чтоб шейпы вставлялись на рисунок не drug-n-drop из стенсила а по комбинации клавиш. <br /><br /><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by brace</i><br /><br />в <font color="red">visio</font id="red">  это называется <font color="red">shortcut keys</font id="red"><br />в хелпе есть поле для поиска забей туда <font color="red">shortcut</font id="red"><br />получишь инфу на эту тему.<br /><br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br />Можно тогда записать макрос, который вставляет определенную фигуру, скажем из локального трафарета и повесить на него комбинацию клавиш.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by Digitall</i><br /><br /><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by Dmitry</i><br /><br />Похоже что Вы говорите о master shape shortcut. Это совсем другое. Это вид ссылки на шейп, а мне необходимо сделать так чтоб шейпы вставлялись на рисунок не drug-n-drop из стенсила а по комбинации клавиш. <br /><br /><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by brace</i><br /><br />в <font color="red">visio</font id="red">  это называется <font color="red">shortcut keys</font id="red"><br />в хелпе есть поле для поиска забей туда <font color="red">shortcut</font id="red"><br />получишь инфу на эту тему.<br /><br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br />Можно тогда записать макрос, который вставляет определенную фигуру, скажем из локального трафарета и повесить на него комбинацию клавиш.<br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br /><br />Может опрашивать нажатия макросом с шаблона и при нужных комбинациях вставлять нужный шейп?</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by brace</i><br /><br />не так сложно <font color="red">ответить</font id="red"> как сложно <font color="red">понять</font id="red"> что человек хочет ???<br />тем более если он не может сформулировать вопрос точно.<br /><font color="red">мой ответ:</font id="red"><br />шейпов в visio неск. тысяч и никаких комбинаций клавиш не хватит на все шейпы.<br /><br /><br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br /><br />Насчет понимания: А что хоткей и шоткат это одно и тоже? [:)]<br />Насчет множества шейпов: Нужны хоткеи только для некоторых...</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">определение термина "shortcut"<br /><font color="red">A keyboard shortcut (also known as an accelerator key, shortcut key, or hotkey)</font id="red"> is a set of keyboard keys that when pressed simultaneously, perform a predefined task. Such a task could be done with the mouse (or other analog input such as a trackball), but would require much longer. Hence, they are a shortcut in that they save the user time. <br />смотри здесь:<br />en.wikipedia.org/wiki/Shortcut_(computers)</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Простите если можете... <br />Нехотел обидеть... :)<br /><br /><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by brace</i><br /><br />определение термина "shortcut"<br /><font color="red">A keyboard shortcut (also known as an accelerator key, shortcut key, or hotkey)</font id="red"> is a set of keyboard keys that when pressed simultaneously, perform a predefined task. Such a task could be done with the mouse (or other analog input such as a trackball), but would require much longer. Hence, they are a shortcut in that they save the user time. <br />смотри здесь:<br />en.wikipedia.org/wiki/Shortcut_(computers)<br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"></td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Господа, подскажите плз, такая проблема...<br /><br />Вобщем, в Visio по нажатию на определённую комбинацию клавишь необходимо выполнить некоторую функцию.<br /><br />Пытался делать с помощью вин апишной ф-ции RegisterHotKey, но не удалось довести дело до конца....<br /><br /></td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Если Visio 2003, то можно обойтись без Win API.<br /><br />1. Можно написать макрос, включить в него нужную функцию и назначить этому макросу комбинацию клавиш.<br />Кажется эта комбинация обязательно должна включать Ctrl.<br />Клавиши назначаются через окошко, появляющееся по Alt+F8 (кнопка Options).<br /><br />2. Можно написать обработчик для события нажатия клавиши.<br />Для этого в модуле класса (в простейшем случае ThisDocument) объект (например Window) объявляется WithEvents,<br />Dim WithEvents MyWin As Visio.Window<br />затем пишется обработчик. Например<br />Private Sub MyWin_KeyDown(ByVal KeyCode As Long, ByVal KeyButtonState As Long, CancelDefault As Boolean)<br />MsgBox KeyCode<br />End Sub<br />И наконец, где-то этот объект ассоциируется с реальным объектом. В простейшем случае - при открытии документа или отдельным макросом.<br />Sub ttt()<br />Set MyWin = ActiveWindow<br />End Sub<br />Такой макрос заставит MyWin обрабатывать события, после чего обработчик MyWin_KeyDown начнет выводить окно сообщений с кодом клавиши при каждом нажатии клавиши.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Благодарю за ответ.Но оба приведённых способа меня не совсем удовлетворяют...<br />Первый способ неудовлетворяет ограниченностью возможной комбинации.<br />Второй способ обрабатывает только нажатие, которое возвращает Ascii-код.<br />Мне же необходимо использовать произвольную комбинацию, как пожелает заказчик (например CTRL+ALT+F10)<br />Подскажите плиз, если ли решение...<br /><br />И еще один вопрос возник: каким образом можно запретить комбинацию ALT+F8 (вызов окна макросов)? Если не запретить совсем, то хотя бы переназначить, что бы выводилась месага а-ля "Доступ закрыт"<br />Спасибо.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">К предыдущему посту:<br />версия Visio - 2003.<br /></td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Отключение горячих клавиш</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Уважаемые, как отключить горячие клавиши в компоненте Visio?


Тужибаев Тимур</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">А что именно ты хочешь получить?<br />Я тоже сейчас работаю с этой проблемой.<br /><br />___ Кто ищет тот найдет __</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by Voland</i><br /><br />А что именно ты хочешь получить?<br />Я тоже сейчас работаю с этой проблемой.<br /><br />___ Кто ищет тот найдет __<br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br /><br />Я пользую контрол Visio и в моей програмке ну никак не планируется появление окошка поиска, открытия хелпа и т.п. от visio. У контрола есть возможность отключения большинства команд прям из свойств контрола , но почему то отключаются не все команды :(<br /><br />Тужибаев Тимур</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Как я понял ты используешь DrawingControl. Да, действительно он не перекрывает всех действий, но я хочу сейчас попробовать перехватывать его WinProc и там уже анализировать что нужно/можно что нет. Можем заняться напару этим делом. Думаю, именно для этого и сделали доступной эту процедуру в компоненте, хотя не факт...<br /><br />___ Кто ищет тот найдет __</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">может быть проще переопределить эти же горячие клавиши в самой программе?... т.е не касаясь дровинг контрола?..<br /><br />и если можно расскажите как вы хоть какие то команды отключили?</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by mers</i><br /><br />может быть проще переопределить эти же горячие клавиши в самой программе?... т.е не касаясь дровинг контрола?..<br /><br />и если можно расскажите как вы хоть какие то команды отключили?<br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br /><br />Drawningcontrol.negotiatemenus = true<br />Drawningcontrol.negotiatetoolbars = true<br /><br />Тужибаев Тимур</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Уважаемые, hotelos' by uznat' 4to-nibud; u vas polu4ilos'?<br /><br />S CTRL+V boryus' elementarenym<br /><br />      Clipboard.Clear<br /><br />in the DrawningControl_KeyDown event<br /><br />A vot CTRL+D napryagaet.<br />Ostal'nye горячие клавиши ne meshayut funkzional'nosti moey application.</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Функциональные клавиши как то оключил, уже не помню как... вспомню напишу, а вот с контрл+С контрл+V сделал так:<br />На событие ОнКейАп поставил <br /> if (KeyCode=17) or (KeyCode=16) then begin<br />  AddShapeOK:=true;<br /> end;<br />На событие ОнКейДавн поставил <br /> if (KeyCode=17) or (KeyCode=16)  then begin<br />  AddShapeOK:=False;<br /> end;<br /><br />На событие ОнШейпАддедед<br /><br />if AddShapeOK then begin<br />  Тут типа нормально, добавили и попачили если надо<br />end else begin<br />  Shape.Cells['LockDelete'].Formula:='0';<br />  Shape.Delete;<br />end;<br /><br /><br /><br /><br /><br /><br />___ Кто ищет тот найдет __</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">А вспомнил... Вобщем сделал немного кривовато, но пока других способов не искал...<br />Вобщем кинул на форму (я в Делфи) компонент ApplicationEvents  и внем на событии OnMessages вставил код <br />  if (Msg.message=WM_KEYDOWN) then begin<br />     If (Msg.wParam&gt;=112) and (Msg.wParam&lt;=121) then begin<br />        Msg.wParam:=0;//Тут отключил все функциональные клавиши<br />     end;<br />     If (Msg.wParam&gt;=221)  then begin<br />        Msg.wParam:=0; //Тут помоему Ctrl+D  :)))<br />     end;<br />  end;<br /><br />Вобщем так можно всю клаву отключить :)<br /><br />Криво но пока устраивает... :(<br /><br /><br />___ Кто ищет тот найдет __</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Ya rabotayu v VB6 tam eto tak sdelat' trudnee.<br />Budu probovat'.<br />Spasibo za sovet.</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Управление элементы меню Visio</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Никто не пробовал скрывать какие-нибудь менюшки Visio (если нашему add-in они не нужны и мы не хотим их показывать)
</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">меню в визио можно настраивать под свой вкус<br /><font color="red">View &gt; Toolbars &gt; Customise</font id="red"><br />открывается окно которое позволяет добавлять/убирать кнопки/команды<br />или вернуть все в  дефолтный вариант меню.<br /></td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by brace</i><br /><br />меню в визио можно настраивать под свой вкус<br /><font color="red">View &gt; Toolbars &gt; Customise</font id="red"><br />открывается окно которое позволяет добавлять/убирать кнопки/команды<br />или вернуть все в  дефолтный вариант меню.<br /><br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br />Тут, насколько я понял, интересует VB вариант...</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">скачайте себе SDK<br />там есть пример создания и скрытия меню</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">вот еще, правда на C#:<br /> <blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><b>Integrating Menus and Toolbars</b><br />The best practice when building an application using the Visio drawing control is to implement a custom UI. If you want to display Visio menus and toolbars in your container application, set the drawing control's NegotatiateToolbars and NegotiateMenus properties. The following C# code enables both menu and toolbar merging:[code]drawingControl.NegotiateMenus = True;<br />drawingControl.NegotiateToolbars = True;[/code]The best practice is to set both of these properties to the same value. The control will not support independent negotiation of toolbars and menus. <br /><br />The container application must support OLE menu merging in order to display Visio menus or toolbars. For example, you can enable toolbar merging in a Word document. Within the Visual Basic project of the Word document you can programmatically display Visio toolbars. The following example displays the Layout & Routing toolbar.[code]vsoApplication.CommandBars("Layout & Routing").Visible = True[/code]<b>Important</b>   Do not attempt menu and toolbar merging with multiple active instances of the ActiveX control. Multiple instances of the control share a single underlying Visio Application object. You may get unexpected results when trying to do menu merging with a single Application object and multiple active instances of the control. <br /><b>Important</b>    Do not merge menus and toolbars with the Internet Explorer user interface. There are known issues with menu merging in Internet Explorer (see the Microsoft Knowledge Base article 193098, PRB: Unexpected Menu Merging Behavior in Internet Explorer).<hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote">взято с:<br />http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vissdk11/html/viconAboutWorkingWithDrawingControl_HV01046843.asp</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">to mers : Оки =) Можно попробовать через это, хотя я делал по другому. Я своё меню встраивал в Visio, и трабла была в том, что там метод Add() есть, а для удаления ничего нету....</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">А, всё, ступил =) уже разобрался!</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Вложенные меню</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Коллеги, не выручите примером кода создания <b>вложенного</b> главного меню в Visio ? Например, пункт главного меню "Отчеты" содержит "Сводный план", "Квартальный план", а "Сводный план" в свою очередь содержит подпункты "По ГИПам", "По заказчикам". Спасибо.

------------------------------------------------------------------------------------------------
Если автор пишет о том, чего не понимает, его работа будет понята только теми читателями, которые понимают в этом больше, чем он !</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2"><b>Сам нашел [:D], даю решение, может быть, кому-нибудь и пригодится:</b><br />[code]Sub AddMenuToMenuBar(vsoApplication As Visio.Application)<br />' Abstract - This procedure gets the active MenuBar from<br />' Visio and adds a Menu at the end called "Custom".<br /><br />        Dim cbrCommandBars  As Office.CommandBars<br />    Dim cbrMenuBar      As Office.CommandBar<br />    Dim cbrMenuPopup    As Office.CommandBarPopup<br />    Dim cbrMenuPopup_Group    As Office.CommandBarPopup<br />    <br />    Dim cbrFilePopup    As Office.CommandBar<br />    Dim cbbMenuItem     As Office.CommandBarButton<br />    Dim cbbOpen         As Office.CommandBarButton<br />    Dim XID As Integer<br />    <br />    <br />    ' Get the CommandBars collection from Visio.<br />    Set cbrCommandBars = Application.CommandBars<br />    <br />    ' Get the active menu bar from the CommandBars<br />    ' collection.<br />    Set cbrMenuBar = cbrCommandBars.ActiveMenuBar<br />    <br />    ' Add a pop-up menu to the end of the menu bar.<br />    Set cbrMenuPopup = cbrMenuBar.Controls.Add( _<br />        Type:=msoControlPopup, _<br />        Temporary:=True)<br />    cbrMenuPopup.Caption = "тест"<br />       <br />    <br />     ' Get the ID of the "File/Open..." MenuItem<br />    Set cbrFilePopup = cbrCommandBars.Item("File")<br />    Set cbbOpen = cbrFilePopup.Controls.Item(2)<br />    <br />    ' Add a MenuItem with the ID of "File/Open...".<br />    Set cbbMenuItem = cbrMenuPopup.Controls.Add( _<br />        Type:=msoControlButton, _<br />        ID:=cbbOpen.ID, Temporary:=True)<br />        <br />    ' Set the caption for the MenuItem.<br />    cbbMenuItem.Caption = "тест"<br />    cbbMenuItem.Style = msoButtonCaption<br />    cbbMenuItem.Visible = True<br />    cbbMenuItem.OnAction = "ShowNum"<br />    <br />    Set cbrMenuPopup_Group = cbrMenuPopup.Controls.Add( _<br />        Type:=msoControlPopup, Temporary:=True)<br />        <br /><br />    cbrMenuPopup_Group.Caption = "тест"<br />    <br />    Set cbbMenuItem = Application.CommandBars(cbrMenuPopup_Group.CommandBar.Name).Controls.Add<br />        <br />    cbbMenuItem.Caption = "тест"<br />    cbbMenuItem.OnAction = "GetAllObjects"<br />    <br />    Set cbbMenuItem = Application.CommandBars(cbrMenuPopup_Group.CommandBar.Name).Controls.Add<br />    <br />    cbbMenuItem.Caption = "тест"<br />    cbbMenuItem.OnAction = "GetAllObjectsFromActivePage"<br />       <br />    Set cbbMenuItem = Application.CommandBars(cbrMenuPopup_Group.CommandBar.Name).Controls.Add<br />        <br />    <br />    cbbMenuItem.Caption = "тест"<br />    cbbMenuItem.OnAction = "GetAllProcedures"<br />    cbbMenuItem.BeginGroup = True<br />    <br />    Set cbbMenuItem = Application.CommandBars(cbrMenuPopup_Group.CommandBar.Name).Controls.Add<br />    <br />    cbbMenuItem.Caption = "тест"<br />    cbbMenuItem.OnAction = "GetProceduresFromActivePage"<br />    <br />    Set cbbMenuItem = Application.CommandBars(cbrMenuPopup_Group.CommandBar.Name).Controls.Add<br />        <br />    ' Set the caption for the MenuItem.<br />    cbbMenuItem.Caption = "тест"<br />    cbbMenuItem.OnAction = "GetAllSwitches"<br />    cbbMenuItem.BeginGroup = True<br />    <br />    Set cbbMenuItem = cbrMenuPopup.Controls.Add( _<br />        Type:=msoControlButton, _<br />        ID:=cbbOpen.ID, Temporary:=True)<br />        <br />    ' Set the caption for the MenuItem.<br />    cbbMenuItem.Caption = "тест"<br />    cbbMenuItem.Style = msoButtonCaption<br />    cbbMenuItem.Visible = True<br />    cbbMenuItem.OnAction = "ShowViewTXT"<br />    cbbMenuItem.BeginGroup = True<br />    <br />    <br />    Set cbbMenuItem = cbrMenuPopup.Controls.Add( _<br />        Type:=msoControlButton, _<br />        ID:=cbbOpen.ID, Temporary:=True)<br />    <br />    cbbMenuItem.Caption = "тест"<br />    cbbMenuItem.Style = msoButtonCaption<br />    cbbMenuItem.Visible = True<br />    cbbMenuItem.OnAction = "ShowTP"<br />    <br />    Exit Sub<br /><br />    <br />AddMenuItemToMenuBar_Err:<br />    MsgBox Err.Description<br />    <br />End Sub[/code]<br /><br />------------------------------------------------------------------------------------------------<br />Если автор пишет о том, чего не понимает, его работа будет понята только теми читателями, которые понимают в этом больше, чем он !</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Удаление пункта из меню</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2"><font color="red">To delete a menu item</font id="red">, you can use code similar to the following:  

Dim CmdBar As CommandBar
Dim CmdBarMenu As CommandBarControl

Set CmdBar = Application.CommandBars("Worksheet Menu Bar")
Set CmdBarMenu = CmdBar.Controls("Tools")
CmdBarMenu.Controls("New Item").Delete

это код написан для Excel но поскольку visio and excel из одной
компашки MS OFFICE по идее должно работать если ктонить заменит 
иксельные слова на нужные.


</td>
  </tr></table><table>
<table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Переназначение горячих клавиш</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Назначил несколько горячих клавиш в Visio 2000 , изменив стандартную библиотеку VisRes32.dll. Работать стало значительно удобнее, но... При работе в режиме Text Tool  прописанные клавиши переключают режимы обратно [:(]. Кто знает, подскажите плз - можно ли это обойти, не прибегая к назначению комбинаций клавиш (shift, ctrl + ##)?</td>
  </tr></table><table>
<table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Visio 2003 панель инструментов</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Пожалуйста помогите, если может кто!!!
После установки AdobeAcrobat 7(стал необходим для дальнейшей работы) пропадают все настройки "настроенной под себя" панели управления, установок хватает только на повторный запуск, на т ретий раз уже просто стандартные панели :(( Помогите пожалуйста. Может кто сталкивался с этим. До Acrobata все было окей</td>
  </tr></table><table>
<table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Проблемы с контекстным меню</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Необходимо в контекстное меню добавить пункт "Скрыть".И при выборе объекта левой кнопкой мыши этот пункт был доступным, а при клике на пустое место пунк "Скрыть" был бы не доступен (напрмер, как с Help)!</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Контекстное меню можно добавить только к чему-нибудь. При клике на пустое место оно всегда будет недоступно (вернее его просто не будет).<br />В Visio контекстное меню называется shortcut menu. Вот цитата из документации, где рассказывается, как создать пункт меню и прицепить к нему макрос:<br /><br />Add a macro or add-on to a shape's shortcut menu<br />Select the shape.<br />On the Window menu, click Show ShapeSheet.<br />Click in an Action cell in an Actions section.<br />If you don't see an Actions section, insert one by clicking Section on the Insert menu, and then selecting the Actions check box in the Insert Section dialog box.<br />On the Edit menu, click Action.<br />In the Action dialog box, under Properties, enter the menu and prompt properties.<br />Click Run macro, and then select the program you want to run from the Run macro list. Click OK.<br />On the drawing page, right-click the shape, and then click the custom menu command on the shortcut menu to run the program.<br />Note You also can associate a macro or add-on with a shape by entering a formula that uses the RUNADDON function in any ShapeSheet cell.<br /></td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Пункт меню я создавать умею:<br /><br />Set vsoUIObject = appVisio.BuiltInMenus<br />Set vsoConMenuSets = vsoUIObject.MenuSets<br />Set vsoConMenuSet = vsoConMenuSets.ItemAtID(visUIObjSetCntx_DrawObjSel)<br />Set vsoConMenus = vsoConMenuSet.Menus<br />Set vsoConMenu = vsoConMenus.Item(0)<br />Set vsoConMenuItems = vsoConMenu.MenuItems<br />Set vsoConMenuItem = vsoConMenuItems.AddAt(vsoConMenuItems.Count)<br />vsoConMenuItem.Caption = "&Скрыть"<br />vsoConMenuItem.Enabled = False<br />vsoConMenuItem.AddOnName = "ThisDocument.HideObject"<br />vsoConMenuItem.ActionText = "Run HideObject "<br />ThisDocument.SetCustomMenus vsoUIObject<br /><br />В сделующем примере кода я проверяю взят ли объект.<br />И нужно следующее: если объект взят, то пункт "Скрыть" должен быть доступен, иначе недоступен.<br /><br />If Button = 2 Then<br />Dim intRet As Integer, shpObj As Visio.Shape<br />Dim shpsObj As Visio.Shapes<br />Dim Find As Boolean<br />Set shpsObj = vsoPage.Shapes<br />For Each shpObj In shpsObj<br />    intRet = shpObj.HitTest(x, y, 0)<br />    If intRet = 0 Then<br />       Enabled_False ' здесь нужно, чтобы пункт "Скрыть" остался enable = false<br /><br />    Else<br />       Enabled_True ' а здесь нужно, чтобы пункт "Скрыть" остался enable = true<br /><br />    End If<br />    Next<br />End If<br /></td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Drop down menu item в Windows User Interfase</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">добрый день!

решил тут побаловаться с <b>Visio for Enterprise Architects</b> (10.0.2705)
в плане построения Windows User Interfase диаграмм.

есть такой элемент в этой диаграмме, "Drop down menu item" который представляет елемент выпадающего меню формы.
проблема в том, что *длинна* этого елемента жестко зафиксирована и невозможно ее изменить. сами понимаете что тест на пунктах меню может быть самый разный. 

кто сталкивался с таким эфектом?
как побороть!</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by serkuzm</i><br /><br />добрый день!<br /><br />решил тут побаловаться с <b>Visio for Enterprise Architects</b> (10.0.2705)<br />в плане построения Windows User Interfase диаграмм.<br /><br />есть такой элемент в этой диаграмме, "Drop down menu item" который представляет елемент выпадающего меню формы.<br />проблема в том, что *длинна* этого елемента жестко зафиксирована и невозможно ее изменить. сами понимаете что тест на пунктах меню может быть самый разный. <br /><br />кто сталкивался с таким эфектом?<br />как побороть!<br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br />Зайти в ТаблицуФигур(Window&gt;ShapeSheet), найти раздел Scratch(Наброски) и в этом разделе найти ячейку А1. В этой ячейке содержится формула, запрещающая изменение длины меньше, чем заданный минимум. Можете просто удалить содержимое этой ячейки, или поставить 0.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by Digitall</i><br /><br /><br />Зайти в ТаблицуФигур(Window&gt;ShapeSheet), найти раздел Scratch(Наброски) и в этом разделе найти ячейку А1. В этой ячейке содержится формула, запрещающая изменение длины меньше, чем заданный минимум. Можете просто удалить содержимое этой ячейки, или поставить 0.<br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br /><br />Благодарю за ответ, но не могу найти указанный раздел: "Scratch". Возможно у нас разные версии Визио.<br /><br />Можно ли узнать исходную формулу которая запрещает изменение длинны?<br /><br />з.ы.<br />все-таки надо будет поискать в своей библиотечке литературу по Visio..[^]</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">хм... :)<br />Как обычно надо немного подумать перед тем как говорить.<br /><br />Раздел Scratch действительно существует, но у другого элемента - Top-level menu item. А у Drop-down menu item такого свойства нет.<br />Однако у него есть 1-D Endpoints которое по умолчанию =GUARD(BeginX+25,4 mm)<br />Меняя значение числа можно изменять длинну элемента.<br /><br />Надо срочно читать литературу по визио!!!</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Проблемы s CustomMenu</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Здраствуйте.

Имеется следующая Ситуация.
При старте Visio  загружается Addon и в линейке Меню появляется новое меню.
К этому Menu я программно "цепляю" новые елементы.
Если открыт Документ, то в зависимости от определенных условий
я делаю некоторые элементы невидимыми или же невидимые элементы делаю видимыми(передаю параметру MenuItem.Visible false или true).

Теперь во время тестов я наткнулся на один документ который содержит
ещё один  Add-On с собственным меню.

В этом случае, мое Меню всегда выглядит так , как оно выглядело до открытия документа,
в не зависимости от того  какое значение имеет параметр Visible(причем значениe именно ,то что я передал) .

Может ли кто-то подсказать в чем дело? 

P.S. Позиция моeго Меню  в массиве Menus не меняется 
</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Ваш Add-On запускается несколько раз (при открытии Visio и при открытии документа) или Вы после единственного запуска начинаете анализировать наличие и свойства документа?<br />Такое подозрение, что Ваш Add-On сначала что-то делает, потом вылетает и на попытки управлять свойством Visible уже просто не реагирует.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Как раз собирался стереть топик :)<br /><br />мой Addon запускается при открытии Visio.<br />Как я понимаю, дело в Том что я выполнял Функцию SetCustomMenu(UIObject) для Application<br />Попробовал тоже самое сделать посже для Документа: теперь мое меню работает адекватно, но <br />"вражеское меню"( :) ) изчезло. Первая мысль: я своим UIObject'om заменил существующий. Буду проверять.<br /></td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Так создаваемый UIObect обязательно заменяет существующий. Поэтому первым делом советуют смотреть, существует ли на данный момент пользовательское меню уровня документа или приложения, и выбирают, что взять в качестве прототипа - что-то из них или встроенное меню.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2">Я немного запутался.<br />Если я добавляю меню в массив пользовательских меню на уровне приложения, то при открытии документа я должен был бы видеть <br />меню которые находятся в массиве на уровня документа.<br />Я же вижу  меню и того и другого массива.<br />Как это обьяснить?<br />P.S.<br />Только что проверил какие меню находятся<br />в массиве пользоватeльских меню на уровне документа и обнаружил,<br />что мной добавленое меню уровня приложения тоже там. ???</td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Menu</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Есть такая проблема:
открывается Visio с моим трафаретом. Пользователь может перетаскивать на страницу Shape'ы. 
Как сделать так, чтобы пользователь не смог открывать новые документы и создавать новые страницы ? 
А еще лучше как сделать недоступными для пользователя все меню, разве что кроме Edit, и все все панели инструментов ?</td>
  </tr></table><table>
<table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>software-&gt;Toolbars and Menus</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">В трафарете software-&gt;Toolbars and Menus у всех шейпов есть точки благодаря которым они могут соединятся друг с другом, как они сделанны не могу разобраться? Но если два шейпа соединены этими точками то перетаскивая один шейп за ним тянется другой присоединёный причём это не групировка. Как сделать такое?</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">мое преположение но точно не знаю !<br /><br />маленькие синие крестики на шейпах<br />это <font color="red">Connection Points</font id="red"><br />их поведение задается в <font color="red">ShapeSheet</font id="red">данного шейпа<br />чтобы они клеились надо поменять параметр в ячейке<br /></td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by Borg</i><br /><br />В трафарете software-&gt;Toolbars and Menus у всех шейпов есть точки благодаря которым они могут соединятся друг с другом, как они сделанны не могу разобраться? Но если два шейпа соединены этими точками то перетаскивая один шейп за ним тянется другой присоединёный причём это не групировка. Как сделать такое?<br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br />Данное соединение называется жесткой связью. Характерным признаком жесткой связи являются маркеры подключенной фигуры красного цвета.<br /><br />Более подробно [url]http://www.prodigitall.narod.ru/articles/article12.html[/url]</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">&gt;&gt; Brace в  ShapeSheet я не нашёл ни чего что бы отличало эти шейпы от других только раздел 1-D который не доступен у остальных фигур<br />&gt;&gt; Digitall к сожелению это не то эти точки видны только когда шейп выделен и левая представляет из себя зелёный квадрат со звёздочкой, а правый зелёный квадрат с плюсом.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote"><i>Originally posted by Borg</i><br /><br /><br />&gt;&gt; Digitall к сожелению это не то эти точки видны только когда шейп выделен и левая представляет из себя зелёный квадрат со звёздочкой, а правый зелёный квадрат с плюсом.<br /><hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br />Так. Попробовал. Да. Действительно по-другому сделано. Смысл такой: берется линия, ограничивается угол, ограничивается длина. И делается 2 соединительных точки на концах линии. И все.<br /><br />Тоже самое можно сделать и с 2-мерным объектом. Только поведение (behaviour) прописать.<br /><br />Если требуется более подробные пояснения с примерами, то на e-mail...</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">существует три типа поведения Connection point.<br /><br />1. Inward<br />2. Outward<br />3. Inward/outward<br /><br />я приклеил крест к окружности в точке касания<br />теперь вот оторвать не могу<br /><br />изменять тип коннекшн пойнт можно не заходя в ShapeSheet<br />через меню см. визио хелп<br /><br /><br /><br /></td></tr><table align="center" border="0" cellPadding="0" cellSpacing="1" width="95%">
  <tr>
    <td valign="top"><font face="verdana" size="2"><h4>Пользовательское окно в Visio</h4></td>
  </tr>  <tr>
    <td valign="top"><font face="verdana" size="2">Каким образом можно создать окно в Visio для отображения форм создаваемых в MS Visual Basic.</td>
  </tr></table><table>
  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Ну, скажем так, задача сформулирована несколько некорректно. Я попробую ответить, а уж если не так понял вопрос, тогда придется уточнять.<br />В общем-то все зависит от того, что Вы сделали с формой, созданной в MS Visual Basic. Если Вы сделали на ее основе приложение (exe), то для Visio оно будет выглядеть как Add-on и может вызывается как из меню Visio, так и определенному событию.<br />Возьму пример из работющей программы.<br />Вот код в MS Visual Basic:<br />Текст Add-on CouSet<br />------------------------------------------------------------------<br />Dim Shp As Visio.Shape<br />Private Sub Command1_Click()<br />  Shp.Data1 = Combo1.Text<br />  Shp.Cells("EventDblClick").Formula = "RUNADDON(""CouSet.exe"")"<br />  Shp.Cells("EventXFMod").Formula = "RUNADDON(""CouUpdate.exe"")"<br />  End<br />End Sub<br /><br />Private Sub Form_Activate()<br />Dim appVisio As Visio.Application<br />Dim pagObj As Visio.Page<br />Set appVisio = GetObject(, "Visio.Application")<br />Set pagObj = appVisio.ActivePage<br />i = InStr(Command, "/shape=")<br />If (i = 0) Then<br />  Set Shp = pagObj.DrawRectangle(1, 6, 1.3937, 6.19685)<br />  Shp.Name = "MCounter"<br />  Shp.Text = "0"<br />Else<br />  s = Mid(Command, i + 7)<br />  Set Shp = pagObj.Shapes.Item(s)<br />End If<br />...<br />Программа содержит форму, на которой ComboBox и кнопка. Сначала запускается через меню Add-On. При этом срабатывает Form_Activate(), находит запустившее его Visio-приложение и рисует в нем прямоугольник MCounter.<br />Следующая завязка - при щелчке по кнопке на этой форме срабатывает Command1_Click(), который прописывает в ячейку шейп листа нарисованного прямоугольника вызов себя (Shp.Cells("EventDblClick").Formula = "RUNADDON(""CouSet.exe"")"). Теперь уже это приложение (с формой из MS Visual Basic) сможет запускаться при двойном щелчке по им же нарисованному шейпу.<br />Никаких дополнительных окон здесь не создается. Существует только окно с рисунком Visio и окно Add-on из MS Visual Basic.<br />А можно и просто нарисовать форму в самом Visio. Это делается через Tools/Macros/Visual Basic Editor/Insert/UserForm. Такая форма будет показываться просто по UserForm1.Show<br />Ну, а если Вам надо было не это, уточните вопрос.</td></tr>  <tr><td valign="top" bgcolor="gainsboro"><font face="verdana" size="2"><blockquote id="quote"><font size="1" face="Verdana, Arial, Helvetica" id="quote">quote:<hr height="1" noshade id="quote">Сначала запускается через меню Add-On<hr height="1" noshade id="quote"></blockquote id="quote"></font id="quote"><br />как это сделать в 2003</td></tr>  <tr><td valign="top" bgcolor="whitesmoke"><font face="verdana" size="2">Здесь имелся в виду ручной запуск Add-On через меню Visio - Tools/Macros/ИмяAdd-On'а. Если Add-On лежит в папке Solutions, то его видно в этом меню.<br />А в Visio 2003 это изменили? Пора искать Visio 2003...</td></tr></table></html>
